!function(){!function(e,t,i){var n=e.L,a={};a.version="0.6.4","object"==typeof module&&"object"==typeof module.exports?module.exports=a:"function"==typeof define&&define.amd&&define("leaflet",a),a.noConflict=function(){return e.L=n,this},e.L=a,a.Util={extend:function(e){var t,i,n,a,o=Array.prototype.slice.call(arguments,1);for(i=0,n=o.length;n>i;i++){a=o[i]||{};for(t in a)a.hasOwnProperty(t)&&(e[t]=a[t])}return e},bind:function(e,t){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return e.apply(t,i||arguments)}},stamp:function(){var e=0,t="_leaflet_id";return function(i){return i[t]=i[t]||++e,i[t]}}(),invokeEach:function(e,t,i){var n,a;if("object"==typeof e){a=Array.prototype.slice.call(arguments,3);for(n in e)t.apply(i,[n,e[n]].concat(a));return!0}return!1},limitExecByInterval:function(e,t,i){var n,a;return function o(){var r=arguments;return n?void(a=!0):(n=!0,setTimeout(function(){n=!1,a&&(o.apply(i,r),a=!1)},t),void e.apply(i,r))}},falseFn:function(){return!1},formatNum:function(e,t){var i=Math.pow(10,t||5);return Math.round(e*i)/i},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},splitWords:function(e){return a.Util.trim(e).split(/\s+/)},setOptions:function(e,t){return e.options=a.extend({},e.options,t),e.options},getParamString:function(e,t,i){var n=[];for(var a in e)n.push(encodeURIComponent(i?a.toUpperCase():a)+"="+encodeURIComponent(e[a]));return(t&&-1!==t.indexOf("?")?"&":"?")+n.join("&")},template:function(e,t){return e.replace(/\{ *([\w_]+) *\}/g,function(e,n){var a=t[n];if(a===i)throw new Error("No value provided for variable "+e);return"function"==typeof a&&(a=a(t)),a})},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var i,n,a=["webkit","moz","o","ms"];for(i=0;i<a.length&&!n;i++)n=e[a[i]+t];return n}function i(t){var i=+new Date,a=Math.max(0,16-(i-n));return n=i+a,e.setTimeout(t,a)}var n=0,o=e.requestAnimationFrame||t("RequestAnimationFrame")||i,r=e.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};a.Util.requestAnimFrame=function(t,n,r,s){return t=a.bind(t,n),r&&o===i?void t():o.call(e,t,s)},a.Util.cancelAnimFrame=function(t){t&&r.call(e,t)}}(),a.extend=a.Util.extend,a.bind=a.Util.bind,a.stamp=a.Util.stamp,a.setOptions=a.Util.setOptions,a.Class=function(){},a.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},i=function(){};i.prototype=this.prototype;var n=new i;n.constructor=t,t.prototype=n;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(t[o]=this[o]);e.statics&&(a.extend(t,e.statics),delete e.statics),e.includes&&(a.Util.extend.apply(null,[n].concat(e.includes)),delete e.includes),e.options&&n.options&&(e.options=a.extend({},n.options,e.options)),a.extend(n,e),n._initHooks=[];var r=this;return t.__super__=r.prototype,n.callInitHooks=function(){if(!this._initHooksCalled){r.prototype.callInitHooks&&r.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=n._initHooks.length;t>e;e++)n._initHooks[e].call(this)}},t},a.Class.include=function(e){a.extend(this.prototype,e)},a.Class.mergeOptions=function(e){a.extend(this.prototype.options,e)},a.Class.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),i="function"==typeof e?e:function(){this[e].apply(this,t)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)};var o="_leaflet_events";a.Mixin={},a.Mixin.Events={addEventListener:function(e,t,i){if(a.Util.invokeEach(e,this.addEventListener,this,t,i))return this;var n,r,s,l,c,u,h,d=this[o]=this[o]||{},p=i&&a.stamp(i);for(e=a.Util.splitWords(e),n=0,r=e.length;r>n;n++)s={action:t,context:i||this},l=e[n],i?(c=l+"_idx",u=c+"_len",h=d[c]=d[c]||{},h[p]||(h[p]=[],d[u]=(d[u]||0)+1),h[p].push(s)):(d[l]=d[l]||[],d[l].push(s));return this},hasEventListeners:function(e){var t=this[o];return!!t&&(e in t&&t[e].length>0||e+"_idx"in t&&t[e+"_idx_len"]>0)},removeEventListener:function(e,t,i){if(!this[o])return this;if(!e)return this.clearAllEventListeners();if(a.Util.invokeEach(e,this.removeEventListener,this,t,i))return this;var n,r,s,l,c,u,h,d,p,f=this[o],m=i&&a.stamp(i);for(e=a.Util.splitWords(e),n=0,r=e.length;r>n;n++)if(s=e[n],u=s+"_idx",h=u+"_len",d=f[u],t){if(l=i&&d?d[m]:f[s]){for(c=l.length-1;c>=0;c--)l[c].action!==t||i&&l[c].context!==i||(p=l.splice(c,1),p[0].action=a.Util.falseFn);i&&d&&0===l.length&&(delete d[m],f[h]--)}}else delete f[s],delete f[u];return this},clearAllEventListeners:function(){return delete this[o],this},fireEvent:function(e,t){if(!this.hasEventListeners(e))return this;var i,n,r,s,l,c=a.Util.extend({},t,{type:e,target:this}),u=this[o];if(u[e])for(i=u[e].slice(),n=0,r=i.length;r>n;n++)i[n].action.call(i[n].context||this,c);s=u[e+"_idx"];for(l in s)if(i=s[l].slice())for(n=0,r=i.length;r>n;n++)i[n].action.call(i[n].context||this,c);return this},addOneTimeEventListener:function(e,t,i){if(a.Util.invokeEach(e,this.addOneTimeEventListener,this,t,i))return this;var n=a.bind(function(){this.removeEventListener(e,t,i).removeEventListener(e,n,i)},this);return this.addEventListener(e,t,i).addEventListener(e,n,i)}},a.Mixin.Events.on=a.Mixin.Events.addEventListener,a.Mixin.Events.off=a.Mixin.Events.removeEventListener,a.Mixin.Events.once=a.Mixin.Events.addOneTimeEventListener,a.Mixin.Events.fire=a.Mixin.Events.fireEvent,function(){var n=!!e.ActiveXObject,o=n&&!e.XMLHttpRequest,r=n&&!t.querySelector,s=n&&!t.addEventListener,l=navigator.userAgent.toLowerCase(),c=-1!==l.indexOf("webkit"),u=-1!==l.indexOf("chrome"),h=-1!==l.indexOf("phantom"),d=-1!==l.indexOf("android"),p=-1!==l.search("android [23]"),f=typeof orientation!=i+"",m=e.navigator&&e.navigator.msPointerEnabled&&e.navigator.msMaxTouchPoints,v="devicePixelRatio"in e&&e.devicePixelRatio>1||"matchMedia"in e&&e.matchMedia("(min-resolution:144dpi)")&&e.matchMedia("(min-resolution:144dpi)").matches,g=t.documentElement,y=n&&"transition"in g.style,b="WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix,w="MozPerspective"in g.style,_="OTransition"in g.style,k=!e.L_DISABLE_3D&&(y||b||w||_)&&!h,x=!e.L_NO_TOUCH&&!h&&function(){var e="ontouchstart";if(m||e in g)return!0;var i=t.createElement("div"),n=!1;return i.setAttribute?(i.setAttribute(e,"return;"),"function"==typeof i[e]&&(n=!0),i.removeAttribute(e),i=null,n):!1}();a.Browser={ie:n,ie6:o,ie7:r,ielt9:s,webkit:c,android:d,android23:p,chrome:u,ie3d:y,webkit3d:b,gecko3d:w,opera3d:_,any3d:k,mobile:f,mobileWebkit:f&&c,mobileWebkit3d:f&&b,mobileOpera:f&&e.opera,touch:x,msTouch:m,retina:v}}(),a.Point=function(e,t,i){this.x=i?Math.round(e):e,this.y=i?Math.round(t):t},a.Point.prototype={clone:function(){return new a.Point(this.x,this.y)},add:function(e){return this.clone()._add(a.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(a.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(e){e=a.point(e);var t=e.x-this.x,i=e.y-this.y;return Math.sqrt(t*t+i*i)},equals:function(e){return e=a.point(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=a.point(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+a.Util.formatNum(this.x)+", "+a.Util.formatNum(this.y)+")"}},a.point=function(e,t,n){return e instanceof a.Point?e:a.Util.isArray(e)?new a.Point(e[0],e[1]):e===i||null===e?e:new a.Point(e,t,n)},a.Bounds=function(e,t){if(e)for(var i=t?[e,t]:e,n=0,a=i.length;a>n;n++)this.extend(i[n])},a.Bounds.prototype={extend:function(e){return e=a.point(e),this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=e.clone(),this.max=e.clone()),this},getCenter:function(e){return new a.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new a.Point(this.min.x,this.max.y)},getTopRight:function(){return new a.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,i;return e="number"==typeof e[0]||e instanceof a.Point?a.point(e):a.bounds(e),e instanceof a.Bounds?(t=e.min,i=e.max):t=i=e,t.x>=this.min.x&&i.x<=this.max.x&&t.y>=this.min.y&&i.y<=this.max.y},intersects:function(e){e=a.bounds(e);var t=this.min,i=this.max,n=e.min,o=e.max,r=o.x>=t.x&&n.x<=i.x,s=o.y>=t.y&&n.y<=i.y;return r&&s},isValid:function(){return!(!this.min||!this.max)}},a.bounds=function(e,t){return!e||e instanceof a.Bounds?e:new a.Bounds(e,t)},a.Transformation=function(e,t,i,n){this._a=e,this._b=t,this._c=i,this._d=n},a.Transformation.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new a.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}},a.DomUtil={get:function(e){return"string"==typeof e?t.getElementById(e):e},getStyle:function(e,i){var n=e.style[i];if(!n&&e.currentStyle&&(n=e.currentStyle[i]),(!n||"auto"===n)&&t.defaultView){var a=t.defaultView.getComputedStyle(e,null);n=a?a[i]:null}return"auto"===n?null:n},getViewportOffset:function(e){var i,n=0,o=0,r=e,s=t.body,l=t.documentElement,c=a.Browser.ie7;do{if(n+=r.offsetTop||0,o+=r.offsetLeft||0,n+=parseInt(a.DomUtil.getStyle(r,"borderTopWidth"),10)||0,o+=parseInt(a.DomUtil.getStyle(r,"borderLeftWidth"),10)||0,i=a.DomUtil.getStyle(r,"position"),r.offsetParent===s&&"absolute"===i)break;if("fixed"===i){n+=s.scrollTop||l.scrollTop||0,o+=s.scrollLeft||l.scrollLeft||0;break}if("relative"===i&&!r.offsetLeft){var u=a.DomUtil.getStyle(r,"width"),h=a.DomUtil.getStyle(r,"max-width"),d=r.getBoundingClientRect();("none"!==u||"none"!==h)&&(o+=d.left+r.clientLeft),n+=d.top+(s.scrollTop||l.scrollTop||0);break}r=r.offsetParent}while(r);r=e;do{if(r===s)break;n-=r.scrollTop||0,o-=r.scrollLeft||0,a.DomUtil.documentIsLtr()||!a.Browser.webkit&&!c||(o+=r.scrollWidth-r.clientWidth,c&&"hidden"!==a.DomUtil.getStyle(r,"overflow-y")&&"hidden"!==a.DomUtil.getStyle(r,"overflow")&&(o+=17)),r=r.parentNode}while(r);return new a.Point(o,n)},documentIsLtr:function(){return a.DomUtil._docIsLtrCached||(a.DomUtil._docIsLtrCached=!0,a.DomUtil._docIsLtr="ltr"===a.DomUtil.getStyle(t.body,"direction")),a.DomUtil._docIsLtr},create:function(e,i,n){var a=t.createElement(e);return a.className=i,n&&n.appendChild(a),a},hasClass:function(e,t){return e.className.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){a.DomUtil.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:function(e,t){e.className=a.Util.trim((" "+e.className+" ").replace(" "+t+" "," "))},setOpacity:function(e,t){if("opacity"in e.style)e.style.opacity=t;else if("filter"in e.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=e.filters.item(n)}catch(a){if(1===t)return}t=Math.round(100*t),i?(i.Enabled=100!==t,i.Opacity=t):e.style.filter+=" progid:"+n+"(opacity="+t+")"}},testProp:function(e){for(var i=t.documentElement.style,n=0;n<e.length;n++)if(e[n]in i)return e[n];return!1},getTranslateString:function(e){var t=a.Browser.webkit3d,i="translate"+(t?"3d":"")+"(",n=(t?",0":"")+")";return i+e.x+"px,"+e.y+"px"+n},getScaleString:function(e,t){var i=a.DomUtil.getTranslateString(t.add(t.multiplyBy(-1*e))),n=" scale("+e+") ";return i+n},setPosition:function(e,t,i){e._leaflet_pos=t,!i&&a.Browser.any3d?(e.style[a.DomUtil.TRANSFORM]=a.DomUtil.getTranslateString(t),a.Browser.mobileWebkit3d&&(e.style.WebkitBackfaceVisibility="hidden")):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getPosition:function(e){return e._leaflet_pos}},a.DomUtil.TRANSFORM=a.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),a.DomUtil.TRANSITION=a.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),a.DomUtil.TRANSITION_END="webkitTransition"===a.DomUtil.TRANSITION||"OTransition"===a.DomUtil.TRANSITION?a.DomUtil.TRANSITION+"End":"transitionend",function(){var i=a.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);a.extend(a.DomUtil,{disableTextSelection:function(){if(a.DomEvent.on(e,"selectstart",a.DomEvent.preventDefault),i){var n=t.documentElement.style;this._userSelect=n[i],n[i]="none"}},enableTextSelection:function(){a.DomEvent.off(e,"selectstart",a.DomEvent.preventDefault),i&&(t.documentElement.style[i]=this._userSelect,delete this._userSelect)},disableImageDrag:function(){a.DomEvent.on(e,"dragstart",a.DomEvent.preventDefault)},enableImageDrag:function(){a.DomEvent.off(e,"dragstart",a.DomEvent.preventDefault)}})}(),a.LatLng=function(e,t){var i=parseFloat(e),n=parseFloat(t);if(isNaN(i)||isNaN(n))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=i,this.lng=n},a.extend(a.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),a.LatLng.prototype={equals:function(e){if(!e)return!1;e=a.latLng(e);var t=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return t<=a.LatLng.MAX_MARGIN},toString:function(e){return"LatLng("+a.Util.formatNum(this.lat,e)+", "+a.Util.formatNum(this.lng,e)+")"},distanceTo:function(e){e=a.latLng(e);var t=6378137,i=a.LatLng.DEG_TO_RAD,n=(e.lat-this.lat)*i,o=(e.lng-this.lng)*i,r=this.lat*i,s=e.lat*i,l=Math.sin(n/2),c=Math.sin(o/2),u=l*l+c*c*Math.cos(r)*Math.cos(s);return 2*t*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))},wrap:function(e,t){var i=this.lng;return e=e||-180,t=t||180,i=(i+t)%(t-e)+(e>i||i===t?t:e),new a.LatLng(this.lat,i)}},a.latLng=function(e,t){return e instanceof a.LatLng?e:a.Util.isArray(e)?new a.LatLng(e[0],e[1]):e===i||null===e?e:"object"==typeof e&&"lat"in e?new a.LatLng(e.lat,"lng"in e?e.lng:e.lon):new a.LatLng(e,t)},a.LatLngBounds=function(e,t){if(e)for(var i=t?[e,t]:e,n=0,a=i.length;a>n;n++)this.extend(i[n])},a.LatLngBounds.prototype={extend:function(e){return e?(e="number"==typeof e[0]||"string"==typeof e[0]||e instanceof a.LatLng?a.latLng(e):a.latLngBounds(e),e instanceof a.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(e.lat,this._southWest.lat),this._southWest.lng=Math.min(e.lng,this._southWest.lng),this._northEast.lat=Math.max(e.lat,this._northEast.lat),this._northEast.lng=Math.max(e.lng,this._northEast.lng)):(this._southWest=new a.LatLng(e.lat,e.lng),this._northEast=new a.LatLng(e.lat,e.lng)):e instanceof a.LatLngBounds&&(this.extend(e._southWest),this.extend(e._northEast)),this):this},pad:function(e){var t=this._southWest,i=this._northEast,n=Math.abs(t.lat-i.lat)*e,o=Math.abs(t.lng-i.lng)*e;return new a.LatLngBounds(new a.LatLng(t.lat-n,t.lng-o),new a.LatLng(i.lat+n,i.lng+o))},getCenter:function(){return new a.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new a.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new a.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"==typeof e[0]||e instanceof a.LatLng?a.latLng(e):a.latLngBounds(e);var t,i,n=this._southWest,o=this._northEast;return e instanceof a.LatLngBounds?(t=e.getSouthWest(),i=e.getNorthEast()):t=i=e,t.lat>=n.lat&&i.lat<=o.lat&&t.lng>=n.lng&&i.lng<=o.lng},intersects:function(e){e=a.latLngBounds(e);var t=this._southWest,i=this._northEast,n=e.getSouthWest(),o=e.getNorthEast(),r=o.lat>=t.lat&&n.lat<=i.lat,s=o.lng>=t.lng&&n.lng<=i.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e){return e?(e=a.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},a.latLngBounds=function(e,t){return!e||e instanceof a.LatLngBounds?e:new a.LatLngBounds(e,t)},a.Projection={},a.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(e){var t=a.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,e.lat),-i),o=e.lng*t,r=n*t;return r=Math.log(Math.tan(Math.PI/4+r/2)),new a.Point(o,r)},unproject:function(e){var t=a.LatLng.RAD_TO_DEG,i=e.x*t,n=(2*Math.atan(Math.exp(e.y))-Math.PI/2)*t;return new a.LatLng(n,i)}},a.Projection.LonLat={project:function(e){return new a.Point(e.lng,e.lat)},unproject:function(e){return new a.LatLng(e.y,e.x)}},a.CRS={latLngToPoint:function(e,t){var i=this.projection.project(e),n=this.scale(t);return this.transformation._transform(i,n)},pointToLatLng:function(e,t){var i=this.scale(t),n=this.transformation.untransform(e,i);return this.projection.unproject(n)},project:function(e){return this.projection.project(e)},scale:function(e){return 256*Math.pow(2,e)}},a.CRS.Simple=a.extend({},a.CRS,{projection:a.Projection.LonLat,transformation:new a.Transformation(1,0,-1,0),scale:function(e){return Math.pow(2,e)}}),a.CRS.EPSG3857=a.extend({},a.CRS,{code:"EPSG:3857",projection:a.Projection.SphericalMercator,transformation:new a.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(e){var t=this.projection.project(e),i=6378137;return t.multiplyBy(i)}}),a.CRS.EPSG900913=a.extend({},a.CRS.EPSG3857,{code:"EPSG:900913"}),a.CRS.EPSG4326=a.extend({},a.CRS,{code:"EPSG:4326",projection:a.Projection.LonLat,transformation:new a.Transformation(1/360,.5,-1/360,.5)}),a.Map=a.Class.extend({includes:a.Mixin.Events,options:{crs:a.CRS.EPSG3857,fadeAnimation:a.DomUtil.TRANSITION&&!a.Browser.android23,trackResize:!0,markerZoomAnimation:a.DomUtil.TRANSITION&&a.Browser.any3d},initialize:function(e,t){t=a.setOptions(this,t),this._initContainer(e),this._initLayout(),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),t.center&&t.zoom!==i&&this.setView(a.latLng(t.center),t.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(t.layers)},setView:function(e,t){return this._resetView(a.latLng(e),this._limitZoom(t)),this},setZoom:function(e,t){return this.setView(this.getCenter(),e,{zoom:t})},zoomIn:function(e,t){return this.setZoom(this._zoom+(e||1),t)},zoomOut:function(e,t){return this.setZoom(this._zoom-(e||1),t)},setZoomAround:function(e,t,i){var n=this.getZoomScale(t),o=this.getSize().divideBy(2),r=e instanceof a.Point?e:this.latLngToContainerPoint(e),s=r.subtract(o).multiplyBy(1-1/n),l=this.containerPointToLatLng(o.add(s));return this.setView(l,t,{zoom:i})},fitBounds:function(e,t){t=t||{},e=e.getBounds?e.getBounds():a.latLngBounds(e);var i=a.point(t.paddingTopLeft||t.padding||[0,0]),n=a.point(t.paddingBottomRight||t.padding||[0,0]),o=this.getBoundsZoom(e,!1,i.add(n)),r=n.subtract(i).divideBy(2),s=this.project(e.getSouthWest(),o),l=this.project(e.getNorthEast(),o),c=this.unproject(s.add(l).divideBy(2).add(r),o);return this.setView(c,o,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e){return this.fire("movestart"),this._rawPanBy(a.point(e)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(e,t){if(e=a.latLngBounds(e),this.options.maxBounds=e,!e)return this._boundsMinZoom=null,this.off("moveend",this._panInsideMaxBounds,this),this;var i=this.getBoundsZoom(e,!0);return this._boundsMinZoom=i,this._loaded&&(this._zoom<i?this.setView(e.getCenter(),i,t):this.panInsideBounds(e)),this.on("moveend",this._panInsideMaxBounds,this),this},panInsideBounds:function(e){e=a.latLngBounds(e);var t=this.getPixelBounds(),i=t.getBottomLeft(),n=t.getTopRight(),o=this.project(e.getSouthWest()),r=this.project(e.getNorthEast()),s=0,l=0;return n.y<r.y&&(l=Math.ceil(r.y-n.y)),n.x>r.x&&(s=Math.floor(r.x-n.x)),i.y>o.y&&(l=Math.floor(o.y-i.y)),i.x<o.x&&(s=Math.ceil(o.x-i.x)),s||l?this.panBy([s,l]):this},addLayer:function(e){var t=a.stamp(e);return this._layers[t]?this:(this._layers[t]=e,!e.options||isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[t]=e,this._updateZoomLevels()),this.options.zoomAnimation&&a.TileLayer&&e instanceof a.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,e.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(e),this)},removeLayer:function(e){var t=a.stamp(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&this.fire("layerremove",{layer:e}),this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels()),this.options.zoomAnimation&&a.TileLayer&&e instanceof a.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,e.off("load",this._onTileLayerLoad,this)),this):void 0},hasLayer:function(e){return e?a.stamp(e)in this._layers:!1},eachLayer:function(e,t){for(var i in this._layers)e.call(t,this._layers[i]);return this},invalidateSize:function(e){e=a.extend({animate:!1,pan:!0},e===!0?{animate:!0}:e);var t=this.getSize();if(this._sizeChanged=!0,this.options.maxBounds&&this.setMaxBounds(this.options.maxBounds),!this._loaded)return this;var i=this.getSize(),n=t.subtract(i).divideBy(2).round();return n.x||n.y?(e.animate&&e.pan?this.panBy(n):(e.pan&&this._rawPanBy(n),this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a.bind(this.fire,this,"moveend"),200)),this.fire("resize",{oldSize:t,newSize:i})):this},addHandler:function(e,t){if(t){var i=this[e]=new t(this);return this._handlers.push(i),this.options[e]&&i.enable(),this}},remove:function(){return this._loaded&&this.fire("unload"),this._initEvents("off"),delete this._container._leaflet,this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._moved()?this.layerPointToLatLng(this._getCenterLayerPoint()):this._initialCenter},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(e.getBottomLeft()),i=this.unproject(e.getTopRight());return new a.LatLngBounds(t,i)},getMinZoom:function(){var e=this._layersMinZoom===i?0:this._layersMinZoom,t=this._boundsMinZoom===i?0:this._boundsMinZoom;return this.options.minZoom===i?Math.max(e,t):this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,i){e=a.latLngBounds(e);var n,o=this.getMinZoom()-(t?1:0),r=this.getMaxZoom(),s=this.getSize(),l=e.getNorthWest(),c=e.getSouthEast(),u=!0;i=a.point(i||[0,0]);do o++,n=this.project(c,o).subtract(this.project(l,o)).add(i),u=t?n.x<s.x||n.y<s.y:s.contains(n);while(u&&r>=o);return u&&t?null:t?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new a.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var e=this._getTopLeftPoint();return new a.Bounds(e,e.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e){var t=this.options.crs;return t.scale(e)/t.scale(this._zoom)},getScaleZoom:function(e){return this._zoom+Math.log(e)/Math.LN2},project:function(e,t){return t=t===i?this._zoom:t,this.options.crs.latLngToPoint(a.latLng(e),t)},unproject:function(e,t){return t=t===i?this._zoom:t,this.options.crs.pointToLatLng(a.point(e),t)},layerPointToLatLng:function(e){var t=a.point(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){var t=this.project(a.latLng(e))._round();return t._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(e){return a.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return a.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(a.point(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(a.latLng(e)))},mouseEventToContainerPoint:function(e){return a.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=a.DomUtil.get(e);if(!t)throw new Error("Map container not found.");if(t._leaflet)throw new Error("Map container is already initialized.");t._leaflet=!0},_initLayout:function(){var e=this._container;a.DomUtil.addClass(e,"leaflet-container"+(a.Browser.touch?" leaflet-touch":"")+(a.Browser.retina?" leaflet-retina":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var t=a.DomUtil.getStyle(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._mapPane=e.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=e.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),e.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),e.shadowPane=this._createPane("leaflet-shadow-pane"),e.overlayPane=this._createPane("leaflet-overlay-pane"),e.markerPane=this._createPane("leaflet-marker-pane"),e.popupPane=this._createPane("leaflet-popup-pane");var t=" leaflet-zoom-hide";this.options.markerZoomAnimation||(a.DomUtil.addClass(e.markerPane,t),a.DomUtil.addClass(e.shadowPane,t),a.DomUtil.addClass(e.popupPane,t))},_createPane:function(e,t){return a.DomUtil.create("div",e,t||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(e){e=e?a.Util.isArray(e)?e:[e]:[];for(var t=0,i=e.length;i>t;t++)this.addLayer(e[t])},_resetView:function(e,t,i,n){var o=this._zoom!==t;n||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=t,this._initialCenter=e,this._initialTopLeftPoint=this._getNewTopLeftPoint(e),i?this._initialTopLeftPoint._add(this._getMapPanePos()):a.DomUtil.setPosition(this._mapPane,new a.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var r=!this._loaded;this._loaded=!0,r&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("viewreset",{hard:!i}),this.fire("move"),(o||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(e){a.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var e,t=1/0,n=-1/0,a=this._getZoomSpan();for(e in this._zoomBoundLayers){var o=this._zoomBoundLayers[e];isNaN(o.options.minZoom)||(t=Math.min(t,o.options.minZoom)),isNaN(o.options.maxZoom)||(n=Math.max(n,o.options.maxZoom))}e===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=n,this._layersMinZoom=t),a!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(a.DomEvent){t=t||"on",a.DomEvent[t](this._container,"click",this._onMouseClick,this);var i,n,o=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(i=0,n=o.length;n>i;i++)a.DomEvent[t](this._container,o[i],this._fireMouseEvent,this);this.options.trackResize&&a.DomEvent[t](e,"resize",this._onResize,this)}},_onResize:function(){a.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=a.Util.requestAnimFrame(this.invalidateSize,this,!1,this._container)},_onMouseClick:function(e){!this._loaded||!e._simulated&&this.dragging&&this.dragging.moved()||a.DomEvent._skipped(e)||(this.fire("preclick"),this._fireMouseEvent(e))},_fireMouseEvent:function(e){if(this._loaded&&!a.DomEvent._skipped(e)){var t=e.type;if(t="mouseenter"===t?"mouseover":"mouseleave"===t?"mouseout":t,this.hasEventListeners(t)){"contextmenu"===t&&a.DomEvent.preventDefault(e);var i=this.mouseEventToContainerPoint(e),n=this.containerPointToLayerPoint(i),o=this.layerPointToLatLng(n);this.fire(t,{latlng:o,layerPoint:n,containerPoint:i,originalEvent:e})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var e=0,t=this._handlers.length;t>e;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,this):this.on("load",e,t),this},_layerAdd:function(e){e.onAdd(this),this.fire("layeradd",{layer:e})},_getMapPanePos:function(){return a.DomUtil.getPosition(this._mapPane)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(e,t){var i=this.getSize()._divideBy(2);return this.project(e,t)._subtract(i)._round()},_latLngToNewLayerPoint:function(e,t,i){var n=this._getNewTopLeftPoint(i,t).add(this._getMapPanePos());return this.project(e,t)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitZoom:function(e){var t=this.getMinZoom(),i=this.getMaxZoom();return Math.max(t,Math.min(i,e))}}),a.map=function(e,t){return new a.Map(e,t)},a.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(e){var t=a.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,e.lat),-i),o=this.R_MAJOR,r=this.R_MINOR,s=e.lng*t*o,l=n*t,c=r/o,u=Math.sqrt(1-c*c),h=u*Math.sin(l);h=Math.pow((1-h)/(1+h),.5*u);var d=Math.tan(.5*(.5*Math.PI-l))/h;return l=-o*Math.log(d),new a.Point(s,l)},unproject:function(e){for(var t,i=a.LatLng.RAD_TO_DEG,n=this.R_MAJOR,o=this.R_MINOR,r=e.x*i/n,s=o/n,l=Math.sqrt(1-s*s),c=Math.exp(-e.y/n),u=Math.PI/2-2*Math.atan(c),h=15,d=1e-7,p=h,f=.1;Math.abs(f)>d&&--p>0;)t=l*Math.sin(u),f=Math.PI/2-2*Math.atan(c*Math.pow((1-t)/(1+t),.5*l))-u,u+=f;return new a.LatLng(u*i,r)}},a.CRS.EPSG3395=a.extend({},a.CRS,{code:"EPSG:3395",projection:a.Projection.Mercator,transformation:function(){var e=a.Projection.Mercator,t=e.R_MAJOR,i=e.R_MINOR;return new a.Transformation(.5/(Math.PI*t),.5,-.5/(Math.PI*i),.5)}()}),a.TileLayer=a.Class.extend({includes:a.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:a.Browser.mobile,updateWhenIdle:a.Browser.mobile},initialize:function(e,t){t=a.setOptions(this,t),t.detectRetina&&a.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomOffset++,t.minZoom>0&&t.minZoom--,this.options.maxZoom--),t.bounds&&(t.bounds=a.latLngBounds(t.bounds)),this._url=e;var i=this.options.subdomains;"string"==typeof i&&(this.options.subdomains=i.split(""))},onAdd:function(e){this._map=e,this._animated=e._zoomAnimated,this._initContainer(),this._createTileProto(),e.on({viewreset:this._reset,moveend:this._update},this),
this._animated&&e.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=a.Util.limitExecByInterval(this._update,150,this),e.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this._container.parentNode.removeChild(this._container),e.off({viewreset:this._reset,moveend:this._update},this),this._animated&&e.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||e.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var e=this._map._panes.tilePane;return this._container&&(e.appendChild(this._container),this._setAutoZIndex(e,Math.max)),this},bringToBack:function(){var e=this._map._panes.tilePane;return this._container&&(e.insertBefore(this._container,e.firstChild),this._setAutoZIndex(e,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},setUrl:function(e,t){return this._url=e,t||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e,t){var i,n,a,o=e.children,r=-t(1/0,-1/0);for(n=0,a=o.length;a>n;n++)o[n]!==this._container&&(i=parseInt(o[n].style.zIndex,10),isNaN(i)||(r=t(r,i)));this.options.zIndex=this._container.style.zIndex=(isFinite(r)?r:0)+t(1,-1)},_updateOpacity:function(){var e,t=this._tiles;if(a.Browser.ielt9)for(e in t)a.DomUtil.setOpacity(t[e],this.options.opacity);else a.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var e=this._map._panes.tilePane;if(!this._container){if(this._container=a.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var t="leaflet-tile-container leaflet-zoom-animated";this._bgBuffer=a.DomUtil.create("div",t,this._container),this._tileContainer=a.DomUtil.create("div",t,this._container)}else this._tileContainer=this._container;e.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(e){for(var t in this._tiles)this.fire("tileunload",{tile:this._tiles[t]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&e&&e.hard&&this._clearBgBuffer(),this._initContainer()},_update:function(){if(this._map){var e=this._map.getPixelBounds(),t=this._map.getZoom(),i=this.options.tileSize;if(!(t>this.options.maxZoom||t<this.options.minZoom)){var n=a.bounds(e.min.divideBy(i)._floor(),e.max.divideBy(i)._floor());this._addTilesFromCenterOut(n),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(n)}}},_addTilesFromCenterOut:function(e){var i,n,o,r=[],s=e.getCenter();for(i=e.min.y;i<=e.max.y;i++)for(n=e.min.x;n<=e.max.x;n++)o=new a.Point(n,i),this._tileShouldBeLoaded(o)&&r.push(o);var l=r.length;if(0!==l){r.sort(function(e,t){return e.distanceTo(s)-t.distanceTo(s)});var c=t.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=l,n=0;l>n;n++)this._addTile(r[n],c);this._tileContainer.appendChild(c)}},_tileShouldBeLoaded:function(e){if(e.x+":"+e.y in this._tiles)return!1;var t=this.options;if(!t.continuousWorld){var i=this._getWrapTileNum();if(t.noWrap&&(e.x<0||e.x>=i)||e.y<0||e.y>=i)return!1}if(t.bounds){var n=t.tileSize,a=e.multiplyBy(n),o=a.add([n,n]),r=this._map.unproject(a),s=this._map.unproject(o);if(t.continuousWorld||t.noWrap||(r=r.wrap(),s=s.wrap()),!t.bounds.intersects([r,s]))return!1}return!0},_removeOtherTiles:function(e){var t,i,n,a;for(a in this._tiles)t=a.split(":"),i=parseInt(t[0],10),n=parseInt(t[1],10),(i<e.min.x||i>e.max.x||n<e.min.y||n>e.max.y)&&this._removeTile(a)},_removeTile:function(e){var t=this._tiles[e];this.fire("tileunload",{tile:t,url:t.src}),this.options.reuseTiles?(a.DomUtil.removeClass(t,"leaflet-tile-loaded"),this._unusedTiles.push(t)):t.parentNode===this._tileContainer&&this._tileContainer.removeChild(t),a.Browser.android||(t.onload=null,t.src=a.Util.emptyImageUrl),delete this._tiles[e]},_addTile:function(e,t){var i=this._getTilePos(e),n=this._getTile();a.DomUtil.setPosition(n,i,a.Browser.chrome||a.Browser.android23),this._tiles[e.x+":"+e.y]=n,this._loadTile(n,e),n.parentNode!==this._tileContainer&&t.appendChild(n)},_getZoomForUrl:function(){var e=this.options,t=this._map.getZoom();return e.zoomReverse&&(t=e.maxZoom-t),t+e.zoomOffset},_getTilePos:function(e){var t=this._map.getPixelOrigin(),i=this.options.tileSize;return e.multiplyBy(i).subtract(t)},getTileUrl:function(e){return a.Util.template(this._url,a.extend({s:this._getSubdomain(e),z:e.z,x:e.x,y:e.y},this.options))},_getWrapTileNum:function(){return Math.pow(2,this._getZoomForUrl())},_adjustTilePoint:function(e){var t=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(e.x=(e.x%t+t)%t),this.options.tms&&(e.y=t-e.y-1),e.z=this._getZoomForUrl()},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_createTileProto:function(){var e=this._tileImg=a.DomUtil.create("img","leaflet-tile");e.style.width=e.style.height=this.options.tileSize+"px",e.galleryimg="no"},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var e=this._unusedTiles.pop();return this._resetTile(e),e}return this._createTile()},_resetTile:function(){},_createTile:function(){var e=this._tileImg.cloneNode(!1);return e.onselectstart=e.onmousemove=a.Util.falseFn,a.Browser.ielt9&&this.options.opacity!==i&&a.DomUtil.setOpacity(e,this.options.opacity),e},_loadTile:function(e,t){e._layer=this,e.onload=this._tileOnLoad,e.onerror=this._tileOnError,this._adjustTilePoint(t),e.src=this.getTileUrl(t)},_tileLoaded:function(){this._tilesToLoad--,this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(a.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var e=this._layer;this.src!==a.Util.emptyImageUrl&&(a.DomUtil.addClass(this,"leaflet-tile-loaded"),e.fire("tileload",{tile:this,url:this.src})),e._tileLoaded()},_tileOnError:function(){var e=this._layer;e.fire("tileerror",{tile:this,url:this.src});var t=e.options.errorTileUrl;t&&(this.src=t),e._tileLoaded()}}),a.tileLayer=function(e,t){return new a.TileLayer(e,t)},a.TileLayer.WMS=a.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(e,t){this._url=e;var i=a.extend({},this.defaultWmsParams),n=t.tileSize||this.options.tileSize;i.width=i.height=t.detectRetina&&a.Browser.retina?2*n:n;for(var o in t)this.options.hasOwnProperty(o)||"crs"===o||(i[o]=t[o]);this.wmsParams=i,a.setOptions(this,t)},onAdd:function(e){this._crs=this.options.crs||e.options.crs;var t=parseFloat(this.wmsParams.version)>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,a.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e,t){var i=this._map,n=this.options.tileSize,o=e.multiplyBy(n),r=o.add([n,n]),s=this._crs.project(i.unproject(o,t)),l=this._crs.project(i.unproject(r,t)),c=[s.x,l.y,l.x,s.y].join(","),u=a.Util.template(this._url,{s:this._getSubdomain(e)});return u+a.Util.getParamString(this.wmsParams,u,!0)+"&BBOX="+c},setParams:function(e,t){return a.extend(this.wmsParams,e),t||this.redraw(),this}}),a.tileLayer.wms=function(e,t){return new a.TileLayer.WMS(e,t)},a.TileLayer.Canvas=a.TileLayer.extend({options:{async:!1},initialize:function(e){a.setOptions(this,e)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var e in this._tiles)this._redrawTile(this._tiles[e]);return this},_redrawTile:function(e){this.drawTile(e,e._tilePoint,this._map._zoom)},_createTileProto:function(){var e=this._canvasProto=a.DomUtil.create("canvas","leaflet-tile");e.width=e.height=this.options.tileSize},_createTile:function(){var e=this._canvasProto.cloneNode(!1);return e.onselectstart=e.onmousemove=a.Util.falseFn,e},_loadTile:function(e,t){e._layer=this,e._tilePoint=t,this._redrawTile(e),this.options.async||this.tileDrawn(e)},drawTile:function(){},tileDrawn:function(e){this._tileOnLoad.call(e)}}),a.tileLayer.canvas=function(e){return new a.TileLayer.Canvas(e)},a.ImageOverlay=a.Class.extend({includes:a.Mixin.Events,options:{opacity:1},initialize:function(e,t,i){this._url=e,this._bounds=a.latLngBounds(t),a.setOptions(this,i)},onAdd:function(e){this._map=e,this._image||this._initImage(),e._panes.overlayPane.appendChild(this._image),e.on("viewreset",this._reset,this),e.options.zoomAnimation&&a.Browser.any3d&&e.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(e){e.getPanes().overlayPane.removeChild(this._image),e.off("viewreset",this._reset,this),e.options.zoomAnimation&&e.off("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var e=this._map._panes.overlayPane;return this._image&&e.insertBefore(this._image,e.firstChild),this},_initImage:function(){this._image=a.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&a.Browser.any3d?a.DomUtil.addClass(this._image,"leaflet-zoom-animated"):a.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),a.extend(this._image,{galleryimg:"no",onselectstart:a.Util.falseFn,onmousemove:a.Util.falseFn,onload:a.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(e){var t=this._map,i=this._image,n=t.getZoomScale(e.zoom),o=this._bounds.getNorthWest(),r=this._bounds.getSouthEast(),s=t._latLngToNewLayerPoint(o,e.zoom,e.center),l=t._latLngToNewLayerPoint(r,e.zoom,e.center)._subtract(s),c=s._add(l._multiplyBy(.5*(1-1/n)));i.style[a.DomUtil.TRANSFORM]=a.DomUtil.getTranslateString(c)+" scale("+n+") "},_reset:function(){var e=this._image,t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),i=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(t);a.DomUtil.setPosition(e,t),e.style.width=i.x+"px",e.style.height=i.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){a.DomUtil.setOpacity(this._image,this.options.opacity)}}),a.imageOverlay=function(e,t,i){return new a.ImageOverlay(e,t,i)},a.Icon=a.Class.extend({options:{className:""},initialize:function(e){a.setOptions(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var i=this._getIconUrl(e);if(!i){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n;return n=t&&"IMG"===t.tagName?this._createImg(i,t):this._createImg(i),this._setIconStyles(n,e),n},_setIconStyles:function(e,t){var i,n=this.options,o=a.point(n[t+"Size"]);i="shadow"===t?a.point(n.shadowAnchor||n.iconAnchor):a.point(n.iconAnchor),!i&&o&&(i=o.divideBy(2,!0)),e.className="leaflet-marker-"+t+" "+n.className,i&&(e.style.marginLeft=-i.x+"px",e.style.marginTop=-i.y+"px"),o&&(e.style.width=o.x+"px",e.style.height=o.y+"px")},_createImg:function(e,i){return a.Browser.ie6?(i||(i=t.createElement("div")),i.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+e+'")'):(i||(i=t.createElement("img")),i.src=e),i},_getIconUrl:function(e){return a.Browser.retina&&this.options[e+"RetinaUrl"]?this.options[e+"RetinaUrl"]:this.options[e+"Url"]}}),a.icon=function(e){return new a.Icon(e)},a.Icon.Default=a.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(e){var t=e+"Url";if(this.options[t])return this.options[t];a.Browser.retina&&"icon"===e&&(e+="-2x");var i=a.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+e+".png"}}),a.Icon.Default.imagePath=function(){var e,i,n,a,o,r=t.getElementsByTagName("script"),s=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(e=0,i=r.length;i>e;e++)if(n=r[e].src,a=n.match(s))return o=n.split(s)[0],(o?o+"/":"")+"images"}(),a.Marker=a.Class.extend({includes:a.Mixin.Events,options:{icon:new a.Icon.Default,title:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(e,t){a.setOptions(this,t),this._latlng=a.latLng(e)},onAdd:function(e){this._map=e,e.on("viewreset",this.update,this),this._initIcon(),this.update(),e.options.zoomAnimation&&e.options.markerZoomAnimation&&e.on("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),e.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=a.latLng(e),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update(),this},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this},update:function(){if(this._icon){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t=this._map,i=t.options.zoomAnimation&&t.options.markerZoomAnimation,n=i?"leaflet-zoom-animated":"leaflet-zoom-hide",o=e.icon.createIcon(this._icon),r=!1;o!==this._icon&&(this._icon&&this._removeIcon(),r=!0,e.title&&(o.title=e.title)),a.DomUtil.addClass(o,n),e.keyboard&&(o.tabIndex="0"),this._icon=o,this._initInteraction(),e.riseOnHover&&a.DomEvent.on(o,"mouseover",this._bringToFront,this).on(o,"mouseout",this._resetZIndex,this);var s=e.icon.createShadow(this._shadow),l=!1;s!==this._shadow&&(this._removeShadow(),l=!0),s&&a.DomUtil.addClass(s,n),this._shadow=s,e.opacity<1&&this._updateOpacity();var c=this._map._panes;r&&c.markerPane.appendChild(this._icon),s&&l&&c.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&a.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(e){a.DomUtil.setPosition(this._icon,e),this._shadow&&a.DomUtil.setPosition(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon.style.zIndex=this._zIndex+e},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPos(t)},_initInteraction:function(){if(this.options.clickable){var e=this._icon,t=["dblclick","mousedown","mouseover","mouseout","contextmenu"];a.DomUtil.addClass(e,"leaflet-clickable"),a.DomEvent.on(e,"click",this._onMouseClick,this),a.DomEvent.on(e,"keypress",this._onKeyPress,this);for(var i=0;i<t.length;i++)a.DomEvent.on(e,t[i],this._fireMouseEvent,this);a.Handler.MarkerDrag&&(this.dragging=new a.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(e){var t=this.dragging&&this.dragging.moved();(this.hasEventListeners(e.type)||t)&&a.DomEvent.stopPropagation(e),t||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(e.type,{originalEvent:e,latlng:this._latlng})},_onKeyPress:function(e){13===e.keyCode&&this.fire("click",{originalEvent:e,latlng:this._latlng})},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e,latlng:this._latlng}),"contextmenu"===e.type&&this.hasEventListeners(e.type)&&a.DomEvent.preventDefault(e),"mousedown"!==e.type?a.DomEvent.stopPropagation(e):a.DomEvent.preventDefault(e)},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){a.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&a.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),a.marker=function(e,t){return new a.Marker(e,t)},a.DivIcon=a.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(e){var i=e&&"DIV"===e.tagName?e:t.createElement("div"),n=this.options;return i.innerHTML=n.html!==!1?n.html:"",n.bgPos&&(i.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),a.divIcon=function(e){return new a.DivIcon(e)},a.Map.mergeOptions({closePopupOnClick:!0}),a.Popup=a.Class.extend({includes:a.Mixin.Events,options:{minWidth:50,maxWidth:300,maxHeight:null,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(e,t){a.setOptions(this,e),this._source=t,this._animated=a.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(e){this._map=e,this._container||this._initLayout(),this._updateContent();var t=e.options.fadeAnimation;t&&a.DomUtil.setOpacity(this._container,0),e._panes.popupPane.appendChild(this._container),e.on(this._getEvents(),this),this._update(),t&&a.DomUtil.setOpacity(this._container,1),this.fire("open"),e.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(e){return e.addLayer(this),this},openOn:function(e){return e.openPopup(this),this},onRemove:function(e){e._panes.popupPane.removeChild(this._container),a.Util.falseFn(this._container.offsetWidth),e.off(this._getEvents(),this),e.options.fadeAnimation&&a.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),e.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},setLatLng:function(e){return this._latlng=a.latLng(e),this._update(),this},setContent:function(e){return this._content=e,this._update(),this},_getEvents:function(){var e={viewreset:this._updatePosition};return this._animated&&(e.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this._close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var e,t="leaflet-popup",i=t+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=a.DomUtil.create("div",i);this.options.closeButton&&(e=this._closeButton=a.DomUtil.create("a",t+"-close-button",n),e.href="#close",e.innerHTML="&#215;",a.DomEvent.disableClickPropagation(e),a.DomEvent.on(e,"click",this._onCloseButtonClick,this));var o=this._wrapper=a.DomUtil.create("div",t+"-content-wrapper",n);a.DomEvent.disableClickPropagation(o),this._contentNode=a.DomUtil.create("div",t+"-content",o),a.DomEvent.on(this._contentNode,"mousewheel",a.DomEvent.stopPropagation),a.DomEvent.on(this._contentNode,"MozMousePixelScroll",a.DomEvent.stopPropagation),a.DomEvent.on(o,"contextmenu",a.DomEvent.stopPropagation),this._tipContainer=a.DomUtil.create("div",t+"-tip-container",n),this._tip=a.DomUtil.create("div",t+"-tip",this._tipContainer)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var i=e.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),t.width=i+1+"px",t.whiteSpace="",t.height="";var n=e.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&n>o?(t.height=o+"px",a.DomUtil.addClass(e,r)):a.DomUtil.removeClass(e,r),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),t=this._animated,i=a.point(this.options.offset);t&&a.DomUtil.setPosition(this._container,e),this._containerBottom=-i.y-(t?0:e.y),this._containerLeft=-Math.round(this._containerWidth/2)+i.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);a.DomUtil.setPosition(this._container,t)},_adjustPan:function(){if(this.options.autoPan){var e=this._map,t=this._container.offsetHeight,i=this._containerWidth,n=new a.Point(this._containerLeft,-t-this._containerBottom);this._animated&&n._add(a.DomUtil.getPosition(this._container));var o=e.layerPointToContainerPoint(n),r=a.point(this.options.autoPanPadding),s=e.getSize(),l=0,c=0;o.x+i>s.x&&(l=o.x+i-s.x+r.x),o.x-l<0&&(l=o.x-r.x),o.y+t>s.y&&(c=o.y+t-s.y+r.y),o.y-c<0&&(c=o.y-r.y),(l||c)&&e.fire("autopanstart").panBy([l,c])}},_onCloseButtonClick:function(e){this._close(),a.DomEvent.stop(e)}}),a.popup=function(e,t){return new a.Popup(e,t)},a.Map.include({openPopup:function(e,t,i){if(this.closePopup(),!(e instanceof a.Popup)){var n=e;e=new a.Popup(i).setLatLng(t).setContent(n)}return e._isOpen=!0,this._popup=e,this.addLayer(e)},closePopup:function(e){return e&&e!==this._popup||(e=this._popup,this._popup=null),e&&(this.removeLayer(e),e._isOpen=!1),this}}),a.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(e,t){var i=a.point(this.options.icon.options.popupAnchor||[0,0]);return i=i.add(a.Popup.prototype.options.offset),t&&t.offset&&(i=i.add(t.offset)),t=a.extend({offset:i},t),this._popup||this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),e instanceof a.Popup?(a.setOptions(e,t),this._popup=e):this._popup=new a.Popup(t,this).setContent(e),this},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup).off("remove",this.closePopup).off("move",this._movePopup)),this},_movePopup:function(e){this._popup.setLatLng(e.latlng)}}),a.LayerGroup=a.Class.extend({initialize:function(e){this._layers={};var t,i;if(e)for(t=0,i=e.length;i>t;t++)this.addLayer(e[t])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return e?e in this._layers||this.getLayerId(e)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(e){var t,i,n=Array.prototype.slice.call(arguments,1);for(t in this._layers)i=this._layers[t],i[e]&&i[e].apply(i,n);return this},onAdd:function(e){this._map=e,this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e),this._map=null},addTo:function(e){return e.addLayer(this),this},eachLayer:function(e,t){for(var i in this._layers)e.call(t,this._layers[i]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];for(var t in this._layers)e.push(this._layers[t]);return e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return a.stamp(e)}}),a.layerGroup=function(e){return new a.LayerGroup(e)},a.FeatureGroup=a.LayerGroup.extend({includes:a.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(e){return this.hasLayer(e)?this:(e.on(a.FeatureGroup.EVENTS,this._propagateEvent,this),a.LayerGroup.prototype.addLayer.call(this,e),this._popupContent&&e.bindPopup&&e.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.off(a.FeatureGroup.EVENTS,this._propagateEvent,this),a.LayerGroup.prototype.removeLayer.call(this,e),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:e})):this},bindPopup:function(e,t){return this._popupContent=e,this._popupOptions=t,this.invoke("bindPopup",e,t)},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new a.LatLngBounds;return this.eachLayer(function(t){e.extend(t instanceof a.Marker?t.getLatLng():t.getBounds())}),e},_propagateEvent:function(e){e.layer||(e.layer=e.target),e.target=this,this.fire(e.type,e)}}),a.featureGroup=function(e){return new a.FeatureGroup(e)},a.Path=a.Class.extend({includes:[a.Mixin.Events],statics:{CLIP_PADDING:function(){var t=a.Browser.mobile?1280:2e3,i=(t/Math.max(e.outerWidth,e.outerHeight)-1)/2;return Math.max(0,Math.min(.5,i))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(e){a.setOptions(this,e)},onAdd:function(e){this._map=e,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),e.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,a.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),e.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(e){return a.setOptions(this,e),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),a.Map.include({_updatePathViewport:function(){var e=a.Path.CLIP_PADDING,t=this.getSize(),i=a.DomUtil.getPosition(this._mapPane),n=i.multiplyBy(-1)._subtract(t.multiplyBy(e)._round()),o=n.add(t.multiplyBy(1+2*e)._round());this._pathViewport=new a.Bounds(n,o)}}),a.Path.SVG_NS="http://www.w3.org/2000/svg",a.Browser.svg=!(!t.createElementNS||!t.createElementNS(a.Path.SVG_NS,"svg").createSVGRect),a.Path=a.Path.extend({statics:{SVG:a.Browser.svg},bringToFront:function(){var e=this._map._pathRoot,t=this._container;return t&&e.lastChild!==t&&e.appendChild(t),this},bringToBack:function(){var e=this._map._pathRoot,t=this._container,i=e.firstChild;return t&&i!==t&&e.insertBefore(t,i),this},getPathString:function(){},_createElement:function(e){return t.createElementNS(a.Path.SVG_NS,e)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray")):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var e=this.getPathString();e||(e="M0 0"),this._path.setAttribute("d",e)},_initEvents:function(){if(this.options.clickable){(a.Browser.svg||!a.Browser.vml)&&this._path.setAttribute("class","leaflet-clickable"),a.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var e=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],t=0;t<e.length;t++)a.DomEvent.on(this._container,e[t],this._fireMouseEvent,this)}},_onMouseClick:function(e){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(e)},_fireMouseEvent:function(e){if(this.hasEventListeners(e.type)){var t=this._map,i=t.mouseEventToContainerPoint(e),n=t.containerPointToLayerPoint(i),o=t.layerPointToLatLng(n);this.fire(e.type,{latlng:o,layerPoint:n,containerPoint:i,originalEvent:e}),"contextmenu"===e.type&&a.DomEvent.preventDefault(e),"mousemove"!==e.type&&a.DomEvent.stopPropagation(e)}}}),a.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=a.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&a.Browser.any3d?(this._pathRoot.setAttribute("class"," leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):this._pathRoot.setAttribute("class"," leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(e){var t=this.getZoomScale(e.zoom),i=this._getCenterOffset(e.center)._multiplyBy(-t)._add(this._pathViewport.min);this._pathRoot.style[a.DomUtil.TRANSFORM]=a.DomUtil.getTranslateString(i)+" scale("+t+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,i=e.max,n=i.x-t.x,o=i.y-t.y,r=this._pathRoot,s=this._panes.overlayPane;a.Browser.mobileWebkit&&s.removeChild(r),a.DomUtil.setPosition(r,t),r.setAttribute("width",n),r.setAttribute("height",o),r.setAttribute("viewBox",[t.x,t.y,n,o].join(" ")),a.Browser.mobileWebkit&&s.appendChild(r)}}}),a.Path.include({bindPopup:function(e,t){return e instanceof a.Popup?this._popup=e:((!this._popup||t)&&(this._popup=new a.Popup(t,this)),this._popup.setContent(e)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(e){return this._popup&&(e=e||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:e})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(e){this._popup.setLatLng(e.latlng),this._map.openPopup(this._popup)}}),a.Browser.vml=!a.Browser.svg&&function(){try{var e=t.createElement("div");e.innerHTML='<v:shape adj="1"/>';var i=e.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(n){return!1}}(),a.Path=a.Browser.svg||!a.Browser.vml?a.Path:a.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return t.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),
function(e){return t.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return t.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var e=this._container=this._createElement("shape");a.DomUtil.addClass(e,"leaflet-vml-shape"),this.options.clickable&&a.DomUtil.addClass(e,"leaflet-clickable"),e.coordsize="1 1",this._path=this._createElement("path"),e.appendChild(this._path),this._map._pathRoot.appendChild(e)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var e=this._stroke,t=this._fill,i=this.options,n=this._container;n.stroked=i.stroke,n.filled=i.fill,i.stroke?(e||(e=this._stroke=this._createElement("stroke"),e.endcap="round",n.appendChild(e)),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,e.dashStyle=i.dashArray?i.dashArray instanceof Array?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):""):e&&(n.removeChild(e),this._stroke=null),i.fill?(t||(t=this._fill=this._createElement("fill"),n.appendChild(t)),t.color=i.fillColor||i.color,t.opacity=i.fillOpacity):t&&(n.removeChild(t),this._fill=null)},_updatePath:function(){var e=this._container.style;e.display="none",this._path.v=this.getPathString()+" ",e.display=""}}),a.Map.include(a.Browser.svg||!a.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var e=this._pathRoot=t.createElement("div");e.className="leaflet-vml-container",this._panes.overlayPane.appendChild(e),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),a.Browser.canvas=function(){return!!t.createElement("canvas").getContext}(),a.Path=a.Path.SVG&&!e.L_PREFER_CANVAS||!a.Browser.canvas?a.Path:a.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(e){return a.setOptions(this,e),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(e){e.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this._map=null},_requestUpdate:function(){this._map&&!a.Path._updateRequest&&(a.Path._updateRequest=a.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){a.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var e=this.options;e.stroke&&(this._ctx.lineWidth=e.weight,this._ctx.strokeStyle=e.color),e.fill&&(this._ctx.fillStyle=e.fillColor||e.color)},_drawPath:function(){var e,t,i,n,o,r;for(this._ctx.beginPath(),e=0,i=this._parts.length;i>e;e++){for(t=0,n=this._parts[e].length;n>t;t++)o=this._parts[e][t],r=(0===t?"move":"line")+"To",this._ctx[r](o.x,o.y);this instanceof a.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var e=this._ctx,t=this.options;this._drawPath(),e.save(),this._updateStyle(),t.fill&&(e.globalAlpha=t.fillOpacity,e.fill()),t.stroke&&(e.globalAlpha=t.opacity,e.stroke()),e.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(e){this._containsPoint(e.layerPoint)&&this.fire("click",e)},_onMouseMove:function(e){this._map&&!this._map._animatingZoom&&(this._containsPoint(e.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",e)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",e)))}}),a.Map.include(a.Path.SVG&&!e.L_PREFER_CANVAS||!a.Browser.canvas?{}:{_initPathRoot:function(){var e,i=this._pathRoot;i||(i=this._pathRoot=t.createElement("canvas"),i.style.position="absolute",e=this._canvasCtx=i.getContext("2d"),e.lineCap="round",e.lineJoin="round",this._panes.overlayPane.appendChild(i),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,i=e.max.subtract(t),n=this._pathRoot;a.DomUtil.setPosition(n,t),n.width=i.x,n.height=i.y,n.getContext("2d").translate(-t.x,-t.y)}}}),a.LineUtil={simplify:function(e,t){if(!t||!e.length)return e.slice();var i=t*t;return e=this._reducePoints(e,i),e=this._simplifyDP(e,i)},pointToSegmentDistance:function(e,t,i){return Math.sqrt(this._sqClosestPointOnSegment(e,t,i,!0))},closestPointOnSegment:function(e,t,i){return this._sqClosestPointOnSegment(e,t,i)},_simplifyDP:function(e,t){var n=e.length,a=typeof Uint8Array!=i+""?Uint8Array:Array,o=new a(n);o[0]=o[n-1]=1,this._simplifyDPStep(e,o,t,0,n-1);var r,s=[];for(r=0;n>r;r++)o[r]&&s.push(e[r]);return s},_simplifyDPStep:function(e,t,i,n,a){var o,r,s,l=0;for(r=n+1;a-1>=r;r++)s=this._sqClosestPointOnSegment(e[r],e[n],e[a],!0),s>l&&(o=r,l=s);l>i&&(t[o]=1,this._simplifyDPStep(e,t,i,n,o),this._simplifyDPStep(e,t,i,o,a))},_reducePoints:function(e,t){for(var i=[e[0]],n=1,a=0,o=e.length;o>n;n++)this._sqDist(e[n],e[a])>t&&(i.push(e[n]),a=n);return o-1>a&&i.push(e[o-1]),i},clipSegment:function(e,t,i,n){var a,o,r,s=n?this._lastCode:this._getBitCode(e,i),l=this._getBitCode(t,i);for(this._lastCode=l;;){if(!(s|l))return[e,t];if(s&l)return!1;a=s||l,o=this._getEdgeIntersection(e,t,a,i),r=this._getBitCode(o,i),a===s?(e=o,s=r):(t=o,l=r)}},_getEdgeIntersection:function(e,t,i,n){var o=t.x-e.x,r=t.y-e.y,s=n.min,l=n.max;return 8&i?new a.Point(e.x+o*(l.y-e.y)/r,l.y):4&i?new a.Point(e.x+o*(s.y-e.y)/r,s.y):2&i?new a.Point(l.x,e.y+r*(l.x-e.x)/o):1&i?new a.Point(s.x,e.y+r*(s.x-e.x)/o):void 0},_getBitCode:function(e,t){var i=0;return e.x<t.min.x?i|=1:e.x>t.max.x&&(i|=2),e.y<t.min.y?i|=4:e.y>t.max.y&&(i|=8),i},_sqDist:function(e,t){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},_sqClosestPointOnSegment:function(e,t,i,n){var o,r=t.x,s=t.y,l=i.x-r,c=i.y-s,u=l*l+c*c;return u>0&&(o=((e.x-r)*l+(e.y-s)*c)/u,o>1?(r=i.x,s=i.y):o>0&&(r+=l*o,s+=c*o)),l=e.x-r,c=e.y-s,n?l*l+c*c:new a.Point(r,s)}},a.Polyline=a.Path.extend({initialize:function(e,t){a.Path.prototype.initialize.call(this,t),this._latlngs=this._convertLatLngs(e)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var e=0,t=this._latlngs.length;t>e;e++)this._originalPoints[e]=this._map.latLngToLayerPoint(this._latlngs[e])},getPathString:function(){for(var e=0,t=this._parts.length,i="";t>e;e++)i+=this._getPathPartStr(this._parts[e]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._latlngs=this._convertLatLngs(e),this.redraw()},addLatLng:function(e){return this._latlngs.push(a.latLng(e)),this.redraw()},spliceLatLngs:function(){var e=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),e},closestLayerPoint:function(e){for(var t,i,n=1/0,o=this._parts,r=null,s=0,l=o.length;l>s;s++)for(var c=o[s],u=1,h=c.length;h>u;u++){t=c[u-1],i=c[u];var d=a.LineUtil._sqClosestPointOnSegment(e,t,i,!0);n>d&&(n=d,r=a.LineUtil._sqClosestPointOnSegment(e,t,i))}return r&&(r.distance=Math.sqrt(n)),r},getBounds:function(){return new a.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(e,t){var i,n,o=t?e:[];for(i=0,n=e.length;n>i;i++){if(a.Util.isArray(e[i])&&"number"!=typeof e[i][0])return;o[i]=a.latLng(e[i])}return o},_initEvents:function(){a.Path.prototype._initEvents.call(this)},_getPathPartStr:function(e){for(var t,i=a.Path.VML,n=0,o=e.length,r="";o>n;n++)t=e[n],i&&t._round(),r+=(n?"L":"M")+t.x+" "+t.y;return r},_clipPoints:function(){var e,t,i,n=this._originalPoints,o=n.length;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var r=this._parts,s=this._map._pathViewport,l=a.LineUtil;for(e=0,t=0;o-1>e;e++)i=l.clipSegment(n[e],n[e+1],s,e),i&&(r[t]=r[t]||[],r[t].push(i[0]),(i[1]!==n[e+1]||e===o-2)&&(r[t].push(i[1]),t++))},_simplifyPoints:function(){for(var e=this._parts,t=a.LineUtil,i=0,n=e.length;n>i;i++)e[i]=t.simplify(e[i],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),a.Path.prototype._updatePath.call(this))}}),a.polyline=function(e,t){return new a.Polyline(e,t)},a.PolyUtil={},a.PolyUtil.clipPolygon=function(e,t){var i,n,o,r,s,l,c,u,h,d=[1,4,2,8],p=a.LineUtil;for(n=0,c=e.length;c>n;n++)e[n]._code=p._getBitCode(e[n],t);for(r=0;4>r;r++){for(u=d[r],i=[],n=0,c=e.length,o=c-1;c>n;o=n++)s=e[n],l=e[o],s._code&u?l._code&u||(h=p._getEdgeIntersection(l,s,u,t),h._code=p._getBitCode(h,t),i.push(h)):(l._code&u&&(h=p._getEdgeIntersection(l,s,u,t),h._code=p._getBitCode(h,t),i.push(h)),i.push(s));e=i}return e},a.Polygon=a.Polyline.extend({options:{fill:!0},initialize:function(e,t){var i,n,o;if(a.Polyline.prototype.initialize.call(this,e,t),e&&a.Util.isArray(e[0])&&"number"!=typeof e[0][0])for(this._latlngs=this._convertLatLngs(e[0]),this._holes=e.slice(1),i=0,n=this._holes.length;n>i;i++)o=this._holes[i]=this._convertLatLngs(this._holes[i]),o[0].equals(o[o.length-1])&&o.pop();e=this._latlngs,e.length>=2&&e[0].equals(e[e.length-1])&&e.pop()},projectLatlngs:function(){if(a.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var e,t,i,n;for(e=0,i=this._holes.length;i>e;e++)for(this._holePoints[e]=[],t=0,n=this._holes[e].length;n>t;t++)this._holePoints[e][t]=this._map.latLngToLayerPoint(this._holes[e][t])}},_clipPoints:function(){var e=this._originalPoints,t=[];if(this._parts=[e].concat(this._holePoints),!this.options.noClip){for(var i=0,n=this._parts.length;n>i;i++){var o=a.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);o.length&&t.push(o)}this._parts=t}},_getPathPartStr:function(e){var t=a.Polyline.prototype._getPathPartStr.call(this,e);return t+(a.Browser.svg?"z":"x")}}),a.polygon=function(e,t){return new a.Polygon(e,t)},function(){function e(e){return a.FeatureGroup.extend({initialize:function(e,t){this._layers={},this._options=t,this.setLatLngs(e)},setLatLngs:function(t){var i=0,n=t.length;for(this.eachLayer(function(e){n>i?e.setLatLngs(t[i++]):this.removeLayer(e)},this);n>i;)this.addLayer(new e(t[i++],this._options));return this},getLatLngs:function(){var e=[];return this.eachLayer(function(t){e.push(t.getLatLngs())}),e}})}a.MultiPolyline=e(a.Polyline),a.MultiPolygon=e(a.Polygon),a.multiPolyline=function(e,t){return new a.MultiPolyline(e,t)},a.multiPolygon=function(e,t){return new a.MultiPolygon(e,t)}}(),a.Rectangle=a.Polygon.extend({initialize:function(e,t){a.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=a.latLngBounds(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}}),a.rectangle=function(e,t){return new a.Rectangle(e,t)},a.Circle=a.Path.extend({initialize:function(e,t,i){a.Path.prototype.initialize.call(this,i),this._latlng=a.latLng(e),this._mRadius=t},options:{fill:!0},setLatLng:function(e){return this._latlng=a.latLng(e),this.redraw()},setRadius:function(e){return this._mRadius=e,this.redraw()},projectLatlngs:function(){var e=this._getLngRadius(),t=this._latlng,i=this._map.latLngToLayerPoint([t.lat,t.lng-e]);this._point=this._map.latLngToLayerPoint(t),this._radius=Math.max(this._point.x-i.x,1)},getBounds:function(){var e=this._getLngRadius(),t=360*(this._mRadius/40075017),i=this._latlng;return new a.LatLngBounds([i.lat-t,i.lng-e],[i.lat+t,i.lng+e])},getLatLng:function(){return this._latlng},getPathString:function(){var e=this._point,t=this._radius;return this._checkIfEmpty()?"":a.Browser.svg?"M"+e.x+","+(e.y-t)+"A"+t+","+t+",0,1,1,"+(e.x-.1)+","+(e.y-t)+" z":(e._round(),t=Math.round(t),"AL "+e.x+","+e.y+" "+t+","+t+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return 360*(this._mRadius/40075017)},_getLngRadius:function(){return this._getLatRadius()/Math.cos(a.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var e=this._map._pathViewport,t=this._radius,i=this._point;return i.x-t>e.max.x||i.y-t>e.max.y||i.x+t<e.min.x||i.y+t<e.min.y}}),a.circle=function(e,t,i){return new a.Circle(e,t,i)},a.CircleMarker=a.Circle.extend({options:{radius:10,weight:2},initialize:function(e,t){a.Circle.prototype.initialize.call(this,e,null,t),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){a.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()}}),a.circleMarker=function(e,t){return new a.CircleMarker(e,t)},a.Polyline.include(a.Path.CANVAS?{_containsPoint:function(e,t){var i,n,o,r,s,l,c,u=this.options.weight/2;for(a.Browser.touch&&(u+=10),i=0,r=this._parts.length;r>i;i++)for(c=this._parts[i],n=0,s=c.length,o=s-1;s>n;o=n++)if((t||0!==n)&&(l=a.LineUtil.pointToSegmentDistance(e,c[o],c[n]),u>=l))return!0;return!1}}:{}),a.Polygon.include(a.Path.CANVAS?{_containsPoint:function(e){var t,i,n,o,r,s,l,c,u=!1;if(a.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(o=0,l=this._parts.length;l>o;o++)for(t=this._parts[o],r=0,c=t.length,s=c-1;c>r;s=r++)i=t[r],n=t[s],i.y>e.y!=n.y>e.y&&e.x<(n.x-i.x)*(e.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u}}:{}),a.Circle.include(a.Path.CANVAS?{_drawPath:function(){var e=this._point;this._ctx.beginPath(),this._ctx.arc(e.x,e.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(e){var t=this._point,i=this.options.stroke?this.options.weight/2:0;return e.distanceTo(t)<=this._radius+i}}:{}),a.CircleMarker.include(a.Path.CANVAS?{_updateStyle:function(){a.Path.prototype._updateStyle.call(this)}}:{}),a.GeoJSON=a.FeatureGroup.extend({initialize:function(e,t){a.setOptions(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,i,n,o=a.Util.isArray(e)?e:e.features;if(o){for(t=0,i=o.length;i>t;t++)n=o[t],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(o[t]);return this}var r=this.options;if(!r.filter||r.filter(e)){var s=a.GeoJSON.geometryToLayer(e,r.pointToLayer,r.coordsToLatLng);return s.feature=a.GeoJSON.asFeature(e),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(e,s),this.addLayer(s)}},resetStyle:function(e){var t=this.options.style;t&&(a.Util.extend(e.options,e.defaultOptions),this._setLayerStyle(e,t))},setStyle:function(e){this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){"function"==typeof t&&(t=t(e.feature)),e.setStyle&&e.setStyle(t)}}),a.extend(a.GeoJSON,{geometryToLayer:function(e,t,i){var n,o,r,s,l,c="Feature"===e.type?e.geometry:e,u=c.coordinates,h=[];switch(i=i||this.coordsToLatLng,c.type){case"Point":return n=i(u),t?t(e,n):new a.Marker(n);case"MultiPoint":for(r=0,s=u.length;s>r;r++)n=i(u[r]),l=t?t(e,n):new a.Marker(n),h.push(l);return new a.FeatureGroup(h);case"LineString":return o=this.coordsToLatLngs(u,0,i),new a.Polyline(o);case"Polygon":return o=this.coordsToLatLngs(u,1,i),new a.Polygon(o);case"MultiLineString":return o=this.coordsToLatLngs(u,1,i),new a.MultiPolyline(o);case"MultiPolygon":return o=this.coordsToLatLngs(u,2,i),new a.MultiPolygon(o);case"GeometryCollection":for(r=0,s=c.geometries.length;s>r;r++)l=this.geometryToLayer({geometry:c.geometries[r],type:"Feature",properties:e.properties},t,i),h.push(l);return new a.FeatureGroup(h);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e){return new a.LatLng(e[1],e[0])},coordsToLatLngs:function(e,t,i){var n,a,o,r=[];for(a=0,o=e.length;o>a;a++)n=t?this.coordsToLatLngs(e[a],t-1,i):(i||this.coordsToLatLng)(e[a]),r.push(n);return r},latLngToCoords:function(e){return[e.lng,e.lat]},latLngsToCoords:function(e){for(var t=[],i=0,n=e.length;n>i;i++)t.push(a.GeoJSON.latLngToCoords(e[i]));return t},getFeature:function(e,t){return e.feature?a.extend({},e.feature,{geometry:t}):a.GeoJSON.asFeature(t)},asFeature:function(e){return"Feature"===e.type?e:{type:"Feature",properties:{},geometry:e}}});var r={toGeoJSON:function(){return a.GeoJSON.getFeature(this,{type:"Point",coordinates:a.GeoJSON.latLngToCoords(this.getLatLng())})}};a.Marker.include(r),a.Circle.include(r),a.CircleMarker.include(r),a.Polyline.include({toGeoJSON:function(){return a.GeoJSON.getFeature(this,{type:"LineString",coordinates:a.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),a.Polygon.include({toGeoJSON:function(){var e,t,i,n=[a.GeoJSON.latLngsToCoords(this.getLatLngs())];if(n[0].push(n[0][0]),this._holes)for(e=0,t=this._holes.length;t>e;e++)i=a.GeoJSON.latLngsToCoords(this._holes[e]),i.push(i[0]),n.push(i);return a.GeoJSON.getFeature(this,{type:"Polygon",coordinates:n})}}),function(){function e(e,t){e.include({toGeoJSON:function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),a.GeoJSON.getFeature(this,{type:t,coordinates:e})}})}e(a.MultiPolyline,"MultiLineString"),e(a.MultiPolygon,"MultiPolygon")}(),a.LayerGroup.include({toGeoJSON:function(){var e=[];return this.eachLayer(function(t){t.toGeoJSON&&e.push(a.GeoJSON.asFeature(t.toGeoJSON()))}),{type:"FeatureCollection",features:e}}}),a.geoJson=function(e,t){return new a.GeoJSON(e,t)},a.DomEvent={addListener:function(e,t,i,n){var o,r,s,l=a.stamp(i),c="_leaflet_"+t+l;return e[c]?this:(o=function(t){return i.call(n||e,t||a.DomEvent._getEvent())},a.Browser.msTouch&&0===t.indexOf("touch")?this.addMsTouchListener(e,t,o,l):(a.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener&&this.addDoubleTapListener(e,o,l),"addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",o,!1),e.addEventListener(t,o,!1)):"mouseenter"===t||"mouseleave"===t?(r=o,s="mouseenter"===t?"mouseover":"mouseout",o=function(t){return a.DomEvent._checkMouse(e,t)?r(t):void 0},e.addEventListener(s,o,!1)):"click"===t&&a.Browser.android?(r=o,o=function(e){return a.DomEvent._filterClick(e,r)},e.addEventListener(t,o,!1)):e.addEventListener(t,o,!1):"attachEvent"in e&&e.attachEvent("on"+t,o),e[c]=o,this))},removeListener:function(e,t,i){var n=a.stamp(i),o="_leaflet_"+t+n,r=e[o];return r?(a.Browser.msTouch&&0===t.indexOf("touch")?this.removeMsTouchListener(e,t,n):a.Browser.touch&&"dblclick"===t&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,n):"removeEventListener"in e?"mousewheel"===t?(e.removeEventListener("DOMMouseScroll",r,!1),e.removeEventListener(t,r,!1)):"mouseenter"===t||"mouseleave"===t?e.removeEventListener("mouseenter"===t?"mouseover":"mouseout",r,!1):e.removeEventListener(t,r,!1):"detachEvent"in e&&e.detachEvent("on"+t,r),e[o]=null,this):this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this},disableClickPropagation:function(e){for(var t=a.DomEvent.stopPropagation,i=a.Draggable.START.length-1;i>=0;i--)a.DomEvent.addListener(e,a.Draggable.START[i],t);return a.DomEvent.addListener(e,"click",a.DomEvent._fakeStop).addListener(e,"dblclick",t)},preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stop:function(e){return a.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,i){var n=a.Browser.ie7,o=t.body,r=t.documentElement,s=e.pageX?e.pageX-o.scrollLeft-r.scrollLeft:e.clientX,l=e.pageY?e.pageY-o.scrollTop-r.scrollTop:e.clientY,c=new a.Point(s,l),u=i.getBoundingClientRect(),h=u.left-i.clientLeft,d=u.top-i.clientTop;return a.DomUtil.documentIsLtr()||!a.Browser.webkit&&!n||(h+=i.scrollWidth-i.clientWidth,n&&"hidden"!==a.DomUtil.getStyle(i,"overflow-y")&&"hidden"!==a.DomUtil.getStyle(i,"overflow")&&(h+=17)),c._subtract(new a.Point(h,d))},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_skipEvents:{},_fakeStop:function(e){a.DomEvent._skipEvents[e.type]=!0},_skipped:function(e){var t=this._skipEvents[e.type];return this._skipEvents[e.type]=!1,t},_checkMouse:function(e,t){var i=t.relatedTarget;if(!i)return!0;try{for(;i&&i!==e;)i=i.parentNode}catch(n){return!1}return i!==e},_getEvent:function(){var t=e.event;if(!t)for(var i=arguments.callee.caller;i&&(t=i.arguments[0],!t||e.Event!==t.constructor);)i=i.caller;return t},_filterClick:function(e,t){var i=e.timeStamp||e.originalEvent.timeStamp,n=a.DomEvent._lastClick&&i-a.DomEvent._lastClick;return n&&n>100&&1e3>n||e.target._simulatedClick&&!e._simulated?void a.DomEvent.stop(e):(a.DomEvent._lastClick=i,t(e))}},a.DomEvent.on=a.DomEvent.addListener,a.DomEvent.off=a.DomEvent.removeListener,a.Draggable=a.Class.extend({includes:a.Mixin.Events,statics:{START:a.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",MSPointerDown:"touchmove"}},initialize:function(e,t){this._element=e,this._dragStartTarget=t||e},enable:function(){if(!this._enabled){for(var e=a.Draggable.START.length-1;e>=0;e--)a.DomEvent.on(this._dragStartTarget,a.Draggable.START[e],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var e=a.Draggable.START.length-1;e>=0;e--)a.DomEvent.off(this._dragStartTarget,a.Draggable.START[e],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(e){if(!e.shiftKey&&(1===e.which||1===e.button||e.touches)&&(a.DomEvent.stopPropagation(e),!a.Draggable._disabled)){a.DomUtil.disableImageDrag(),a.DomUtil.disableTextSelection();var i=e.touches?e.touches[0]:e,n=i.target;a.Browser.touch&&"a"===n.tagName.toLowerCase()&&a.DomUtil.addClass(n,"leaflet-active"),this._moved=!1,this._moving||(this._startPoint=new a.Point(i.clientX,i.clientY),this._startPos=this._newPos=a.DomUtil.getPosition(this._element),a.DomEvent.on(t,a.Draggable.MOVE[e.type],this._onMove,this).on(t,a.Draggable.END[e.type],this._onUp,this))}},_onMove:function(e){if(!(e.touches&&e.touches.length>1)){var i=e.touches&&1===e.touches.length?e.touches[0]:e,n=new a.Point(i.clientX,i.clientY),o=n.subtract(this._startPoint);(o.x||o.y)&&(a.DomEvent.preventDefault(e),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=a.DomUtil.getPosition(this._element).subtract(o),a.Browser.touch||a.DomUtil.addClass(t.body,"leaflet-dragging")),this._newPos=this._startPos.add(o),this._moving=!0,a.Util.cancelAnimFrame(this._animRequest),this._animRequest=a.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget))}},_updatePosition:function(){this.fire("predrag"),a.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){a.Browser.touch||a.DomUtil.removeClass(t.body,"leaflet-dragging");for(var e in a.Draggable.MOVE)a.DomEvent.off(t,a.Draggable.MOVE[e],this._onMove).off(t,a.Draggable.END[e],this._onUp);a.DomUtil.enableImageDrag(),a.DomUtil.enableTextSelection(),this._moved&&(a.Util.cancelAnimFrame(this._animRequest),this.fire("dragend")),this._moving=!1}}),a.Handler=a.Class.extend({initialize:function(e){this._map=e},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),a.Map.mergeOptions({dragging:!0,inertia:!a.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:a.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),a.Map.Drag=a.Handler.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new a.Draggable(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),e.on("viewreset",this._onViewReset,this),this._onViewReset())}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var e=this._map;e._panAnim&&e._panAnim.stop(),e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var e=this._lastTime=+new Date,t=this._lastPos=this._draggable._newPos;this._positions.push(t),this._times.push(e),e-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var e=this._map.getSize()._divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var e=this._worldWidth,t=Math.round(e/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,a=(n-t+i)%e+t-i,o=(n+t+i)%e-t-i,r=Math.abs(a+i)<Math.abs(o+i)?a:o;this._draggable._newPos.x=r},_onDragEnd:function(){var e=this._map,t=e.options,i=+new Date-this._lastTime,n=!t.inertia||i>t.inertiaThreshold||!this._positions[0];if(e.fire("dragend"),n)e.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),r=(this._lastTime+i-this._times[0])/1e3,s=t.easeLinearity,l=o.multiplyBy(s/r),c=l.distanceTo([0,0]),u=Math.min(t.inertiaMaxSpeed,c),h=l.multiplyBy(u/c),d=u/(t.inertiaDeceleration*s),p=h.multiplyBy(-d/2).round();p.x&&p.y?a.Util.requestAnimFrame(function(){e.panBy(p,{duration:d,easeLinearity:s,noMoveStart:!0})}):e.fire("moveend")}}}),a.Map.addInitHook("addHandler","dragging",a.Map.Drag),a.Map.mergeOptions({doubleClickZoom:!0}),a.Map.DoubleClickZoom=a.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick)},_onDoubleClick:function(e){this.setZoomAround(e.containerPoint,this._zoom+1)}}),a.Map.addInitHook("addHandler","doubleClickZoom",a.Map.DoubleClickZoom),a.Map.mergeOptions({scrollWheelZoom:!0}),a.Map.ScrollWheelZoom=a.Handler.extend({addHooks:function(){a.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),a.DomEvent.on(this._map._container,"MozMousePixelScroll",a.DomEvent.preventDefault),this._delta=0},removeHooks:function(){a.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),a.DomEvent.off(this._map._container,"MozMousePixelScroll",a.DomEvent.preventDefault)},_onWheelScroll:function(e){var t=a.DomEvent.getWheelDelta(e);this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a.bind(this._performZoom,this),i),a.DomEvent.preventDefault(e),a.DomEvent.stopPropagation(e)},_performZoom:function(){var e=this._map,t=this._delta,i=e.getZoom();t=t>0?Math.ceil(t):Math.floor(t),t=Math.max(Math.min(t,4),-4),t=e._limitZoom(i+t)-i,this._delta=0,this._startTime=null,t&&e.setZoomAround(this._lastMousePos,i+t)}}),a.Map.addInitHook("addHandler","scrollWheelZoom",a.Map.ScrollWheelZoom),a.extend(a.DomEvent,{_touchstart:a.Browser.msTouch?"MSPointerDown":"touchstart",_touchend:a.Browser.msTouch?"MSPointerUp":"touchend",addDoubleTapListener:function(e,i,n){function o(e){var t;if(a.Browser.msTouch?(f.push(e.pointerId),t=f.length):t=e.touches.length,!(t>1)){var i=Date.now(),n=i-(s||i);l=e.touches?e.touches[0]:e,c=n>0&&u>=n,s=i}}function r(e){if(a.Browser.msTouch){var t=f.indexOf(e.pointerId);if(-1===t)return;f.splice(t,1)}if(c){if(a.Browser.msTouch){var n,o={};for(var r in l)n=l[r],o[r]="function"==typeof n?n.bind(l):n;l=o}l.type="dblclick",i(l),s=null}}var s,l,c=!1,u=250,h="_leaflet_",d=this._touchstart,p=this._touchend,f=[];e[h+d+n]=o,e[h+p+n]=r;var m=a.Browser.msTouch?t.documentElement:e;return e.addEventListener(d,o,!1),m.addEventListener(p,r,!1),a.Browser.msTouch&&m.addEventListener("MSPointerCancel",r,!1),this},removeDoubleTapListener:function(e,i){var n="_leaflet_";return e.removeEventListener(this._touchstart,e[n+this._touchstart+i],!1),(a.Browser.msTouch?t.documentElement:e).removeEventListener(this._touchend,e[n+this._touchend+i],!1),a.Browser.msTouch&&t.documentElement.removeEventListener("MSPointerCancel",e[n+this._touchend+i],!1),this}}),a.extend(a.DomEvent,{_msTouches:[],_msDocumentListener:!1,addMsTouchListener:function(e,t,i,n){switch(t){case"touchstart":return this.addMsTouchListenerStart(e,t,i,n);case"touchend":return this.addMsTouchListenerEnd(e,t,i,n);case"touchmove":return this.addMsTouchListenerMove(e,t,i,n);default:throw"Unknown touch event type"}},addMsTouchListenerStart:function(e,i,n,a){var o="_leaflet_",r=this._msTouches,s=function(e){for(var t=!1,i=0;i<r.length;i++)if(r[i].pointerId===e.pointerId){t=!0;break}t||r.push(e),e.touches=r.slice(),e.changedTouches=[e],n(e)};if(e[o+"touchstart"+a]=s,e.addEventListener("MSPointerDown",s,!1),!this._msDocumentListener){var l=function(e){for(var t=0;t<r.length;t++)if(r[t].pointerId===e.pointerId){r.splice(t,1);break}};t.documentElement.addEventListener("MSPointerUp",l,!1),t.documentElement.addEventListener("MSPointerCancel",l,!1),this._msDocumentListener=!0}return this},addMsTouchListenerMove:function(e,t,i,n){function a(e){if(e.pointerType!==e.MSPOINTER_TYPE_MOUSE||0!==e.buttons){for(var t=0;t<r.length;t++)if(r[t].pointerId===e.pointerId){r[t]=e;break}e.touches=r.slice(),e.changedTouches=[e],i(e)}}var o="_leaflet_",r=this._msTouches;return e[o+"touchmove"+n]=a,e.addEventListener("MSPointerMove",a,!1),this},addMsTouchListenerEnd:function(e,t,i,n){var a="_leaflet_",o=this._msTouches,r=function(e){for(var t=0;t<o.length;t++)if(o[t].pointerId===e.pointerId){o.splice(t,1);break}e.touches=o.slice(),e.changedTouches=[e],i(e)};return e[a+"touchend"+n]=r,e.addEventListener("MSPointerUp",r,!1),e.addEventListener("MSPointerCancel",r,!1),this},removeMsTouchListener:function(e,t,i){var n="_leaflet_",a=e[n+t+i];switch(t){case"touchstart":e.removeEventListener("MSPointerDown",a,!1);break;case"touchmove":e.removeEventListener("MSPointerMove",a,!1);break;case"touchend":e.removeEventListener("MSPointerUp",a,!1),e.removeEventListener("MSPointerCancel",a,!1)}return this}}),a.Map.mergeOptions({touchZoom:a.Browser.touch&&!a.Browser.android23}),a.Map.TouchZoom=a.Handler.extend({addHooks:function(){a.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){a.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var i=this._map;if(e.touches&&2===e.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToLayerPoint(e.touches[0]),o=i.mouseEventToLayerPoint(e.touches[1]),r=i._getCenterLayerPoint();this._startCenter=n.add(o)._divideBy(2),this._startDist=n.distanceTo(o),this._moved=!1,this._zooming=!0,this._centerOffset=r.subtract(this._startCenter),i._panAnim&&i._panAnim.stop(),a.DomEvent.on(t,"touchmove",this._onTouchMove,this).on(t,"touchend",this._onTouchEnd,this),a.DomEvent.preventDefault(e)}},_onTouchMove:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&this._zooming){var i=t.mouseEventToLayerPoint(e.touches[0]),n=t.mouseEventToLayerPoint(e.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(this._moved||(a.DomUtil.addClass(t._mapPane,"leaflet-touching"),t.fire("movestart").fire("zoomstart"),this._moved=!0),a.Util.cancelAnimFrame(this._animRequest),this._animRequest=a.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),a.DomEvent.preventDefault(e))}},_updateOnMove:function(){var e=this._map,t=this._getScaleOrigin(),i=e.layerPointToLatLng(t),n=e.getScaleZoom(this._scale);e._animateZoom(i,n,this._startCenter,this._scale,this._delta)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var e=this._map;this._zooming=!1,a.DomUtil.removeClass(e._mapPane,"leaflet-touching"),a.Util.cancelAnimFrame(this._animRequest),a.DomEvent.off(t,"touchmove",this._onTouchMove).off(t,"touchend",this._onTouchEnd);var i=this._getScaleOrigin(),n=e.layerPointToLatLng(i),o=e.getZoom(),r=e.getScaleZoom(this._scale)-o,s=r>0?Math.ceil(r):Math.floor(r),l=e._limitZoom(o+s),c=e.getZoomScale(l)/this._scale;
e._animateZoom(n,l,i,c)},_getScaleOrigin:function(){var e=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(e)}}),a.Map.addInitHook("addHandler","touchZoom",a.Map.TouchZoom),a.Map.mergeOptions({tap:!0,tapTolerance:15}),a.Map.Tap=a.Handler.extend({addHooks:function(){a.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){a.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(e.touches){if(a.DomEvent.preventDefault(e),this._fireClick=!0,e.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=e.touches[0],n=i.target;this._startPos=this._newPos=new a.Point(i.clientX,i.clientY),"a"===n.tagName.toLowerCase()&&a.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(a.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),a.DomEvent.on(t,"touchmove",this._onMove,this).on(t,"touchend",this._onUp,this)}},_onUp:function(e){if(clearTimeout(this._holdTimeout),a.DomEvent.off(t,"touchmove",this._onMove,this).off(t,"touchend",this._onUp,this),this._fireClick&&e&&e.changedTouches){var i=e.changedTouches[0],n=i.target;"a"===n.tagName.toLowerCase()&&a.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(e){var t=e.touches[0];this._newPos=new a.Point(t.clientX,t.clientY)},_simulateEvent:function(i,n){var a=t.createEvent("MouseEvents");a._simulated=!0,n.target._simulatedClick=!0,a.initMouseEvent(i,!0,!0,e,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(a)}}),a.Browser.touch&&!a.Browser.msTouch&&a.Map.addInitHook("addHandler","tap",a.Map.Tap),a.Map.mergeOptions({boxZoom:!0}),a.Map.BoxZoom=a.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){a.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){a.DomEvent.off(this._container,"mousedown",this._onMouseDown)},_onMouseDown:function(e){return!e.shiftKey||1!==e.which&&1!==e.button?!1:(a.DomUtil.disableTextSelection(),a.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(e),this._box=a.DomUtil.create("div","leaflet-zoom-box",this._pane),a.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",a.DomEvent.on(t,"mousemove",this._onMouseMove,this).on(t,"mouseup",this._onMouseUp,this).on(t,"keydown",this._onKeyDown,this),void this._map.fire("boxzoomstart"))},_onMouseMove:function(e){var t=this._startLayerPoint,i=this._box,n=this._map.mouseEventToLayerPoint(e),o=n.subtract(t),r=new a.Point(Math.min(n.x,t.x),Math.min(n.y,t.y));a.DomUtil.setPosition(i,r),i.style.width=Math.max(0,Math.abs(o.x)-4)+"px",i.style.height=Math.max(0,Math.abs(o.y)-4)+"px"},_finish:function(){this._pane.removeChild(this._box),this._container.style.cursor="",a.DomUtil.enableTextSelection(),a.DomUtil.enableImageDrag(),a.DomEvent.off(t,"mousemove",this._onMouseMove).off(t,"mouseup",this._onMouseUp).off(t,"keydown",this._onKeyDown)},_onMouseUp:function(e){this._finish();var t=this._map,i=t.mouseEventToLayerPoint(e);if(!this._startLayerPoint.equals(i)){var n=new a.LatLngBounds(t.layerPointToLatLng(this._startLayerPoint),t.layerPointToLatLng(i));t.fitBounds(n),t.fire("boxzoomend",{boxZoomBounds:n})}},_onKeyDown:function(e){27===e.keyCode&&this._finish()}}),a.Map.addInitHook("addHandler","boxZoom",a.Map.BoxZoom),a.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),a.Map.Keyboard=a.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61],zoomOut:[189,109,173]},initialize:function(e){this._map=e,this._setPanOffset(e.options.keyboardPanOffset),this._setZoomOffset(e.options.keyboardZoomOffset)},addHooks:function(){var e=this._map._container;-1===e.tabIndex&&(e.tabIndex="0"),a.DomEvent.on(e,"focus",this._onFocus,this).on(e,"blur",this._onBlur,this).on(e,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var e=this._map._container;a.DomEvent.off(e,"focus",this._onFocus,this).off(e,"blur",this._onBlur,this).off(e,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var i=t.body,n=t.documentElement,a=i.scrollTop||n.scrollTop,o=i.scrollLeft||n.scrollLeft;this._map._container.focus(),e.scrollTo(o,a)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(e){var t,i,n=this._panKeys={},a=this.keyCodes;for(t=0,i=a.left.length;i>t;t++)n[a.left[t]]=[-1*e,0];for(t=0,i=a.right.length;i>t;t++)n[a.right[t]]=[e,0];for(t=0,i=a.down.length;i>t;t++)n[a.down[t]]=[0,e];for(t=0,i=a.up.length;i>t;t++)n[a.up[t]]=[0,-1*e]},_setZoomOffset:function(e){var t,i,n=this._zoomKeys={},a=this.keyCodes;for(t=0,i=a.zoomIn.length;i>t;t++)n[a.zoomIn[t]]=e;for(t=0,i=a.zoomOut.length;i>t;t++)n[a.zoomOut[t]]=-e},_addHooks:function(){a.DomEvent.on(t,"keydown",this._onKeyDown,this)},_removeHooks:function(){a.DomEvent.off(t,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){var t=e.keyCode,i=this._map;if(t in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[t]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(t in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[t])}a.DomEvent.stop(e)}}),a.Map.addInitHook("addHandler","keyboard",a.Map.Keyboard),a.Handler.MarkerDrag=a.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new a.Draggable(e,e)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable()},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var e=this._marker,t=e._shadow,i=a.DomUtil.getPosition(e._icon),n=e._map.layerPointToLatLng(i);t&&a.DomUtil.setPosition(t,i),e._latlng=n,e.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(){this._marker.fire("moveend").fire("dragend")}}),a.Control=a.Class.extend({options:{position:"topright"},initialize:function(e){a.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),i=this.getPosition(),n=e._controlCorners[i];return a.DomUtil.addClass(t,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(t,n.firstChild):n.appendChild(t),this},removeFrom:function(e){var t=this.getPosition(),i=e._controlCorners[t];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(e),this}}),a.control=function(e){return new a.Control(e)},a.Map.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.removeFrom(this),this},_initControlPos:function(){function e(e,o){var r=i+e+" "+i+o;t[e+o]=a.DomUtil.create("div",r,n)}var t=this._controlCorners={},i="leaflet-",n=this._controlContainer=a.DomUtil.create("div",i+"control-container",this._container);e("top","left"),e("top","right"),e("bottom","left"),e("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),a.Control.Zoom=a.Control.extend({options:{position:"topleft"},onAdd:function(e){var t="leaflet-control-zoom",i=a.DomUtil.create("div",t+" leaflet-bar");return this._map=e,this._zoomInButton=this._createButton("+","Zoom in",t+"-in",i,this._zoomIn,this),this._zoomOutButton=this._createButton("-","Zoom out",t+"-out",i,this._zoomOut,this),e.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(e){this._map.zoomIn(e.shiftKey?3:1)},_zoomOut:function(e){this._map.zoomOut(e.shiftKey?3:1)},_createButton:function(e,t,i,n,o,r){var s=a.DomUtil.create("a",i,n);s.innerHTML=e,s.href="#",s.title=t;var l=a.DomEvent.stopPropagation;return a.DomEvent.on(s,"click",l).on(s,"mousedown",l).on(s,"dblclick",l).on(s,"click",a.DomEvent.preventDefault).on(s,"click",o,r),s},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";a.DomUtil.removeClass(this._zoomInButton,t),a.DomUtil.removeClass(this._zoomOutButton,t),e._zoom===e.getMinZoom()&&a.DomUtil.addClass(this._zoomOutButton,t),e._zoom===e.getMaxZoom()&&a.DomUtil.addClass(this._zoomInButton,t)}}),a.Map.mergeOptions({zoomControl:!0}),a.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new a.Control.Zoom,this.addControl(this.zoomControl))}),a.control.zoom=function(e){return new a.Control.Zoom(e)},a.Control.Attribution=a.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(e){a.setOptions(this,e),this._attributions={}},onAdd:function(e){return this._container=a.DomUtil.create("div","leaflet-control-attribution"),a.DomEvent.disableClickPropagation(this._container),e.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(e){e.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):void 0},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):void 0},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var i=[];this.options.prefix&&i.push(this.options.prefix),e.length&&i.push(e.join(", ")),this._container.innerHTML=i.join(" | ")}},_onLayerAdd:function(e){e.layer.getAttribution&&this.addAttribution(e.layer.getAttribution())},_onLayerRemove:function(e){e.layer.getAttribution&&this.removeAttribution(e.layer.getAttribution())}}),a.Map.mergeOptions({attributionControl:!0}),a.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new a.Control.Attribution).addTo(this))}),a.control.attribution=function(e){return new a.Control.Attribution(e)},a.Control.Scale=a.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(e){this._map=e;var t="leaflet-control-scale",i=a.DomUtil.create("div",t),n=this.options;return this._addScales(n,t,i),e.on(n.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),i},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,i){e.metric&&(this._mScale=a.DomUtil.create("div",t+"-line",i)),e.imperial&&(this._iScale=a.DomUtil.create("div",t+"-line",i))},_update:function(){var e=this._map.getBounds(),t=e.getCenter().lat,i=6378137*Math.PI*Math.cos(t*Math.PI/180),n=i*(e.getNorthEast().lng-e.getSouthWest().lng)/180,a=this._map.getSize(),o=this.options,r=0;a.x>0&&(r=n*(o.maxWidth/a.x)),this._updateScales(o,r)},_updateScales:function(e,t){e.metric&&t&&this._updateMetric(t),e.imperial&&t&&this._updateImperial(t)},_updateMetric:function(e){var t=this._getRoundNum(e);this._mScale.style.width=this._getScaleWidth(t/e)+"px",this._mScale.innerHTML=1e3>t?t+" m":t/1e3+" km"},_updateImperial:function(e){var t,i,n,a=3.2808399*e,o=this._iScale;a>5280?(t=a/5280,i=this._getRoundNum(t),o.style.width=this._getScaleWidth(i/t)+"px",o.innerHTML=i+" mi"):(n=this._getRoundNum(a),o.style.width=this._getScaleWidth(n/a)+"px",o.innerHTML=n+" ft")},_getScaleWidth:function(e){return Math.round(this.options.maxWidth*e)-10},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,t*i}}),a.control.scale=function(e){return new a.Control.Scale(e)},a.Control.Layers=a.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(e,t,i){a.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var n in e)this._addLayer(e[n],n);for(n in t)this._addLayer(t[n],n,!0)},onAdd:function(e){return this._initLayout(),this._update(),e.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(e){e.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._update(),this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._update(),this},removeLayer:function(e){var t=a.stamp(e);return delete this._layers[t],this._update(),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=a.DomUtil.create("div",e);t.setAttribute("aria-haspopup",!0),a.Browser.touch?a.DomEvent.on(t,"click",a.DomEvent.stopPropagation):(a.DomEvent.disableClickPropagation(t),a.DomEvent.on(t,"mousewheel",a.DomEvent.stopPropagation));var i=this._form=a.DomUtil.create("form",e+"-list");if(this.options.collapsed){a.Browser.android||a.DomEvent.on(t,"mouseover",this._expand,this).on(t,"mouseout",this._collapse,this);var n=this._layersLink=a.DomUtil.create("a",e+"-toggle",t);n.href="#",n.title="Layers",a.Browser.touch?a.DomEvent.on(n,"click",a.DomEvent.stop).on(n,"click",this._expand,this):a.DomEvent.on(n,"focus",this._expand,this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=a.DomUtil.create("div",e+"-base",i),this._separator=a.DomUtil.create("div",e+"-separator",i),this._overlaysList=a.DomUtil.create("div",e+"-overlays",i),t.appendChild(i)},_addLayer:function(e,t,i){var n=a.stamp(e);this._layers[n]={layer:e,name:t,overlay:i},this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var e,t,i=!1,n=!1;for(e in this._layers)t=this._layers[e],this._addItem(t),n=n||t.overlay,i=i||!t.overlay;this._separator.style.display=n&&i?"":"none"}},_onLayerChange:function(e){var t=this._layers[a.stamp(e.layer)];if(t){this._handlingClick||this._update();var i=t.overlay?"layeradd"===e.type?"overlayadd":"overlayremove":"layeradd"===e.type?"baselayerchange":null;i&&this._map.fire(i,t)}},_createRadioElement:function(e,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"';i&&(n+=' checked="checked"'),n+="/>";var a=t.createElement("div");return a.innerHTML=n,a.firstChild},_addItem:function(e){var i,n=t.createElement("label"),o=this._map.hasLayer(e.layer);e.overlay?(i=t.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=o):i=this._createRadioElement("leaflet-base-layers",o),i.layerId=a.stamp(e.layer),a.DomEvent.on(i,"click",this._onInputClick,this);var r=t.createElement("span");r.innerHTML=" "+e.name,n.appendChild(i),n.appendChild(r);var s=e.overlay?this._overlaysList:this._baseLayersList;return s.appendChild(n),n},_onInputClick:function(){var e,t,i,n=this._form.getElementsByTagName("input"),a=n.length;for(this._handlingClick=!0,e=0;a>e;e++)t=n[e],i=this._layers[t.layerId],t.checked&&!this._map.hasLayer(i.layer)?this._map.addLayer(i.layer):!t.checked&&this._map.hasLayer(i.layer)&&this._map.removeLayer(i.layer);this._handlingClick=!1},_expand:function(){a.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),a.control.layers=function(e,t,i){return new a.Control.Layers(e,t,i)},a.PosAnimation=a.Class.extend({includes:a.Mixin.Events,run:function(e,t,i,n){this.stop(),this._el=e,this._inProgress=!0,this._newPos=t,this.fire("start"),e.style[a.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",a.DomEvent.on(e,a.DomUtil.TRANSITION_END,this._onTransitionEnd,this),a.DomUtil.setPosition(e,t),a.Util.falseFn(e.offsetWidth),this._stepTimer=setInterval(a.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(a.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),a.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var e=this._getPos();return e?(this._el._leaflet_pos=e,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,i,n,o=this._el,r=e.getComputedStyle(o);if(a.Browser.any3d){if(n=r[a.DomUtil.TRANSFORM].match(this._transformRe),!n)return;t=parseFloat(n[1]),i=parseFloat(n[2])}else t=parseFloat(r.left),i=parseFloat(r.top);return new a.Point(t,i,!0)},_onTransitionEnd:function(){a.DomEvent.off(this._el,a.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[a.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),a.Map.include({setView:function(e,t,n){if(t=this._limitZoom(t),e=a.latLng(e),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=a.extend({animate:n.animate},n.zoom),n.pan=a.extend({animate:n.animate},n.pan));var o=this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,n.zoom):this._tryAnimatedPan(e,n.pan);if(o)return clearTimeout(this._sizeTimer),this}return this._resetView(e,t),this},panBy:function(e,t){if(e=a.point(e).round(),t=t||{},!e.x&&!e.y)return this;if(this._panAnim||(this._panAnim=new a.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),t.animate!==!1){a.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(e);this._panAnim.run(this._mapPane,i,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){a.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var i=this._getCenterOffset(e)._floor();return(t&&t.animate)===!0||this.getSize().contains(i)?(this.panBy(i,t),!0):!1}}),a.PosAnimation=a.DomUtil.TRANSITION?a.PosAnimation:a.PosAnimation.extend({run:function(e,t,i,n){this.stop(),this._el=e,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=a.DomUtil.getPosition(e),this._offset=t.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=a.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var e=+new Date-this._startTime,t=1e3*this._duration;t>e?this._runFrame(this._easeOut(e/t)):(this._runFrame(1),this._complete())},_runFrame:function(e){var t=this._startPos.add(this._offset.multiplyBy(e));a.DomUtil.setPosition(this._el,t),this.fire("step")},_complete:function(){a.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),a.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),a.DomUtil.TRANSITION&&a.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&a.DomUtil.TRANSITION&&a.Browser.any3d&&!a.Browser.android23&&!a.Browser.mobileOpera,this._zoomAnimated&&a.DomEvent.on(this._mapPane,a.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),a.Map.include(a.DomUtil.TRANSITION?{_catchTransitionEnd:function(){this._animatingZoom&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(t),a=this._getCenterOffset(e)._divideBy(1-1/n),o=this._getCenterLayerPoint()._add(a);return i.animate===!0||this.getSize().contains(a)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(e,t,o,n,null,!0),!0):!1},_animateZoom:function(e,t,i,n,o,r){this._animatingZoom=!0,a.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=e,this._animateToZoom=t,a.Draggable&&(a.Draggable._disabled=!0),this.fire("zoomanim",{center:e,zoom:t,origin:i,scale:n,delta:o,backwards:r})},_onZoomTransitionEnd:function(){this._animatingZoom=!1,a.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),a.Draggable&&(a.Draggable._disabled=!1)}}:{}),a.TileLayer.include({_animateZoom:function(e){this._animating||(this._animating=!0,this._prepareBgBuffer());var t=this._bgBuffer,i=a.DomUtil.TRANSFORM,n=e.delta?a.DomUtil.getTranslateString(e.delta):t.style[i],o=a.DomUtil.getScaleString(e.scale,e.origin);t.style[i]=e.backwards?o+" "+n:n+" "+o},_endZoomAnim:function(){var e=this._tileContainer,t=this._bgBuffer;e.style.visibility="",e.parentNode.appendChild(e),a.Util.falseFn(t.offsetWidth),this._animating=!1},_clearBgBuffer:function(){var e=this._map;!e||e._animatingZoom||e.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[a.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var e=this._tileContainer,t=this._bgBuffer,i=this._getLoadedTilesPercentage(t),n=this._getLoadedTilesPercentage(e);return t&&i>.5&&.5>n?(e.style.visibility="hidden",void this._stopLoadingImages(e)):(t.style.visibility="hidden",t.style[a.DomUtil.TRANSFORM]="",this._tileContainer=t,t=this._bgBuffer=e,this._stopLoadingImages(t),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(e){var t,i,n=e.getElementsByTagName("img"),a=0;for(t=0,i=n.length;i>t;t++)n[t].complete&&a++;return a/i},_stopLoadingImages:function(e){var t,i,n,o=Array.prototype.slice.call(e.getElementsByTagName("img"));for(t=0,i=o.length;i>t;t++)n=o[t],n.complete||(n.onload=a.Util.falseFn,n.onerror=a.Util.falseFn,n.src=a.Util.emptyImageUrl,n.parentNode.removeChild(n))}}),a.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(e){if(e=this._locateOptions=a.extend(this._defaultLocateOptions,e),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=a.bind(this._handleGeolocationResponse,this),i=a.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,i,e):navigator.geolocation.getCurrentPosition(t,i,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){var t=e.code,i=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(e){var t=e.coords.latitude,i=e.coords.longitude,n=new a.LatLng(t,i),o=180*e.coords.accuracy/40075017,r=o/Math.cos(a.LatLng.DEG_TO_RAD*t),s=a.latLngBounds([t-o,i-r],[t+o,i+r]),l=this._locateOptions;if(l.setView){var c=Math.min(this.getBoundsZoom(s),l.maxZoom);this.setView(n,c)}var u={latlng:n,bounds:s};for(var h in e.coords)"number"==typeof e.coords[h]&&(u[h]=e.coords[h]);this.fire("locationfound",u)}})}(window,document),function(e,t){function i(e){var t=e.length,i=le.type(e);return le.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function n(e){var t=xe[e]={};return le.each(e.match(ue)||[],function(e,i){t[i]=!0}),t}function a(e,i,n,a){if(le.acceptData(e)){var o,r,s=le.expando,l="string"==typeof i,c=e.nodeType,u=c?le.cache:e,h=c?e[s]:e[s]&&s;if(h&&u[h]&&(a||u[h].data)||!l||n!==t)return h||(c?e[s]=h=Q.pop()||le.guid++:h=s),u[h]||(u[h]={},c||(u[h].toJSON=le.noop)),("object"==typeof i||"function"==typeof i)&&(a?u[h]=le.extend(u[h],i):u[h].data=le.extend(u[h].data,i)),o=u[h],a||(o.data||(o.data={}),o=o.data),n!==t&&(o[le.camelCase(i)]=n),l?(r=o[i],null==r&&(r=o[le.camelCase(i)])):r=o,r}}function o(e,t,i){if(le.acceptData(e)){var n,a,o,r=e.nodeType,l=r?le.cache:e,c=r?e[le.expando]:le.expando;if(l[c]){if(t&&(o=i?l[c]:l[c].data)){le.isArray(t)?t=t.concat(le.map(t,le.camelCase)):t in o?t=[t]:(t=le.camelCase(t),t=t in o?[t]:t.split(" "));for(n=0,a=t.length;a>n;n++)delete o[t[n]];if(!(i?s:le.isEmptyObject)(o))return}(i||(delete l[c].data,s(l[c])))&&(r?le.cleanData([e],!0):le.support.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}}function r(e,i,n){if(n===t&&1===e.nodeType){var a="data-"+i.replace(Se,"-$1").toLowerCase();if(n=e.getAttribute(a),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Te.test(n)?le.parseJSON(n):n}catch(o){}le.data(e,i,n)}else n=t}return n}function s(e){var t;for(t in e)if(("data"!==t||!le.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function c(){return!1}function u(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function h(e,t,i){if(t=t||0,le.isFunction(t))return le.grep(e,function(e,n){var a=!!t.call(e,n,e);return a===i});if(t.nodeType)return le.grep(e,function(e){return e===t===i});if("string"==typeof t){var n=le.grep(e,function(e){return 1===e.nodeType});if(Ve.test(t))return le.filter(t,n,!i);t=le.filter(t,n)}return le.grep(e,function(e){return le.inArray(e,t)>=0===i})}function d(e){var t=We.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function p(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function f(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function m(e){var t=at.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function v(e,t){for(var i,n=0;null!=(i=e[n]);n++)le._data(i,"globalEval",!t||le._data(t[n],"globalEval"))}function g(e,t){if(1===t.nodeType&&le.hasData(e)){var i,n,a,o=le._data(e),r=le._data(t,o),s=o.events;if(s){delete r.handle,r.events={};for(i in s)for(n=0,a=s[i].length;a>n;n++)le.event.add(t,i,s[i][n])}r.data&&(r.data=le.extend({},r.data))}}function y(e,t){var i,n,a;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!le.support.noCloneEvent&&t[le.expando]){a=le._data(t);for(n in a.events)le.removeEvent(t,n,a.handle);t.removeAttribute(le.expando)}"script"===i&&t.text!==e.text?(f(t).text=e.text,m(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),le.support.html5Clone&&e.innerHTML&&!le.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&tt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}}function b(e,i){var n,a,o=0,r=typeof e.getElementsByTagName!==Z?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==Z?e.querySelectorAll(i||"*"):t;if(!r)for(r=[],n=e.childNodes||e;null!=(a=n[o]);o++)!i||le.nodeName(a,i)?r.push(a):le.merge(r,b(a,i));return i===t||i&&le.nodeName(e,i)?le.merge([e],r):r}function w(e){tt.test(e.type)&&(e.defaultChecked=e.checked)}function _(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,a=Tt.length;a--;)if(t=Tt[a]+i,t in e)return t;return n}function k(e,t){return e=t||e,"none"===le.css(e,"display")||!le.contains(e.ownerDocument,e)}function x(e,t){for(var i,n,a,o=[],r=0,s=e.length;s>r;r++)n=e[r],n.style&&(o[r]=le._data(n,"olddisplay"),i=n.style.display,t?(o[r]||"none"!==i||(n.style.display=""),""===n.style.display&&k(n)&&(o[r]=le._data(n,"olddisplay",C(n.nodeName)))):o[r]||(a=k(n),(i&&"none"!==i||!a)&&le._data(n,"olddisplay",a?i:le.css(n,"display"))));for(r=0;s>r;r++)n=e[r],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[r]||"":"none"));return e}function T(e,t,i){var n=gt.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function S(e,t,i,n,a){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,r=0;4>o;o+=2)"margin"===i&&(r+=le.css(e,i+xt[o],!0,a)),n?("content"===i&&(r-=le.css(e,"padding"+xt[o],!0,a)),"margin"!==i&&(r-=le.css(e,"border"+xt[o]+"Width",!0,a))):(r+=le.css(e,"padding"+xt[o],!0,a),"padding"!==i&&(r+=le.css(e,"border"+xt[o]+"Width",!0,a)));return r}function E(e,t,i){var n=!0,a="width"===t?e.offsetWidth:e.offsetHeight,o=ut(e),r=le.support.boxSizing&&"border-box"===le.css(e,"boxSizing",!1,o);if(0>=a||null==a){if(a=ht(e,t,o),(0>a||null==a)&&(a=e.style[t]),yt.test(a))return a;n=r&&(le.support.boxSizingReliable||a===e.style[t]),a=parseFloat(a)||0}return a+S(e,t,i||(r?"border":"content"),n,o)+"px"}function C(e){var t=Y,i=wt[e];return i||(i=M(e,t),"none"!==i&&i||(ct=(ct||le("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(ct[0].contentWindow||ct[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=M(e,t),ct.detach()),wt[e]=i),i}function M(e,t){var i=le(t.createElement(e)).appendTo(t.body),n=le.css(i[0],"display");return i.remove(),n}function L(e,t,i,n){var a;if(le.isArray(t))le.each(t,function(t,a){i||Et.test(e)?n(e,a):L(e+"["+("object"==typeof a?t:"")+"]",a,i,n)});else if(i||"object"!==le.type(t))n(e,t);else for(a in t)L(e+"["+a+"]",t[a],i,n)}function P(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,a=0,o=t.toLowerCase().match(ue)||[];if(le.isFunction(i))for(;n=o[a++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function D(e,t,i,n){function a(s){var l;return o[s]=!0,le.each(e[s]||[],function(e,s){var c=s(t,i,n);return"string"!=typeof c||r||o[c]?r?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)}),l}var o={},r=e===Vt;return a(t.dataTypes[0])||!o["*"]&&a("*")}function A(e,i){var n,a,o=le.ajaxSettings.flatOptions||{};for(a in i)i[a]!==t&&((o[a]?e:n||(n={}))[a]=i[a]);return n&&le.extend(!0,e,n),e}function $(e,i,n){var a,o,r,s,l=e.contents,c=e.dataTypes,u=e.responseFields;for(s in u)s in n&&(i[u[s]]=n[s]);for(;"*"===c[0];)c.shift(),o===t&&(o=e.mimeType||i.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){c.unshift(s);break}if(c[0]in n)r=c[0];else{for(s in n){if(!c[0]||e.converters[s+" "+c[0]]){r=s;break}a||(a=s)}r=r||a}return r?(r!==c[0]&&c.unshift(r),n[r]):void 0}function N(e,t){var i,n,a,o,r={},s=0,l=e.dataTypes.slice(),c=l[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l[1])for(a in e.converters)r[a.toLowerCase()]=e.converters[a];for(;n=l[++s];)if("*"!==n){if("*"!==c&&c!==n){if(a=r[c+" "+n]||r["* "+n],!a)for(i in r)if(o=i.split(" "),o[1]===n&&(a=r[c+" "+o[0]]||r["* "+o[0]])){a===!0?a=r[i]:r[i]!==!0&&(n=o[0],l.splice(s--,0,n));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+c+" to "+n}}}c=n}return{state:"success",data:t}}function I(){try{return new e.XMLHttpRequest}catch(t){}}function O(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function z(){return setTimeout(function(){Jt=t}),Jt=le.now()}function B(e,t){le.each(t,function(t,i){for(var n=(ai[t]||[]).concat(ai["*"]),a=0,o=n.length;o>a;a++)if(n[a].call(e,t,i))return})}function j(e,t,i){
var n,a,o=0,r=ni.length,s=le.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var t=Jt||z(),i=Math.max(0,c.startTime+c.duration-t),n=i/c.duration||0,o=1-n,r=0,l=c.tweens.length;l>r;r++)c.tweens[r].run(o);return s.notifyWith(e,[c,o,i]),1>o&&l?i:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:le.extend({},t),opts:le.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Jt||z(),duration:i.duration,tweens:[],createTween:function(t,i){var n=le.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(a)return this;for(a=!0;n>i;i++)c.tweens[i].run(1);return t?s.resolveWith(e,[c,t]):s.rejectWith(e,[c,t]),this}}),u=c.props;for(R(u,c.opts.specialEasing);r>o;o++)if(n=ni[o].call(c,e,u,c.opts))return n;return B(c,u),le.isFunction(c.opts.start)&&c.opts.start.call(e,c),le.fx.timer(le.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function R(e,t){var i,n,a,o,r;for(a in e)if(n=le.camelCase(a),o=t[n],i=e[a],le.isArray(i)&&(o=i[1],i=e[a]=i[0]),a!==n&&(e[n]=i,delete e[a]),r=le.cssHooks[n],r&&"expand"in r){i=r.expand(i),delete e[n];for(a in i)a in e||(e[a]=i[a],t[a]=o)}else t[n]=o}function F(e,t,i){var n,a,o,r,s,l,c,u,h,d=this,p=e.style,f={},m=[],v=e.nodeType&&k(e);i.queue||(u=le._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,h=u.empty.fire,u.empty.fire=function(){u.unqueued||h()}),u.unqueued++,d.always(function(){d.always(function(){u.unqueued--,le.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===le.css(e,"display")&&"none"===le.css(e,"float")&&(le.support.inlineBlockNeedsLayout&&"inline"!==C(e.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",le.support.shrinkWrapBlocks||d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(a in t)if(r=t[a],ei.exec(r)){if(delete t[a],l=l||"toggle"===r,r===(v?"hide":"show"))continue;m.push(a)}if(o=m.length){s=le._data(e,"fxshow")||le._data(e,"fxshow",{}),"hidden"in s&&(v=s.hidden),l&&(s.hidden=!v),v?le(e).show():d.done(function(){le(e).hide()}),d.done(function(){var t;le._removeData(e,"fxshow");for(t in f)le.style(e,t,f[t])});for(a=0;o>a;a++)n=m[a],c=d.createTween(n,v?s[n]:0),f[n]=s[n]||le.style(e,n),n in s||(s[n]=c.start,v&&(c.end=c.start,c.start="width"===n||"height"===n?1:0))}}function H(e,t,i,n,a){return new H.prototype.init(e,t,i,n,a)}function V(e,t){var i,n={height:e},a=0;for(t=t?1:0;4>a;a+=2-t)i=xt[a],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function U(e){return le.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var q,W,Z=typeof t,Y=e.document,X=e.location,G=e.jQuery,K=e.$,J={},Q=[],ee="1.9.1",te=Q.concat,ie=Q.push,ne=Q.slice,ae=Q.indexOf,oe=J.toString,re=J.hasOwnProperty,se=ee.trim,le=function(e,t){return new le.fn.init(e,t,W)},ce=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ue=/\S+/g,he=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,de=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,pe=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,fe=/^[\],:{}\s]*$/,me=/(?:^|:|,)(?:\s*\[)+/g,ve=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ge=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,ye=/^-ms-/,be=/-([\da-z])/gi,we=function(e,t){return t.toUpperCase()},_e=function(e){(Y.addEventListener||"load"===e.type||"complete"===Y.readyState)&&(ke(),le.ready())},ke=function(){Y.addEventListener?(Y.removeEventListener("DOMContentLoaded",_e,!1),e.removeEventListener("load",_e,!1)):(Y.detachEvent("onreadystatechange",_e),e.detachEvent("onload",_e))};le.fn=le.prototype={jquery:ee,constructor:le,init:function(e,i,n){var a,o;if(!e)return this;if("string"==typeof e){if(a="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:de.exec(e),!a||!a[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(a[1]){if(i=i instanceof le?i[0]:i,le.merge(this,le.parseHTML(a[1],i&&i.nodeType?i.ownerDocument||i:Y,!0)),pe.test(a[1])&&le.isPlainObject(i))for(a in i)le.isFunction(this[a])?this[a](i[a]):this.attr(a,i[a]);return this}if(o=Y.getElementById(a[2]),o&&o.parentNode){if(o.id!==a[2])return n.find(e);this.length=1,this[0]=o}return this.context=Y,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):le.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),le.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return ne.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=le.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return le.each(this,e,t)},ready:function(e){return le.ready.promise().done(e),this},slice:function(){return this.pushStack(ne.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(le.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:ie,sort:[].sort,splice:[].splice},le.fn.init.prototype=le.fn,le.extend=le.fn.extend=function(){var e,i,n,a,o,r,s=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},l=2),"object"==typeof s||le.isFunction(s)||(s={}),c===l&&(s=this,--l);c>l;l++)if(null!=(o=arguments[l]))for(a in o)e=s[a],n=o[a],s!==n&&(u&&n&&(le.isPlainObject(n)||(i=le.isArray(n)))?(i?(i=!1,r=e&&le.isArray(e)?e:[]):r=e&&le.isPlainObject(e)?e:{},s[a]=le.extend(u,r,n)):n!==t&&(s[a]=n));return s},le.extend({noConflict:function(t){return e.$===le&&(e.$=K),t&&e.jQuery===le&&(e.jQuery=G),le},isReady:!1,readyWait:1,holdReady:function(e){e?le.readyWait++:le.ready(!0)},ready:function(e){if(e===!0?!--le.readyWait:!le.isReady){if(!Y.body)return setTimeout(le.ready);le.isReady=!0,e!==!0&&--le.readyWait>0||(q.resolveWith(Y,[le]),le.fn.trigger&&le(Y).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===le.type(e)},isArray:Array.isArray||function(e){return"array"===le.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?J[oe.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==le.type(e)||e.nodeType||le.isWindow(e))return!1;try{if(e.constructor&&!re.call(e,"constructor")&&!re.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var n;for(n in e);return n===t||re.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||Y;var n=pe.exec(e),a=!i&&[];return n?[t.createElement(n[1])]:(n=le.buildFragment([e],t,a),a&&le(a).remove(),le.merge([],n.childNodes))},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):null===t?t:"string"==typeof t&&(t=le.trim(t),t&&fe.test(t.replace(ve,"@").replace(ge,"]").replace(me,"")))?new Function("return "+t)():void le.error("Invalid JSON: "+t)},parseXML:function(i){var n,a;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(a=new DOMParser,n=a.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(o){n=t}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||le.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(t){t&&le.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ye,"ms-").replace(be,we)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var a,o=0,r=e.length,s=i(e);if(n){if(s)for(;r>o&&(a=t.apply(e[o],n),a!==!1);o++);else for(o in e)if(a=t.apply(e[o],n),a===!1)break}else if(s)for(;r>o&&(a=t.call(e[o],o,e[o]),a!==!1);o++);else for(o in e)if(a=t.call(e[o],o,e[o]),a===!1)break;return e},trim:se&&!se.call("\ufeff ")?function(e){return null==e?"":se.call(e)}:function(e){return null==e?"":(e+"").replace(he,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?le.merge(n,"string"==typeof e?[e]:e):ie.call(n,e)),n},inArray:function(e,t,i){var n;if(t){if(ae)return ae.call(t,e,i);for(n=t.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var n=i.length,a=e.length,o=0;if("number"==typeof n)for(;n>o;o++)e[a++]=i[o];else for(;i[o]!==t;)e[a++]=i[o++];return e.length=a,e},grep:function(e,t,i){var n,a=[],o=0,r=e.length;for(i=!!i;r>o;o++)n=!!t(e[o],o),i!==n&&a.push(e[o]);return a},map:function(e,t,n){var a,o=0,r=e.length,s=i(e),l=[];if(s)for(;r>o;o++)a=t(e[o],o,n),null!=a&&(l[l.length]=a);else for(o in e)a=t(e[o],o,n),null!=a&&(l[l.length]=a);return te.apply([],l)},guid:1,proxy:function(e,i){var n,a,o;return"string"==typeof i&&(o=e[i],i=e,e=o),le.isFunction(e)?(n=ne.call(arguments,2),a=function(){return e.apply(i||this,n.concat(ne.call(arguments)))},a.guid=e.guid=e.guid||le.guid++,a):t},access:function(e,i,n,a,o,r,s){var l=0,c=e.length,u=null==n;if("object"===le.type(n)){o=!0;for(l in n)le.access(e,i,l,n[l],!0,r,s)}else if(a!==t&&(o=!0,le.isFunction(a)||(s=!0),u&&(s?(i.call(e,a),i=null):(u=i,i=function(e,t,i){return u.call(le(e),i)})),i))for(;c>l;l++)i(e[l],n,s?a:a.call(e[l],l,i(e[l],n)));return o?e:u?i.call(e):c?i(e[0],n):r},now:function(){return(new Date).getTime()}}),le.ready.promise=function(t){if(!q)if(q=le.Deferred(),"complete"===Y.readyState)setTimeout(le.ready);else if(Y.addEventListener)Y.addEventListener("DOMContentLoaded",_e,!1),e.addEventListener("load",_e,!1);else{Y.attachEvent("onreadystatechange",_e),e.attachEvent("onload",_e);var i=!1;try{i=null==e.frameElement&&Y.documentElement}catch(n){}i&&i.doScroll&&!function a(){if(!le.isReady){try{i.doScroll("left")}catch(e){return setTimeout(a,50)}ke(),le.ready()}}()}return q.promise(t)},le.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){J["[object "+t+"]"]=t.toLowerCase()}),W=le(Y);var xe={};le.Callbacks=function(e){e="string"==typeof e?xe[e]||n(e):le.extend({},e);var i,a,o,r,s,l,c=[],u=!e.once&&[],h=function(t){for(a=e.memory&&t,o=!0,s=l||0,l=0,r=c.length,i=!0;c&&r>s;s++)if(c[s].apply(t[0],t[1])===!1&&e.stopOnFalse){a=!1;break}i=!1,c&&(u?u.length&&h(u.shift()):a?c=[]:d.disable())},d={add:function(){if(c){var t=c.length;!function n(t){le.each(t,function(t,i){var a=le.type(i);"function"===a?e.unique&&d.has(i)||c.push(i):i&&i.length&&"string"!==a&&n(i)})}(arguments),i?r=c.length:a&&(l=t,h(a))}return this},remove:function(){return c&&le.each(arguments,function(e,t){for(var n;(n=le.inArray(t,c,n))>-1;)c.splice(n,1),i&&(r>=n&&r--,s>=n&&s--)}),this},has:function(e){return e?le.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],this},disable:function(){return c=u=a=t,this},disabled:function(){return!c},lock:function(){return u=t,a||d.disable(),this},locked:function(){return!u},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!c||o&&!u||(i?u.push(t):h(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!o}};return d},le.extend({Deferred:function(e){var t=[["resolve","done",le.Callbacks("once memory"),"resolved"],["reject","fail",le.Callbacks("once memory"),"rejected"],["notify","progress",le.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var e=arguments;return le.Deferred(function(i){le.each(t,function(t,o){var r=o[0],s=le.isFunction(e[t])&&e[t];a[o[1]](function(){var e=s&&s.apply(this,arguments);e&&le.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r+"With"](this===n?i.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?le.extend(e,n):n}},a={};return n.pipe=n.then,le.each(t,function(e,o){var r=o[2],s=o[3];n[o[1]]=r.add,s&&r.add(function(){i=s},t[1^e][2].disable,t[2][2].lock),a[o[0]]=function(){return a[o[0]+"With"](this===a?n:this,arguments),this},a[o[0]+"With"]=r.fireWith}),n.promise(a),e&&e.call(a,a),a},when:function(e){var t,i,n,a=0,o=ne.call(arguments),r=o.length,s=1!==r||e&&le.isFunction(e.promise)?r:0,l=1===s?e:le.Deferred(),c=function(e,i,n){return function(a){i[e]=this,n[e]=arguments.length>1?ne.call(arguments):a,n===t?l.notifyWith(i,n):--s||l.resolveWith(i,n)}};if(r>1)for(t=new Array(r),i=new Array(r),n=new Array(r);r>a;a++)o[a]&&le.isFunction(o[a].promise)?o[a].promise().done(c(a,n,o)).fail(l.reject).progress(c(a,i,t)):--s;return s||l.resolveWith(n,o),l.promise()}}),le.support=function(){var t,i,n,a,o,r,s,l,c,u,h=Y.createElement("div");if(h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=h.getElementsByTagName("*"),n=h.getElementsByTagName("a")[0],!i||!n||!i.length)return{};o=Y.createElement("select"),s=o.appendChild(Y.createElement("option")),a=h.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==h.className,leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:"/a"===n.getAttribute("href"),opacity:/^0.5/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:!!a.value,optSelected:s.selected,enctype:!!Y.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==Y.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===Y.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!s.disabled;try{delete h.test}catch(d){t.deleteExpando=!1}a=Y.createElement("input"),a.setAttribute("value",""),t.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","t"),a.setAttribute("name","t"),r=Y.createDocumentFragment(),r.appendChild(a),t.appendChecked=a.checked,t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,h.attachEvent&&(h.attachEvent("onclick",function(){t.noCloneEvent=!1}),h.cloneNode(!0).click());for(u in{submit:!0,change:!0,focusin:!0})h.setAttribute(l="on"+u,"t"),t[u+"Bubbles"]=l in e||h.attributes[l].expando===!1;return h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===h.style.backgroundClip,le(function(){var i,n,a,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",r=Y.getElementsByTagName("body")[0];r&&(i=Y.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",r.appendChild(i).appendChild(h),h.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=h.getElementsByTagName("td"),a[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===a[0].offsetHeight,a[0].style.display="",a[1].style.display="none",t.reliableHiddenOffsets=c&&0===a[0].offsetHeight,h.innerHTML="",h.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===h.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==r.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(h,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(h,null)||{width:"4px"}).width,n=h.appendChild(Y.createElement("div")),n.style.cssText=h.style.cssText=o,n.style.marginRight=n.style.width="0",h.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)),typeof h.style.zoom!==Z&&(h.innerHTML="",h.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===h.offsetWidth,h.style.display="block",h.innerHTML="<div></div>",h.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==h.offsetWidth,t.inlineBlockNeedsLayout&&(r.style.zoom=1)),r.removeChild(i),i=h=a=n=null)}),i=o=r=s=n=a=null,t}();var Te=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Se=/([A-Z])/g;le.extend({cache:{},expando:"jQuery"+(ee+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?le.cache[e[le.expando]]:e[le.expando],!!e&&!s(e)},data:function(e,t,i){return a(e,t,i)},removeData:function(e,t){return o(e,t)},_data:function(e,t,i){return a(e,t,i,!0)},_removeData:function(e,t){return o(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&le.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),le.fn.extend({data:function(e,i){var n,a,o=this[0],s=0,l=null;if(e===t){if(this.length&&(l=le.data(o),1===o.nodeType&&!le._data(o,"parsedAttrs"))){for(n=o.attributes;s<n.length;s++)a=n[s].name,a.indexOf("data-")||(a=le.camelCase(a.slice(5)),r(o,a,l[a]));le._data(o,"parsedAttrs",!0)}return l}return"object"==typeof e?this.each(function(){le.data(this,e)}):le.access(this,function(i){return i===t?o?r(o,e,le.data(o,e)):null:void this.each(function(){le.data(this,e,i)})},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){le.removeData(this,e)})}}),le.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=le._data(e,t),i&&(!n||le.isArray(i)?n=le._data(e,t,le.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=le.queue(e,t),n=i.length,a=i.shift(),o=le._queueHooks(e,t),r=function(){le.dequeue(e,t)};"inprogress"===a&&(a=i.shift(),n--),o.cur=a,a&&("fx"===t&&i.unshift("inprogress"),delete o.stop,a.call(e,r,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return le._data(e,i)||le._data(e,i,{empty:le.Callbacks("once memory").add(function(){le._removeData(e,t+"queue"),le._removeData(e,i)})})}}),le.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),arguments.length<n?le.queue(this[0],e):i===t?this:this.each(function(){var t=le.queue(this,e,i);le._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&le.dequeue(this,e)})},dequeue:function(e){return this.each(function(){le.dequeue(this,e)})},delay:function(e,t){return e=le.fx?le.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,a=1,o=le.Deferred(),r=this,s=this.length,l=function(){--a||o.resolveWith(r,[r])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";s--;)n=le._data(r[s],e+"queueHooks"),n&&n.empty&&(a++,n.empty.add(l));return l(),o.promise(i)}});var Ee,Ce,Me=/[\t\r\n]/g,Le=/\r/g,Pe=/^(?:input|select|textarea|button|object)$/i,De=/^(?:a|area)$/i,Ae=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,$e=/^(?:checked|selected)$/i,Ne=le.support.getSetAttribute,Ie=le.support.input;le.fn.extend({attr:function(e,t){return le.access(this,le.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){le.removeAttr(this,e)})},prop:function(e,t){return le.access(this,le.prop,e,t,arguments.length>1)},removeProp:function(e){return e=le.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,a,o,r=0,s=this.length,l="string"==typeof e&&e;if(le.isFunction(e))return this.each(function(t){le(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ue)||[];s>r;r++)if(i=this[r],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Me," "):" ")){for(o=0;a=t[o++];)n.indexOf(" "+a+" ")<0&&(n+=a+" ");i.className=le.trim(n)}return this},removeClass:function(e){var t,i,n,a,o,r=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(le.isFunction(e))return this.each(function(t){le(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ue)||[];s>r;r++)if(i=this[r],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Me," "):"")){for(o=0;a=t[o++];)for(;n.indexOf(" "+a+" ")>=0;)n=n.replace(" "+a+" "," ");i.className=e?le.trim(n):""}return this},toggleClass:function(e,t){var i=typeof e,n="boolean"==typeof t;return le.isFunction(e)?this.each(function(i){le(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var a,o=0,r=le(this),s=t,l=e.match(ue)||[];a=l[o++];)s=n?s:!r.hasClass(a),r[s?"addClass":"removeClass"](a);else(i===Z||"boolean"===i)&&(this.className&&le._data(this,"__className__",this.className),this.className=this.className||e===!1?"":le._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Me," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,n,a,o=this[0];{if(arguments.length)return a=le.isFunction(e),this.each(function(i){var o,r=le(this);1===this.nodeType&&(o=a?e.call(this,i,r.val()):e,null==o?o="":"number"==typeof o?o+="":le.isArray(o)&&(o=le.map(o,function(e){return null==e?"":e+""})),n=le.valHooks[this.type]||le.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==t||(this.value=o))});if(o)return n=le.valHooks[o.type]||le.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(o,"value"))!==t?i:(i=o.value,"string"==typeof i?i.replace(Le,""):null==i?"":i)}}}),le.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,n=e.options,a=e.selectedIndex,o="select-one"===e.type||0>a,r=o?null:[],s=o?a+1:n.length,l=0>a?s:o?a:0;s>l;l++)if(i=n[l],!(!i.selected&&l!==a||(le.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&le.nodeName(i.parentNode,"optgroup"))){if(t=le(i).val(),o)return t;r.push(t)}return r},set:function(e,t){var i=le.makeArray(t);return le(e).find("option").each(function(){this.selected=le.inArray(le(this).val(),i)>=0}),i.length||(e.selectedIndex=-1),i}}},attr:function(e,i,n){var a,o,r,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===Z?le.prop(e,i,n):(o=1!==s||!le.isXMLDoc(e),o&&(i=i.toLowerCase(),a=le.attrHooks[i]||(Ae.test(i)?Ce:Ee)),n===t?a&&o&&"get"in a&&null!==(r=a.get(e,i))?r:(typeof e.getAttribute!==Z&&(r=e.getAttribute(i)),null==r?t:r):null!==n?a&&o&&"set"in a&&(r=a.set(e,n,i))!==t?r:(e.setAttribute(i,n+""),n):void le.removeAttr(e,i))},removeAttr:function(e,t){var i,n,a=0,o=t&&t.match(ue);if(o&&1===e.nodeType)for(;i=o[a++];)n=le.propFix[i]||i,Ae.test(i)?!Ne&&$e.test(i)?e[le.camelCase("default-"+i)]=e[n]=!1:e[n]=!1:le.attr(e,i,""),e.removeAttribute(Ne?i:n)},attrHooks:{type:{set:function(e,t){if(!le.support.radioValue&&"radio"===t&&le.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,n){var a,o,r,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return r=1!==s||!le.isXMLDoc(e),r&&(i=le.propFix[i]||i,o=le.propHooks[i]),n!==t?o&&"set"in o&&(a=o.set(e,n,i))!==t?a:e[i]=n:o&&"get"in o&&null!==(a=o.get(e,i))?a:e[i]},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):Pe.test(e.nodeName)||De.test(e.nodeName)&&e.href?0:t}}}}),Ce={get:function(e,i){var n=le.prop(e,i),a="boolean"==typeof n&&e.getAttribute(i),o="boolean"==typeof n?Ie&&Ne?null!=a:$e.test(i)?e[le.camelCase("default-"+i)]:!!a:e.getAttributeNode(i);return o&&o.value!==!1?i.toLowerCase():t},set:function(e,t,i){return t===!1?le.removeAttr(e,i):Ie&&Ne||!$e.test(i)?e.setAttribute(!Ne&&le.propFix[i]||i,i):e[le.camelCase("default-"+i)]=e[i]=!0,i}},Ie&&Ne||(le.attrHooks.value={get:function(e,i){var n=e.getAttributeNode(i);return le.nodeName(e,"input")?e.defaultValue:n&&n.specified?n.value:t},set:function(e,t,i){return le.nodeName(e,"input")?void(e.defaultValue=t):Ee&&Ee.set(e,t,i)}}),Ne||(Ee=le.valHooks.button={get:function(e,i){var n=e.getAttributeNode(i);return n&&("id"===i||"name"===i||"coords"===i?""!==n.value:n.specified)?n.value:t},set:function(e,i,n){var a=e.getAttributeNode(n);return a||e.setAttributeNode(a=e.ownerDocument.createAttribute(n)),a.value=i+="","value"===n||i===e.getAttribute(n)?i:t}},le.attrHooks.contenteditable={get:Ee.get,set:function(e,t,i){Ee.set(e,""===t?!1:t,i)}},le.each(["width","height"],function(e,t){le.attrHooks[t]=le.extend(le.attrHooks[t],{set:function(e,i){return""===i?(e.setAttribute(t,"auto"),i):void 0}})})),le.support.hrefNormalized||(le.each(["href","src","width","height"],function(e,i){le.attrHooks[i]=le.extend(le.attrHooks[i],{get:function(e){var n=e.getAttribute(i,2);return null==n?t:n}})}),le.each(["href","src"],function(e,t){le.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),le.support.style||(le.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),le.support.optSelected||(le.propHooks.selected=le.extend(le.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),le.support.enctype||(le.propFix.enctype="encoding"),le.support.checkOn||le.each(["radio","checkbox"],function(){le.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),le.each(["radio","checkbox"],function(){le.valHooks[this]=le.extend(le.valHooks[this],{set:function(e,t){return le.isArray(t)?e.checked=le.inArray(le(e).val(),t)>=0:void 0}})});var Oe=/^(?:input|select|textarea)$/i,ze=/^key/,Be=/^(?:mouse|contextmenu)|click/,je=/^(?:focusinfocus|focusoutblur)$/,Re=/^([^.]*)(?:\.(.+)|)$/;le.event={global:{},add:function(e,i,n,a,o){var r,s,l,c,u,h,d,p,f,m,v,g=le._data(e);if(g){for(n.handler&&(c=n,n=c.handler,o=c.selector),n.guid||(n.guid=le.guid++),(s=g.events)||(s=g.events={}),(h=g.handle)||(h=g.handle=function(e){return typeof le===Z||e&&le.event.triggered===e.type?t:le.event.dispatch.apply(h.elem,arguments)},h.elem=e),i=(i||"").match(ue)||[""],l=i.length;l--;)r=Re.exec(i[l])||[],f=v=r[1],m=(r[2]||"").split(".").sort(),u=le.event.special[f]||{},f=(o?u.delegateType:u.bindType)||f,u=le.event.special[f]||{},d=le.extend({type:f,origType:v,data:a,handler:n,guid:n.guid,selector:o,needsContext:o&&le.expr.match.needsContext.test(o),namespace:m.join(".")},c),(p=s[f])||(p=s[f]=[],p.delegateCount=0,u.setup&&u.setup.call(e,a,m,h)!==!1||(e.addEventListener?e.addEventListener(f,h,!1):e.attachEvent&&e.attachEvent("on"+f,h))),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,d):p.push(d),le.event.global[f]=!0;e=null}},remove:function(e,t,i,n,a){var o,r,s,l,c,u,h,d,p,f,m,v=le.hasData(e)&&le._data(e);if(v&&(u=v.events)){for(t=(t||"").match(ue)||[""],c=t.length;c--;)if(s=Re.exec(t[c])||[],p=m=s[1],f=(s[2]||"").split(".").sort(),p){for(h=le.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,d=u[p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=d.length;o--;)r=d[o],!a&&m!==r.origType||i&&i.guid!==r.guid||s&&!s.test(r.namespace)||n&&n!==r.selector&&("**"!==n||!r.selector)||(d.splice(o,1),r.selector&&d.delegateCount--,h.remove&&h.remove.call(e,r));l&&!d.length&&(h.teardown&&h.teardown.call(e,f,v.handle)!==!1||le.removeEvent(e,p,v.handle),delete u[p])}else for(p in u)le.event.remove(e,p+t[c],i,n,!0);le.isEmptyObject(u)&&(delete v.handle,le._removeData(e,"events"))}},trigger:function(i,n,a,o){var r,s,l,c,u,h,d,p=[a||Y],f=re.call(i,"type")?i.type:i,m=re.call(i,"namespace")?i.namespace.split("."):[];if(l=h=a=a||Y,3!==a.nodeType&&8!==a.nodeType&&!je.test(f+le.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),s=f.indexOf(":")<0&&"on"+f,i=i[le.expando]?i:new le.Event(f,"object"==typeof i&&i),i.isTrigger=!0,i.namespace=m.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=a),n=null==n?[i]:le.makeArray(n,[i]),u=le.event.special[f]||{},o||!u.trigger||u.trigger.apply(a,n)!==!1)){if(!o&&!u.noBubble&&!le.isWindow(a)){for(c=u.delegateType||f,je.test(c+f)||(l=l.parentNode);l;l=l.parentNode)p.push(l),h=l;h===(a.ownerDocument||Y)&&p.push(h.defaultView||h.parentWindow||e)}for(d=0;(l=p[d++])&&!i.isPropagationStopped();)i.type=d>1?c:u.bindType||f,r=(le._data(l,"events")||{})[i.type]&&le._data(l,"handle"),r&&r.apply(l,n),r=s&&l[s],r&&le.acceptData(l)&&r.apply&&r.apply(l,n)===!1&&i.preventDefault();if(i.type=f,!(o||i.isDefaultPrevented()||u._default&&u._default.apply(a.ownerDocument,n)!==!1||"click"===f&&le.nodeName(a,"a")||!le.acceptData(a)||!s||!a[f]||le.isWindow(a))){h=a[s],h&&(a[s]=null),le.event.triggered=f;try{a[f]()}catch(v){}le.event.triggered=t,h&&(a[s]=h)}return i.result}},dispatch:function(e){e=le.event.fix(e);var i,n,a,o,r,s=[],l=ne.call(arguments),c=(le._data(this,"events")||{})[e.type]||[],u=le.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(s=le.event.handlers.call(this,e,c),i=0;(o=s[i++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,r=0;(a=o.handlers[r++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(a.namespace))&&(e.handleObj=a,e.data=a.data,n=((le.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,l),n!==t&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,i){var n,a,o,r,s=[],l=i.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==e.type)){for(o=[],r=0;l>r;r++)a=i[r],n=a.selector+" ",o[n]===t&&(o[n]=a.needsContext?le(n,this).index(c)>=0:le.find(n,this,null,[c]).length),o[n]&&o.push(a);o.length&&s.push({elem:c,handlers:o})}return l<i.length&&s.push({elem:this,handlers:i.slice(l)}),s},fix:function(e){if(e[le.expando])return e;var t,i,n,a=e.type,o=e,r=this.fixHooks[a];for(r||(this.fixHooks[a]=r=Be.test(a)?this.mouseHooks:ze.test(a)?this.keyHooks:{}),n=r.props?this.props.concat(r.props):this.props,e=new le.Event(o),t=n.length;t--;)i=n[t],e[i]=o[i];return e.target||(e.target=o.srcElement||Y),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,r.filter?r.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,a,o,r=i.button,s=i.fromElement;return null==e.pageX&&null!=i.clientX&&(a=e.target.ownerDocument||Y,o=a.documentElement,n=a.body,e.pageX=i.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||n&&n.clientLeft||0),e.pageY=i.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?i.toElement:s),e.which||r===t||(e.which=1&r?1:2&r?3:4&r?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return le.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),
!1):void 0}},focus:{trigger:function(){if(this!==Y.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===Y.activeElement&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var a=le.extend(new le.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?le.event.trigger(a,null,t):le.event.dispatch.call(t,a),a.isDefaultPrevented()&&i.preventDefault()}},le.removeEvent=Y.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===Z&&(e[n]=null),e.detachEvent(n,i))},le.Event=function(e,t){return this instanceof le.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:c):this.type=e,t&&le.extend(this,t),this.timeStamp=e&&e.timeStamp||le.now(),void(this[le.expando]=!0)):new le.Event(e,t)},le.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},le.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){le.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,a=e.relatedTarget,o=e.handleObj;return(!a||a!==n&&!le.contains(n,a))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),le.support.submitBubbles||(le.event.special.submit={setup:function(){return le.nodeName(this,"form")?!1:void le.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=le.nodeName(i,"input")||le.nodeName(i,"button")?i.form:t;n&&!le._data(n,"submitBubbles")&&(le.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),le._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&le.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return le.nodeName(this,"form")?!1:void le.event.remove(this,"._submit")}}),le.support.changeBubbles||(le.event.special.change={setup:function(){return Oe.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(le.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),le.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),le.event.simulate("change",this,e,!0)})),!1):void le.event.add(this,"beforeactivate._change",function(e){var t=e.target;Oe.test(t.nodeName)&&!le._data(t,"changeBubbles")&&(le.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||le.event.simulate("change",this.parentNode,e,!0)}),le._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return le.event.remove(this,"._change"),!Oe.test(this.nodeName)}}),le.support.focusinBubbles||le.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){le.event.simulate(t,e.target,le.event.fix(e),!0)};le.event.special[t]={setup:function(){0===i++&&Y.addEventListener(e,n,!0)},teardown:function(){0===--i&&Y.removeEventListener(e,n,!0)}}}),le.fn.extend({on:function(e,i,n,a,o){var r,s;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=t);for(r in e)this.on(r,i,n,e[r],o);return this}if(null==n&&null==a?(a=i,n=i=t):null==a&&("string"==typeof i?(a=n,n=t):(a=n,n=i,i=t)),a===!1)a=c;else if(!a)return this;return 1===o&&(s=a,a=function(e){return le().off(e),s.apply(this,arguments)},a.guid=s.guid||(s.guid=le.guid++)),this.each(function(){le.event.add(this,e,a,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var a,o;if(e&&e.preventDefault&&e.handleObj)return a=e.handleObj,le(e.delegateTarget).off(a.namespace?a.origType+"."+a.namespace:a.origType,a.selector,a.handler),this;if("object"==typeof e){for(o in e)this.off(o,i,e[o]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=t),n===!1&&(n=c),this.each(function(){le.event.remove(this,e,n,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){le.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?le.event.trigger(e,t,i,!0):void 0}}),function(e,t){function i(e){return fe.test(e+"")}function n(){var e,t=[];return e=function(i,n){return t.push(i+=" ")>T.cacheLength&&delete e[t.shift()],e[i]=n}}function a(e){return e[j]=!0,e}function o(e){var t=D.createElement("div");try{return e(t)}catch(i){return!1}finally{t=null}}function r(e,t,i,n){var a,o,r,s,l,c,u,p,f,m;if((t?t.ownerDocument||t:R)!==D&&P(t),t=t||D,i=i||[],!e||"string"!=typeof e)return i;if(1!==(s=t.nodeType)&&9!==s)return[];if(!$&&!n){if(a=me.exec(e))if(r=a[1]){if(9===s){if(o=t.getElementById(r),!o||!o.parentNode)return i;if(o.id===r)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(r))&&z(t,o)&&o.id===r)return i.push(o),i}else{if(a[2])return K.apply(i,J.call(t.getElementsByTagName(e),0)),i;if((r=a[3])&&F.getByClassName&&t.getElementsByClassName)return K.apply(i,J.call(t.getElementsByClassName(r),0)),i}if(F.qsa&&!N.test(e)){if(u=!0,p=j,f=t,m=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(c=h(e),(u=t.getAttribute("id"))?p=u.replace(ye,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=c.length;l--;)c[l]=p+d(c[l]);f=pe.test(e)&&t.parentNode||t,m=c.join(",")}if(m)try{return K.apply(i,J.call(f.querySelectorAll(m),0)),i}catch(v){}finally{u||t.removeAttribute("id")}}}return w(e.replace(re,"$1"),t,i,n)}function s(e,t){var i=t&&e,n=i&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function l(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function c(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function u(e){return a(function(t){return t=+t,a(function(i,n){for(var a,o=e([],i.length,t),r=o.length;r--;)i[a=o[r]]&&(i[a]=!(n[a]=i[a]))})})}function h(e,t){var i,n,a,o,s,l,c,u=q[e+" "];if(u)return t?0:u.slice(0);for(s=e,l=[],c=T.preFilter;s;){(!i||(n=se.exec(s)))&&(n&&(s=s.slice(n[0].length)||s),l.push(a=[])),i=!1,(n=ce.exec(s))&&(i=n.shift(),a.push({value:i,type:n[0].replace(re," ")}),s=s.slice(i.length));for(o in T.filter)!(n=de[o].exec(s))||c[o]&&!(n=c[o](n))||(i=n.shift(),a.push({value:i,type:o,matches:n}),s=s.slice(i.length));if(!i)break}return t?s.length:s?r.error(e):q(e,l).slice(0)}function d(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function p(e,t,i){var n=t.dir,a=i&&"parentNode"===n,o=V++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||a)return e(t,i,o)}:function(t,i,r){var s,l,c,u=H+" "+o;if(r){for(;t=t[n];)if((1===t.nodeType||a)&&e(t,i,r))return!0}else for(;t=t[n];)if(1===t.nodeType||a)if(c=t[j]||(t[j]={}),(l=c[n])&&l[0]===u){if((s=l[1])===!0||s===x)return s===!0}else if(l=c[n]=[u],l[1]=e(t,i,r)||x,l[1]===!0)return!0}}function f(e){return e.length>1?function(t,i,n){for(var a=e.length;a--;)if(!e[a](t,i,n))return!1;return!0}:e[0]}function m(e,t,i,n,a){for(var o,r=[],s=0,l=e.length,c=null!=t;l>s;s++)(o=e[s])&&(!i||i(o,n,a))&&(r.push(o),c&&t.push(s));return r}function v(e,t,i,n,o,r){return n&&!n[j]&&(n=v(n)),o&&!o[j]&&(o=v(o,r)),a(function(a,r,s,l){var c,u,h,d=[],p=[],f=r.length,v=a||b(t||"*",s.nodeType?[s]:s,[]),g=!e||!a&&t?v:m(v,d,e,s,l),y=i?o||(a?e:f||n)?[]:r:g;if(i&&i(g,y,s,l),n)for(c=m(y,p),n(c,[],s,l),u=c.length;u--;)(h=c[u])&&(y[p[u]]=!(g[p[u]]=h));if(a){if(o||e){if(o){for(c=[],u=y.length;u--;)(h=y[u])&&c.push(g[u]=h);o(null,y=[],c,l)}for(u=y.length;u--;)(h=y[u])&&(c=o?Q.call(a,h):d[u])>-1&&(a[c]=!(r[c]=h))}}else y=m(y===r?y.splice(f,y.length):y),o?o(null,r,y,l):K.apply(r,y)})}function g(e){for(var t,i,n,a=e.length,o=T.relative[e[0].type],r=o||T.relative[" "],s=o?1:0,l=p(function(e){return e===t},r,!0),c=p(function(e){return Q.call(t,e)>-1},r,!0),u=[function(e,i,n){return!o&&(n||i!==L)||((t=i).nodeType?l(e,i,n):c(e,i,n))}];a>s;s++)if(i=T.relative[e[s].type])u=[p(f(u),i)];else{if(i=T.filter[e[s].type].apply(null,e[s].matches),i[j]){for(n=++s;a>n&&!T.relative[e[n].type];n++);return v(s>1&&f(u),s>1&&d(e.slice(0,s-1)).replace(re,"$1"),i,n>s&&g(e.slice(s,n)),a>n&&g(e=e.slice(n)),a>n&&d(e))}u.push(i)}return f(u)}function y(e,t){var i=0,n=t.length>0,o=e.length>0,s=function(a,s,l,c,u){var h,d,p,f=[],v=0,g="0",y=a&&[],b=null!=u,w=L,_=a||o&&T.find.TAG("*",u&&s.parentNode||s),k=H+=null==w?1:Math.random()||.1;for(b&&(L=s!==D&&s,x=i);null!=(h=_[g]);g++){if(o&&h){for(d=0;p=e[d++];)if(p(h,s,l)){c.push(h);break}b&&(H=k,x=++i)}n&&((h=!p&&h)&&v--,a&&y.push(h))}if(v+=g,n&&g!==v){for(d=0;p=t[d++];)p(y,f,s,l);if(a){if(v>0)for(;g--;)y[g]||f[g]||(f[g]=G.call(c));f=m(f)}K.apply(c,f),b&&!a&&f.length>0&&v+t.length>1&&r.uniqueSort(c)}return b&&(H=k,L=w),y};return n?a(s):s}function b(e,t,i){for(var n=0,a=t.length;a>n;n++)r(e,t[n],i);return i}function w(e,t,i,n){var a,o,r,s,l,c=h(e);if(!n&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(r=o[0]).type&&9===t.nodeType&&!$&&T.relative[o[1].type]){if(t=T.find.ID(r.matches[0].replace(we,_e),t)[0],!t)return i;e=e.slice(o.shift().value.length)}for(a=de.needsContext.test(e)?0:o.length;a--&&(r=o[a],!T.relative[s=r.type]);)if((l=T.find[s])&&(n=l(r.matches[0].replace(we,_e),pe.test(o[0].type)&&t.parentNode||t))){if(o.splice(a,1),e=n.length&&d(o),!e)return K.apply(i,J.call(n,0)),i;break}}return C(e,c)(n,t,$,i,pe.test(e)),i}function _(){}var k,x,T,S,E,C,M,L,P,D,A,$,N,I,O,z,B,j="sizzle"+-new Date,R=e.document,F={},H=0,V=0,U=n(),q=n(),W=n(),Z=typeof t,Y=1<<31,X=[],G=X.pop,K=X.push,J=X.slice,Q=X.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ie=te.replace("w","w#"),ne="([*^$|!~]?=)",ae="\\["+ee+"*("+te+")"+ee+"*(?:"+ne+ee+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ie+")|)|)"+ee+"*\\]",oe=":("+te+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ae.replace(3,8)+")*)|.*)\\)|)",re=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),se=new RegExp("^"+ee+"*,"+ee+"*"),ce=new RegExp("^"+ee+"*([\\x20\\t\\r\\n\\f>+~])"+ee+"*"),ue=new RegExp(oe),he=new RegExp("^"+ie+"$"),de={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),NAME:new RegExp("^\\[name=['\"]?("+te+")['\"]?\\]"),TAG:new RegExp("^("+te.replace("w","w*")+")"),ATTR:new RegExp("^"+ae),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},pe=/[\x20\t\r\n\f]*[+~]/,fe=/^[^{]+\{\s*\[native code/,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ve=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,ye=/'|\\/g,be=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,we=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,_e=function(e,t){var i="0x"+t-65536;return i!==i?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{J.call(R.documentElement.childNodes,0)[0].nodeType}catch(ke){J=function(e){for(var t,i=[];t=this[e++];)i.push(t);return i}}E=r.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},P=r.setDocument=function(e){var n=e?e.ownerDocument||e:R;return n!==D&&9===n.nodeType&&n.documentElement?(D=n,A=n.documentElement,$=E(n),F.tagNameNoComments=o(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),F.attributes=o(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),F.getByClassName=o(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),F.getByName=o(function(e){e.id=j+0,e.innerHTML="<a name='"+j+"'></a><div name='"+j+"'></div>",A.insertBefore(e,A.firstChild);var t=n.getElementsByName&&n.getElementsByName(j).length===2+n.getElementsByName(j+0).length;return F.getIdNotName=!n.getElementById(j),A.removeChild(e),t}),T.attrHandle=o(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==Z&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},F.getIdNotName?(T.find.ID=function(e,t){if(typeof t.getElementById!==Z&&!$){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},T.filter.ID=function(e){var t=e.replace(we,_e);return function(e){return e.getAttribute("id")===t}}):(T.find.ID=function(e,i){if(typeof i.getElementById!==Z&&!$){var n=i.getElementById(e);return n?n.id===e||typeof n.getAttributeNode!==Z&&n.getAttributeNode("id").value===e?[n]:t:[]}},T.filter.ID=function(e){var t=e.replace(we,_e);return function(e){var i=typeof e.getAttributeNode!==Z&&e.getAttributeNode("id");return i&&i.value===t}}),T.find.TAG=F.tagNameNoComments?function(e,t){return typeof t.getElementsByTagName!==Z?t.getElementsByTagName(e):void 0}:function(e,t){var i,n=[],a=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[a++];)1===i.nodeType&&n.push(i);return n}return o},T.find.NAME=F.getByName&&function(e,t){return typeof t.getElementsByName!==Z?t.getElementsByName(name):void 0},T.find.CLASS=F.getByClassName&&function(e,t){return typeof t.getElementsByClassName===Z||$?void 0:t.getElementsByClassName(e)},I=[],N=[":focus"],(F.qsa=i(n.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||N.push("\\["+ee+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||N.push(":checked")}),o(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&N.push("[*^$]="+ee+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")})),(F.matchesSelector=i(O=A.matchesSelector||A.mozMatchesSelector||A.webkitMatchesSelector||A.oMatchesSelector||A.msMatchesSelector))&&o(function(e){F.disconnectedMatch=O.call(e,"div"),O.call(e,"[s!='']:x"),I.push("!=",oe)}),N=new RegExp(N.join("|")),I=new RegExp(I.join("|")),z=i(A.contains)||A.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},B=A.compareDocumentPosition?function(e,t){var i;return e===t?(M=!0,0):(i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&i||e.parentNode&&11===e.parentNode.nodeType?e===n||z(R,e)?-1:t===n||z(R,t)?1:0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var i,a=0,o=e.parentNode,r=t.parentNode,l=[e],c=[t];if(e===t)return M=!0,0;if(!o||!r)return e===n?-1:t===n?1:o?-1:r?1:0;if(o===r)return s(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)c.unshift(i);for(;l[a]===c[a];)a++;return a?s(l[a],c[a]):l[a]===R?-1:c[a]===R?1:0},M=!1,[0,0].sort(B),F.detectDuplicates=M,D):D},r.matches=function(e,t){return r(e,null,null,t)},r.matchesSelector=function(e,t){if((e.ownerDocument||e)!==D&&P(e),t=t.replace(be,"='$1']"),!(!F.matchesSelector||$||I&&I.test(t)||N.test(t)))try{var i=O.call(e,t);if(i||F.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(n){}return r(t,D,null,[e]).length>0},r.contains=function(e,t){return(e.ownerDocument||e)!==D&&P(e),z(e,t)},r.attr=function(e,t){var i;return(e.ownerDocument||e)!==D&&P(e),$||(t=t.toLowerCase()),(i=T.attrHandle[t])?i(e):$||F.attributes?e.getAttribute(t):((i=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:i&&i.specified?i.value:null},r.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},r.uniqueSort=function(e){var t,i=[],n=1,a=0;if(M=!F.detectDuplicates,e.sort(B),M){for(;t=e[n];n++)t===e[n-1]&&(a=i.push(n));for(;a--;)e.splice(i[a],1)}return e},S=r.getText=function(e){var t,i="",n=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=S(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[n];n++)i+=S(t);return i},T=r.selectors={cacheLength:50,createPseudo:a,match:de,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(we,_e),e[3]=(e[4]||e[5]||"").replace(we,_e),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||r.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&r.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return de.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:i&&ue.test(i)&&(t=h(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(we,_e).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=U[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&U(e,function(e){return t.test(e.className||typeof e.getAttribute!==Z&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(n){var a=r.attr(n,e);return null==a?"!="===t:t?(a+="","="===t?a===i:"!="===t?a!==i:"^="===t?i&&0===a.indexOf(i):"*="===t?i&&a.indexOf(i)>-1:"$="===t?i&&a.slice(-i.length)===i:"~="===t?(" "+a+" ").indexOf(i)>-1:"|="===t?a===i||a.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,i,n,a){var o="nth"!==e.slice(0,3),r="last"!==e.slice(-4),s="of-type"===t;return 1===n&&0===a?function(e){return!!e.parentNode}:function(t,i,l){var c,u,h,d,p,f,m=o!==r?"nextSibling":"previousSibling",v=t.parentNode,g=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(v){if(o){for(;m;){for(h=t;h=h[m];)if(s?h.nodeName.toLowerCase()===g:1===h.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[r?v.firstChild:v.lastChild],r&&y){for(u=v[j]||(v[j]={}),c=u[e]||[],p=c[0]===H&&c[1],d=c[0]===H&&c[2],h=p&&v.childNodes[p];h=++p&&h&&h[m]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===t){u[e]=[H,p,d];break}}else if(y&&(c=(t[j]||(t[j]={}))[e])&&c[0]===H)d=c[1];else for(;(h=++p&&h&&h[m]||(d=p=0)||f.pop())&&((s?h.nodeName.toLowerCase()!==g:1!==h.nodeType)||!++d||(y&&((h[j]||(h[j]={}))[e]=[H,d]),h!==t)););return d-=a,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(e,t){var i,n=T.pseudos[e]||T.setFilters[e.toLowerCase()]||r.error("unsupported pseudo: "+e);return n[j]?n(t):n.length>1?(i=[e,e,"",t],T.setFilters.hasOwnProperty(e.toLowerCase())?a(function(e,i){for(var a,o=n(e,t),r=o.length;r--;)a=Q.call(e,o[r]),e[a]=!(i[a]=o[r])}):function(e){return n(e,0,i)}):n}},pseudos:{not:a(function(e){var t=[],i=[],n=C(e.replace(re,"$1"));return n[j]?a(function(e,t,i,a){for(var o,r=n(e,null,a,[]),s=e.length;s--;)(o=r[s])&&(e[s]=!(t[s]=o))}):function(e,a,o){return t[0]=e,n(t,null,o,i),!i.pop()}}),has:a(function(e){return function(t){return r(e,t).length>0}}),contains:a(function(e){return function(t){return(t.textContent||t.innerText||S(t)).indexOf(e)>-1}}),lang:a(function(e){return he.test(e||"")||r.error("unsupported lang: "+e),e=e.replace(we,_e).toLowerCase(),function(t){var i;do if(i=$?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===A},focus:function(e){return e===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!T.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return ve.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]}),eq:u(function(e,t,i){return[0>i?i+t:i]}),even:u(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:u(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:u(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:u(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}};for(k in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})T.pseudos[k]=l(k);for(k in{submit:!0,reset:!0})T.pseudos[k]=c(k);C=r.compile=function(e,t){var i,n=[],a=[],o=W[e+" "];if(!o){for(t||(t=h(e)),i=t.length;i--;)o=g(t[i]),o[j]?n.push(o):a.push(o);o=W(e,y(a,n))}return o},T.pseudos.nth=T.pseudos.eq,T.filters=_.prototype=T.pseudos,T.setFilters=new _,P(),r.attr=le.attr,le.find=r,le.expr=r.selectors,le.expr[":"]=le.expr.pseudos,le.unique=r.uniqueSort,le.text=r.getText,le.isXMLDoc=r.isXML,le.contains=r.contains}(e);var Fe=/Until$/,He=/^(?:parents|prev(?:Until|All))/,Ve=/^.[^:#\[\.,]*$/,Ue=le.expr.match.needsContext,qe={children:!0,contents:!0,next:!0,prev:!0};le.fn.extend({find:function(e){var t,i,n,a=this.length;if("string"!=typeof e)return n=this,this.pushStack(le(e).filter(function(){for(t=0;a>t;t++)if(le.contains(n[t],this))return!0}));for(i=[],t=0;a>t;t++)le.find(e,this[t],i);return i=this.pushStack(a>1?le.unique(i):i),i.selector=(this.selector?this.selector+" ":"")+e,i},has:function(e){var t,i=le(e,this),n=i.length;return this.filter(function(){for(t=0;n>t;t++)if(le.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(h(this,e,!1))},filter:function(e){return this.pushStack(h(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?Ue.test(e)?le(e,this.context).index(this[0])>=0:le.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var i,n=0,a=this.length,o=[],r=Ue.test(e)||"string"!=typeof e?le(e,t||this.context):0;a>n;n++)for(i=this[n];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(r?r.index(i)>-1:le.find.matchesSelector(i,e)){o.push(i);break}i=i.parentNode}return this.pushStack(o.length>1?le.unique(o):o)},index:function(e){return e?"string"==typeof e?le.inArray(this[0],le(e)):le.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?le(e,t):le.makeArray(e&&e.nodeType?[e]:e),n=le.merge(this.get(),i);return this.pushStack(le.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),le.fn.andSelf=le.fn.addBack,le.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return le.dir(e,"parentNode")},parentsUntil:function(e,t,i){return le.dir(e,"parentNode",i)},next:function(e){return u(e,"nextSibling")},prev:function(e){return u(e,"previousSibling")},nextAll:function(e){return le.dir(e,"nextSibling")},prevAll:function(e){return le.dir(e,"previousSibling")},nextUntil:function(e,t,i){return le.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return le.dir(e,"previousSibling",i)},siblings:function(e){return le.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return le.sibling(e.firstChild)},contents:function(e){return le.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:le.merge([],e.childNodes)}},function(e,t){le.fn[e]=function(i,n){var a=le.map(this,t,i);return Fe.test(e)||(n=i),n&&"string"==typeof n&&(a=le.filter(n,a)),a=this.length>1&&!qe[e]?le.unique(a):a,this.length>1&&He.test(e)&&(a=a.reverse()),this.pushStack(a)}}),le.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?le.find.matchesSelector(t[0],e)?[t[0]]:[]:le.find.matches(e,t)},dir:function(e,i,n){for(var a=[],o=e[i];o&&9!==o.nodeType&&(n===t||1!==o.nodeType||!le(o).is(n));)1===o.nodeType&&a.push(o),o=o[i];return a},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var We="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ze=/ jQuery\d+="(?:null|\d+)"/g,Ye=new RegExp("<(?:"+We+")[\\s/>]","i"),Xe=/^\s+/,Ge=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ke=/<([\w:]+)/,Je=/<tbody/i,Qe=/<|&#?\w+;/,et=/<(?:script|style|link)/i,tt=/^(?:checkbox|radio)$/i,it=/checked\s*(?:[^=]|=\s*.checked.)/i,nt=/^$|\/(?:java|ecma)script/i,at=/^true\/(.*)/,ot=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:le.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},st=d(Y),lt=st.appendChild(Y.createElement("div"));rt.optgroup=rt.option,rt.tbody=rt.tfoot=rt.colgroup=rt.caption=rt.thead,rt.th=rt.td,le.fn.extend({text:function(e){return le.access(this,function(e){return e===t?le.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Y).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(le.isFunction(e))return this.each(function(t){le(this).wrapAll(e.call(this,t))});if(this[0]){var t=le(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return le.isFunction(e)?this.each(function(t){le(this).wrapInner(e.call(this,t))}):this.each(function(){var t=le(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=le.isFunction(e);return this.each(function(i){le(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){le.nodeName(this,"body")||le(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=0;null!=(i=this[n]);n++)(!e||le.filter(e,[i]).length>0)&&(t||1!==i.nodeType||le.cleanData(b(i)),i.parentNode&&(t&&le.contains(i.ownerDocument,i)&&v(b(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&le.cleanData(b(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&le.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return le.clone(this,e,t)})},html:function(e){return le.access(this,function(e){var i=this[0]||{},n=0,a=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(Ze,""):t;if(!("string"!=typeof e||et.test(e)||!le.support.htmlSerialize&&Ye.test(e)||!le.support.leadingWhitespace&&Xe.test(e)||rt[(Ke.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Ge,"<$1></$2>");try{for(;a>n;n++)i=this[n]||{},1===i.nodeType&&(le.cleanData(b(i,!1)),i.innerHTML=e);i=0}catch(o){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=le.isFunction(e);return t||"string"==typeof e||(e=le(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,i=this.parentNode;i&&(le(this).remove(),i.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,n){e=te.apply([],e);var a,o,r,s,l,c,u=0,h=this.length,d=this,v=h-1,g=e[0],y=le.isFunction(g);if(y||!(1>=h||"string"!=typeof g||le.support.checkClone)&&it.test(g))return this.each(function(a){var o=d.eq(a);y&&(e[0]=g.call(this,a,i?o.html():t)),o.domManip(e,i,n)});if(h&&(c=le.buildFragment(e,this[0].ownerDocument,!1,this),a=c.firstChild,1===c.childNodes.length&&(c=a),a)){for(i=i&&le.nodeName(a,"tr"),s=le.map(b(c,"script"),f),r=s.length;h>u;u++)o=c,u!==v&&(o=le.clone(o,!0,!0),r&&le.merge(s,b(o,"script"))),n.call(i&&le.nodeName(this[u],"table")?p(this[u],"tbody"):this[u],o,u);if(r)for(l=s[s.length-1].ownerDocument,le.map(s,m),u=0;r>u;u++)o=s[u],nt.test(o.type||"")&&!le._data(o,"globalEval")&&le.contains(l,o)&&(o.src?le.ajax({url:o.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):le.globalEval((o.text||o.textContent||o.innerHTML||"").replace(ot,"")));c=a=null}return this}}),le.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){le.fn[e]=function(e){for(var i,n=0,a=[],o=le(e),r=o.length-1;r>=n;n++)i=n===r?this:this.clone(!0),le(o[n])[t](i),ie.apply(a,i.get());return this.pushStack(a)}}),le.extend({clone:function(e,t,i){var n,a,o,r,s,l=le.contains(e.ownerDocument,e);if(le.support.html5Clone||le.isXMLDoc(e)||!Ye.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(lt.innerHTML=e.outerHTML,lt.removeChild(o=lt.firstChild)),!(le.support.noCloneEvent&&le.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||le.isXMLDoc(e)))for(n=b(o),s=b(e),r=0;null!=(a=s[r]);++r)n[r]&&y(a,n[r]);if(t)if(i)for(s=s||b(e),n=n||b(o),r=0;null!=(a=s[r]);r++)g(a,n[r]);else g(e,o);return n=b(o,"script"),n.length>0&&v(n,!l&&b(e,"script")),n=s=a=null,o},buildFragment:function(e,t,i,n){for(var a,o,r,s,l,c,u,h=e.length,p=d(t),f=[],m=0;h>m;m++)if(o=e[m],o||0===o)if("object"===le.type(o))le.merge(f,o.nodeType?[o]:o);else if(Qe.test(o)){for(s=s||p.appendChild(t.createElement("div")),l=(Ke.exec(o)||["",""])[1].toLowerCase(),u=rt[l]||rt._default,s.innerHTML=u[1]+o.replace(Ge,"<$1></$2>")+u[2],a=u[0];a--;)s=s.lastChild;if(!le.support.leadingWhitespace&&Xe.test(o)&&f.push(t.createTextNode(Xe.exec(o)[0])),!le.support.tbody)for(o="table"!==l||Je.test(o)?"<table>"!==u[1]||Je.test(o)?0:s:s.firstChild,a=o&&o.childNodes.length;a--;)le.nodeName(c=o.childNodes[a],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(le.merge(f,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=p.lastChild}else f.push(t.createTextNode(o));for(s&&p.removeChild(s),le.support.appendChecked||le.grep(b(f,"input"),w),m=0;o=f[m++];)if((!n||-1===le.inArray(o,n))&&(r=le.contains(o.ownerDocument,o),
s=b(p.appendChild(o),"script"),r&&v(s),i))for(a=0;o=s[a++];)nt.test(o.type||"")&&i.push(o);return s=null,p},cleanData:function(e,t){for(var i,n,a,o,r=0,s=le.expando,l=le.cache,c=le.support.deleteExpando,u=le.event.special;null!=(i=e[r]);r++)if((t||le.acceptData(i))&&(a=i[s],o=a&&l[a])){if(o.events)for(n in o.events)u[n]?le.event.remove(i,n):le.removeEvent(i,n,o.handle);l[a]&&(delete l[a],c?delete i[s]:typeof i.removeAttribute!==Z?i.removeAttribute(s):i[s]=null,Q.push(a))}}});var ct,ut,ht,dt=/alpha\([^)]*\)/i,pt=/opacity\s*=\s*([^)]*)/,ft=/^(top|right|bottom|left)$/,mt=/^(none|table(?!-c[ea]).+)/,vt=/^margin/,gt=new RegExp("^("+ce+")(.*)$","i"),yt=new RegExp("^("+ce+")(?!px)[a-z%]+$","i"),bt=new RegExp("^([+-])=("+ce+")","i"),wt={BODY:"block"},_t={position:"absolute",visibility:"hidden",display:"block"},kt={letterSpacing:0,fontWeight:400},xt=["Top","Right","Bottom","Left"],Tt=["Webkit","O","Moz","ms"];le.fn.extend({css:function(e,i){return le.access(this,function(e,i,n){var a,o,r={},s=0;if(le.isArray(i)){for(o=ut(e),a=i.length;a>s;s++)r[i[s]]=le.css(e,i[s],!1,o);return r}return n!==t?le.style(e,i,n):le.css(e,i)},e,i,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:k(this))?le(this).show():le(this).hide()})}}),le.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ht(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":le.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,a){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,s,l=le.camelCase(i),c=e.style;if(i=le.cssProps[l]||(le.cssProps[l]=_(c,l)),s=le.cssHooks[i]||le.cssHooks[l],n===t)return s&&"get"in s&&(o=s.get(e,!1,a))!==t?o:c[i];if(r=typeof n,"string"===r&&(o=bt.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(le.css(e,i)),r="number"),!(null==n||"number"===r&&isNaN(n)||("number"!==r||le.cssNumber[l]||(n+="px"),le.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(c[i]="inherit"),s&&"set"in s&&(n=s.set(e,n,a))===t)))try{c[i]=n}catch(u){}}},css:function(e,i,n,a){var o,r,s,l=le.camelCase(i);return i=le.cssProps[l]||(le.cssProps[l]=_(e.style,l)),s=le.cssHooks[i]||le.cssHooks[l],s&&"get"in s&&(r=s.get(e,!0,n)),r===t&&(r=ht(e,i,a)),"normal"===r&&i in kt&&(r=kt[i]),""===n||n?(o=parseFloat(r),n===!0||le.isNumeric(o)?o||0:r):r},swap:function(e,t,i,n){var a,o,r={};for(o in t)r[o]=e.style[o],e.style[o]=t[o];a=i.apply(e,n||[]);for(o in t)e.style[o]=r[o];return a}}),e.getComputedStyle?(ut=function(t){return e.getComputedStyle(t,null)},ht=function(e,i,n){var a,o,r,s=n||ut(e),l=s?s.getPropertyValue(i)||s[i]:t,c=e.style;return s&&(""!==l||le.contains(e.ownerDocument,e)||(l=le.style(e,i)),yt.test(l)&&vt.test(i)&&(a=c.width,o=c.minWidth,r=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=s.width,c.width=a,c.minWidth=o,c.maxWidth=r)),l}):Y.documentElement.currentStyle&&(ut=function(e){return e.currentStyle},ht=function(e,i,n){var a,o,r,s=n||ut(e),l=s?s[i]:t,c=e.style;return null==l&&c&&c[i]&&(l=c[i]),yt.test(l)&&!ft.test(i)&&(a=c.left,o=e.runtimeStyle,r=o&&o.left,r&&(o.left=e.currentStyle.left),c.left="fontSize"===i?"1em":l,l=c.pixelLeft+"px",c.left=a,r&&(o.left=r)),""===l?"auto":l}),le.each(["height","width"],function(e,t){le.cssHooks[t]={get:function(e,i,n){return i?0===e.offsetWidth&&mt.test(le.css(e,"display"))?le.swap(e,_t,function(){return E(e,t,n)}):E(e,t,n):void 0},set:function(e,i,n){var a=n&&ut(e);return T(e,i,n?S(e,t,n,le.support.boxSizing&&"border-box"===le.css(e,"boxSizing",!1,a),a):0)}}}),le.support.opacity||(le.cssHooks.opacity={get:function(e,t){return pt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,a=le.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===le.trim(o.replace(dt,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=dt.test(o)?o.replace(dt,a):o+" "+a)}}),le(function(){le.support.reliableMarginRight||(le.cssHooks.marginRight={get:function(e,t){return t?le.swap(e,{display:"inline-block"},ht,[e,"marginRight"]):void 0}}),!le.support.pixelPosition&&le.fn.position&&le.each(["top","left"],function(e,t){le.cssHooks[t]={get:function(e,i){return i?(i=ht(e,t),yt.test(i)?le(e).position()[t]+"px":i):void 0}}})}),le.expr&&le.expr.filters&&(le.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!le.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||le.css(e,"display"))},le.expr.filters.visible=function(e){return!le.expr.filters.hidden(e)}),le.each({margin:"",padding:"",border:"Width"},function(e,t){le.cssHooks[e+t]={expand:function(i){for(var n=0,a={},o="string"==typeof i?i.split(" "):[i];4>n;n++)a[e+xt[n]+t]=o[n]||o[n-2]||o[0];return a}},vt.test(e)||(le.cssHooks[e+t].set=T)});var St=/%20/g,Et=/\[\]$/,Ct=/\r?\n/g,Mt=/^(?:submit|button|image|reset|file)$/i,Lt=/^(?:input|select|textarea|keygen)/i;le.fn.extend({serialize:function(){return le.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=le.prop(this,"elements");return e?le.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!le(this).is(":disabled")&&Lt.test(this.nodeName)&&!Mt.test(e)&&(this.checked||!tt.test(e))}).map(function(e,t){var i=le(this).val();return null==i?null:le.isArray(i)?le.map(i,function(e){return{name:t.name,value:e.replace(Ct,"\r\n")}}):{name:t.name,value:i.replace(Ct,"\r\n")}}).get()}}),le.param=function(e,i){var n,a=[],o=function(e,t){t=le.isFunction(t)?t():null==t?"":t,a[a.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=le.ajaxSettings&&le.ajaxSettings.traditional),le.isArray(e)||e.jquery&&!le.isPlainObject(e))le.each(e,function(){o(this.name,this.value)});else for(n in e)L(n,e[n],i,o);return a.join("&").replace(St,"+")},le.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){le.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),le.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var Pt,Dt,At=le.now(),$t=/\?/,Nt=/#.*$/,It=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,zt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Bt=/^(?:GET|HEAD)$/,jt=/^\/\//,Rt=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ft=le.fn.load,Ht={},Vt={},Ut="*/".concat("*");try{Dt=X.href}catch(qt){Dt=Y.createElement("a"),Dt.href="",Dt=Dt.href}Pt=Rt.exec(Dt.toLowerCase())||[],le.fn.load=function(e,i,n){if("string"!=typeof e&&Ft)return Ft.apply(this,arguments);var a,o,r,s=this,l=e.indexOf(" ");return l>=0&&(a=e.slice(l,e.length),e=e.slice(0,l)),le.isFunction(i)?(n=i,i=t):i&&"object"==typeof i&&(r="POST"),s.length>0&&le.ajax({url:e,type:r,dataType:"html",data:i}).done(function(e){o=arguments,s.html(a?le("<div>").append(le.parseHTML(e)).find(a):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},le.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){le.fn[t]=function(e){return this.on(t,e)}}),le.each(["get","post"],function(e,i){le[i]=function(e,n,a,o){return le.isFunction(n)&&(o=o||a,a=n,n=t),le.ajax({url:e,type:i,dataType:o,data:n,success:a})}}),le.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Dt,type:"GET",isLocal:zt.test(Pt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":le.parseJSON,"text xml":le.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?A(A(e,le.ajaxSettings),t):A(le.ajaxSettings,e)},ajaxPrefilter:P(Ht),ajaxTransport:P(Vt),ajax:function(e,i){function n(e,i,n,a){var o,h,y,b,_,x=i;2!==w&&(w=2,l&&clearTimeout(l),u=t,s=a||"",k.readyState=e>0?4:0,n&&(b=$(d,k,n)),e>=200&&300>e||304===e?(d.ifModified&&(_=k.getResponseHeader("Last-Modified"),_&&(le.lastModified[r]=_),_=k.getResponseHeader("etag"),_&&(le.etag[r]=_)),204===e?(o=!0,x="nocontent"):304===e?(o=!0,x="notmodified"):(o=N(d,b),x=o.state,h=o.data,y=o.error,o=!y)):(y=x,(e||!x)&&(x="error",0>e&&(e=0))),k.status=e,k.statusText=(i||x)+"",o?m.resolveWith(p,[h,x,k]):m.rejectWith(p,[k,x,y]),k.statusCode(g),g=t,c&&f.trigger(o?"ajaxSuccess":"ajaxError",[k,d,o?h:y]),v.fireWith(p,[k,x]),c&&(f.trigger("ajaxComplete",[k,d]),--le.active||le.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var a,o,r,s,l,c,u,h,d=le.ajaxSetup({},i),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?le(p):le.event,m=le.Deferred(),v=le.Callbacks("once memory"),g=d.statusCode||{},y={},b={},w=0,_="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!h)for(h={};t=Ot.exec(s);)h[t[1].toLowerCase()]=t[2];t=h[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?s:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return w||(e=b[i]=b[i]||e,y[e]=t),this},overrideMimeType:function(e){return w||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>w)for(t in e)g[t]=[g[t],e[t]];else k.always(e[k.status]);return this},abort:function(e){var t=e||_;return u&&u.abort(t),n(0,t),this}};if(m.promise(k).complete=v.add,k.success=k.done,k.error=k.fail,d.url=((e||d.url||Dt)+"").replace(Nt,"").replace(jt,Pt[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=le.trim(d.dataType||"*").toLowerCase().match(ue)||[""],null==d.crossDomain&&(a=Rt.exec(d.url.toLowerCase()),d.crossDomain=!(!a||a[1]===Pt[1]&&a[2]===Pt[2]&&(a[3]||("http:"===a[1]?80:443))==(Pt[3]||("http:"===Pt[1]?80:443)))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=le.param(d.data,d.traditional)),D(Ht,d,i,k),2===w)return k;c=d.global,c&&0===le.active++&&le.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Bt.test(d.type),r=d.url,d.hasContent||(d.data&&(r=d.url+=($t.test(r)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=It.test(r)?r.replace(It,"$1_="+At++):r+($t.test(r)?"&":"?")+"_="+At++)),d.ifModified&&(le.lastModified[r]&&k.setRequestHeader("If-Modified-Since",le.lastModified[r]),le.etag[r]&&k.setRequestHeader("If-None-Match",le.etag[r])),(d.data&&d.hasContent&&d.contentType!==!1||i.contentType)&&k.setRequestHeader("Content-Type",d.contentType),k.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Ut+"; q=0.01":""):d.accepts["*"]);for(o in d.headers)k.setRequestHeader(o,d.headers[o]);if(d.beforeSend&&(d.beforeSend.call(p,k,d)===!1||2===w))return k.abort();_="abort";for(o in{success:1,error:1,complete:1})k[o](d[o]);if(u=D(Vt,d,i,k)){k.readyState=1,c&&f.trigger("ajaxSend",[k,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){k.abort("timeout")},d.timeout));try{w=1,u.send(y,n)}catch(x){if(!(2>w))throw x;n(-1,x)}}else n(-1,"No Transport");return k},getScript:function(e,i){return le.get(e,t,i,"script")},getJSON:function(e,t,i){return le.get(e,t,i,"json")}}),le.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return le.globalEval(e),e}}}),le.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),le.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=Y.head||le("head")[0]||Y.documentElement;return{send:function(t,a){i=Y.createElement("script"),i.async=!0,e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||a(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(t,!0)}}}});var Wt=[],Zt=/(=)\?(?=&|$)|\?\?/;le.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Wt.pop()||le.expando+"_"+At++;return this[e]=!0,e}}),le.ajaxPrefilter("json jsonp",function(i,n,a){var o,r,s,l=i.jsonp!==!1&&(Zt.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zt.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(o=i.jsonpCallback=le.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Zt,"$1"+o):i.jsonp!==!1&&(i.url+=($t.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return s||le.error(o+" was not called"),s[0]},i.dataTypes[0]="json",r=e[o],e[o]=function(){s=arguments},a.always(function(){e[o]=r,i[o]&&(i.jsonpCallback=n.jsonpCallback,Wt.push(o)),s&&le.isFunction(r)&&r(s[0]),s=r=t}),"script"):void 0});var Yt,Xt,Gt=0,Kt=e.ActiveXObject&&function(){var e;for(e in Yt)Yt[e](t,!0)};le.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&I()||O()}:I,Xt=le.ajaxSettings.xhr(),le.support.cors=!!Xt&&"withCredentials"in Xt,Xt=le.support.ajax=!!Xt,Xt&&le.ajaxTransport(function(i){if(!i.crossDomain||le.support.cors){var n;return{send:function(a,o){var r,s,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(s in i.xhrFields)l[s]=i.xhrFields[s];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||a["X-Requested-With"]||(a["X-Requested-With"]="XMLHttpRequest");try{for(s in a)l.setRequestHeader(s,a[s])}catch(c){}l.send(i.hasContent&&i.data||null),n=function(e,a){var s,c,u,h;try{if(n&&(a||4===l.readyState))if(n=t,r&&(l.onreadystatechange=le.noop,Kt&&delete Yt[r]),a)4!==l.readyState&&l.abort();else{h={},s=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(h.text=l.responseText);try{u=l.statusText}catch(d){u=""}s||!i.isLocal||i.crossDomain?1223===s&&(s=204):s=h.text?200:404}}catch(p){a||o(-1,p)}h&&o(s,u,h,c)},i.async?4===l.readyState?setTimeout(n):(r=++Gt,Kt&&(Yt||(Yt={},le(e).unload(Kt)),Yt[r]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(t,!0)}}}});var Jt,Qt,ei=/^(?:toggle|show|hide)$/,ti=new RegExp("^(?:([+-])=|)("+ce+")([a-z%]*)$","i"),ii=/queueHooks$/,ni=[F],ai={"*":[function(e,t){var i,n,a=this.createTween(e,t),o=ti.exec(t),r=a.cur(),s=+r||0,l=1,c=20;if(o){if(i=+o[2],n=o[3]||(le.cssNumber[e]?"":"px"),"px"!==n&&s){s=le.css(a.elem,e,!0)||i||1;do l=l||".5",s/=l,le.style(a.elem,e,s+n);while(l!==(l=a.cur()/r)&&1!==l&&--c)}a.unit=n,a.start=s,a.end=o[1]?s+(o[1]+1)*i:i}return a}]};le.Animation=le.extend(j,{tweener:function(e,t){le.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,a=e.length;a>n;n++)i=e[n],ai[i]=ai[i]||[],ai[i].unshift(t)},prefilter:function(e,t){t?ni.unshift(e):ni.push(e)}}),le.Tween=H,H.prototype={constructor:H,init:function(e,t,i,n,a,o){this.elem=e,this.prop=i,this.easing=a||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(le.cssNumber[i]?"":"px")},cur:function(){var e=H.propHooks[this.prop];return e&&e.get?e.get(this):H.propHooks._default.get(this)},run:function(e){var t,i=H.propHooks[this.prop];return this.options.duration?this.pos=t=le.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=le.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){le.fx.step[e.prop]?le.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[le.cssProps[e.prop]]||le.cssHooks[e.prop])?le.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},le.each(["toggle","show","hide"],function(e,t){var i=le.fn[t];le.fn[t]=function(e,n,a){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(V(t,!0),e,n,a)}}),le.fn.extend({fadeTo:function(e,t,i,n){return this.filter(k).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var a=le.isEmptyObject(e),o=le.speed(t,i,n),r=function(){var t=j(this,le.extend({},e),o);r.finish=function(){t.stop(!0)},(a||le._data(this,"finish"))&&t.stop(!0)};return r.finish=r,a||o.queue===!1?this.each(r):this.queue(o.queue,r)},stop:function(e,i,n){var a=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=le.timers,r=le._data(this);if(i)r[i]&&r[i].stop&&a(r[i]);else for(i in r)r[i]&&r[i].stop&&ii.test(i)&&a(r[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&le.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=le._data(this),n=i[e+"queue"],a=i[e+"queueHooks"],o=le.timers,r=n?n.length:0;for(i.finish=!0,le.queue(this,e,[]),a&&a.cur&&a.cur.finish&&a.cur.finish.call(this),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;r>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),le.each({slideDown:V("show"),slideUp:V("hide"),slideToggle:V("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){le.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),le.speed=function(e,t,i){var n=e&&"object"==typeof e?le.extend({},e):{complete:i||!i&&t||le.isFunction(e)&&e,duration:e,easing:i&&t||t&&!le.isFunction(t)&&t};return n.duration=le.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in le.fx.speeds?le.fx.speeds[n.duration]:le.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){le.isFunction(n.old)&&n.old.call(this),n.queue&&le.dequeue(this,n.queue)},n},le.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},le.timers=[],le.fx=H.prototype.init,le.fx.tick=function(){var e,i=le.timers,n=0;for(Jt=le.now();n<i.length;n++)e=i[n],e()||i[n]!==e||i.splice(n--,1);i.length||le.fx.stop(),Jt=t},le.fx.timer=function(e){e()&&le.timers.push(e)&&le.fx.start()},le.fx.interval=13,le.fx.start=function(){Qt||(Qt=setInterval(le.fx.tick,le.fx.interval))},le.fx.stop=function(){clearInterval(Qt),Qt=null},le.fx.speeds={slow:600,fast:200,_default:400},le.fx.step={},le.expr&&le.expr.filters&&(le.expr.filters.animated=function(e){return le.grep(le.timers,function(t){return e===t.elem}).length}),le.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){le.offset.setOffset(this,e,t)});var i,n,a={top:0,left:0},o=this[0],r=o&&o.ownerDocument;if(r)return i=r.documentElement,le.contains(i,o)?(typeof o.getBoundingClientRect!==Z&&(a=o.getBoundingClientRect()),n=U(r),{top:a.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:a.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):a},le.offset={setOffset:function(e,t,i){var n=le.css(e,"position");"static"===n&&(e.style.position="relative");var a,o,r=le(e),s=r.offset(),l=le.css(e,"top"),c=le.css(e,"left"),u=("absolute"===n||"fixed"===n)&&le.inArray("auto",[l,c])>-1,h={},d={};u?(d=r.position(),a=d.top,o=d.left):(a=parseFloat(l)||0,o=parseFloat(c)||0),le.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(h.top=t.top-s.top+a),null!=t.left&&(h.left=t.left-s.left+o),"using"in t?t.using.call(e,h):r.css(h)}},le.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===le.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),le.nodeName(e[0],"html")||(i=e.offset()),i.top+=le.css(e[0],"borderTopWidth",!0),i.left+=le.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-le.css(n,"marginTop",!0),left:t.left-i.left-le.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Y.documentElement;e&&!le.nodeName(e,"html")&&"static"===le.css(e,"position");)e=e.offsetParent;return e||Y.documentElement})}}),le.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);le.fn[e]=function(a){return le.access(this,function(e,a,o){var r=U(e);return o===t?r?i in r?r[i]:r.document.documentElement[a]:e[a]:void(r?r.scrollTo(n?le(r).scrollLeft():o,n?o:le(r).scrollTop()):e[a]=o)},e,a,arguments.length,null)}}),le.each({Height:"height",Width:"width"},function(e,i){le.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,a){le.fn[a]=function(a,o){var r=arguments.length&&(n||"boolean"!=typeof a),s=n||(a===!0||o===!0?"margin":"border");return le.access(this,function(i,n,a){var o;return le.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+e],o["scroll"+e],i.body["offset"+e],o["offset"+e],o["client"+e])):a===t?le.css(i,n,s):le.style(i,n,a,s)},i,r?a:t,r,null)}})}),e.jQuery=e.$=le,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return le})}(window),function(){var e=this,t=e._,i={},n=Array.prototype,a=Object.prototype,o=Function.prototype,r=n.push,s=n.slice,l=n.concat,c=a.toString,u=a.hasOwnProperty,h=n.forEach,d=n.map,p=n.reduce,f=n.reduceRight,m=n.filter,v=n.every,g=n.some,y=n.indexOf,b=n.lastIndexOf,w=Array.isArray,_=Object.keys,k=o.bind,x=function(e){return e instanceof x?e:this instanceof x?void(this._wrapped=e):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var T=x.each=x.forEach=function(e,t,n){if(null!=e)if(h&&e.forEach===h)e.forEach(t,n);else if(e.length===+e.length){for(var a=0,o=e.length;o>a;a++)if(t.call(n,e[a],a,e)===i)return}else for(var r in e)if(x.has(e,r)&&t.call(n,e[r],r,e)===i)return};x.map=x.collect=function(e,t,i){var n=[];return null==e?n:d&&e.map===d?e.map(t,i):(T(e,function(e,a,o){n[n.length]=t.call(i,e,a,o)}),n)};var S="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=x.bind(t,n)),a?e.reduce(t,i):e.reduce(t);if(T(e,function(e,o,r){a?i=t.call(n,i,e,o,r):(i=e,a=!0)}),!a)throw new TypeError(S);return i},x.reduceRight=x.foldr=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=x.bind(t,n)),a?e.reduceRight(t,i):e.reduceRight(t);var o=e.length;if(o!==+o){var r=x.keys(e);o=r.length}if(T(e,function(s,l,c){l=r?r[--o]:--o,a?i=t.call(n,i,e[l],l,c):(i=e[l],a=!0)}),!a)throw new TypeError(S);return i},x.find=x.detect=function(e,t,i){var n;return E(e,function(e,a,o){return t.call(i,e,a,o)?(n=e,!0):void 0}),n},x.filter=x.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(T(e,function(e,a,o){t.call(i,e,a,o)&&(n[n.length]=e)}),n)},x.reject=function(e,t,i){return x.filter(e,function(e,n,a){return!t.call(i,e,n,a)},i)},x.every=x.all=function(e,t,n){t||(t=x.identity);var a=!0;return null==e?a:v&&e.every===v?e.every(t,n):(T(e,function(e,o,r){return(a=a&&t.call(n,e,o,r))?void 0:i}),!!a)};var E=x.some=x.any=function(e,t,n){t||(t=x.identity);var a=!1;return null==e?a:g&&e.some===g?e.some(t,n):(T(e,function(e,o,r){return a||(a=t.call(n,e,o,r))?i:void 0}),!!a)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):E(e,function(e){return e===t})},x.invoke=function(e,t){var i=s.call(arguments,2),n=x.isFunction(t);return x.map(e,function(e){return(n?t:e[t]).apply(e,i)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,i){return x.isEmpty(t)?i?null:[]:x[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-(1/0);var n={computed:-(1/0),value:-(1/0)};return T(e,function(e,a,o){var r=t?t.call(i,e,a,o):e;r>=n.computed&&(n={value:e,computed:r})}),n.value},x.min=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return T(e,function(e,a,o){var r=t?t.call(i,e,a,o):e;r<n.computed&&(n={value:e,computed:r})}),n.value},x.shuffle=function(e){var t,i=0,n=[];return T(e,function(e){t=x.random(i++),n[i-1]=n[t],n[t]=e}),n};var C=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,i){var n=C(t);return x.pluck(x.map(e,function(e,t,a){return{value:e,index:t,criteria:n.call(i,e,t,a)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index<t.index?-1:1}),"value")};var M=function(e,t,i,n){var a={},o=C(t||x.identity);return T(e,function(t,r){var s=o.call(i,t,r,e);n(a,s,t)}),a};x.groupBy=function(e,t,i){return M(e,t,i,function(e,t,i){(x.has(e,t)?e[t]:e[t]=[]).push(i)})},x.countBy=function(e,t,i){return M(e,t,i,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,i,n){i=null==i?x.identity:C(i);for(var a=i.call(n,t),o=0,r=e.length;r>o;){var s=o+r>>>1;i.call(n,e[s])<a?o=s+1:r=s}return o},x.toArray=function(e){return e?x.isArray(e)?s.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:s.call(e,0,t)},x.initial=function(e,t,i){return s.call(e,0,e.length-(null==t||i?1:t))},x.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,i){return s.call(e,null==t||i?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var L=function(e,t,i){return T(e,function(e){x.isArray(e)?t?r.apply(i,e):L(e,t,i):i.push(e)}),i};x.flatten=function(e,t){return L(e,t,[])},x.without=function(e){return x.difference(e,s.call(arguments,1))},x.uniq=x.unique=function(e,t,i,n){x.isFunction(t)&&(n=i,i=t,t=!1);var a=i?x.map(e,i,n):e,o=[],r=[];return T(a,function(i,n){(t?n&&r[r.length-1]===i:x.contains(r,i))||(r.push(i),o.push(e[n]))}),o},x.union=function(){return x.uniq(l.apply(n,arguments))},x.intersection=function(e){var t=s.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=l.apply(n,s.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=s.call(arguments),t=x.max(x.pluck(e,"length")),i=new Array(t),n=0;t>n;n++)i[n]=x.pluck(e,""+n);return i},x.object=function(e,t){if(null==e)return{};for(var i={},n=0,a=e.length;a>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},x.indexOf=function(e,t,i){if(null==e)return-1;var n=0,a=e.length;if(i){if("number"!=typeof i)return n=x.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,a+i):i}if(y&&e.indexOf===y)return e.indexOf(t,i);for(;a>n;n++)if(e[n]===t)return n;return-1},x.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(b&&e.lastIndexOf===b)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var a=n?i:e.length;a--;)if(e[a]===t)return a;return-1},x.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),a=0,o=new Array(n);n>a;)o[a++]=e,e+=i;return o},x.bind=function(e,t){if(e.bind===k&&k)return k.apply(e,s.call(arguments,1));var i=s.call(arguments,2);return function(){return e.apply(t,i.concat(s.call(arguments)))}},x.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},x.bindAll=function(e){var t=s.call(arguments,1);return 0===t.length&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var i={};return t||(t=x.identity),function(){var n=t.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},x.delay=function(e,t){var i=s.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(s.call(arguments,1)))},x.throttle=function(e,t){var i,n,a,o,r=0,s=function(){r=new Date,a=null,o=e.apply(i,n)};return function(){var l=new Date,c=t-(l-r);return i=this,n=arguments,0>=c?(clearTimeout(a),a=null,r=l,o=e.apply(i,n)):a||(a=setTimeout(s,c)),o}},x.debounce=function(e,t,i){var n,a;return function(){var o=this,r=arguments,s=function(){n=null,i||(a=e.apply(o,r))},l=i&&!n;return clearTimeout(n),n=setTimeout(s,t),l&&(a=e.apply(o,r)),a}},x.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var i=[e];return r.apply(i,arguments),t.apply(this,i)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)x.has(e,i)&&(t[t.length]=i);return t},x.values=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push(e[i]);return t},x.pairs=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push([i,e[i]]);return t},x.invert=function(e){var t={};for(var i in e)x.has(e,i)&&(t[e[i]]=i);return t},x.functions=x.methods=function(e){var t=[];for(var i in e)x.isFunction(e[i])&&t.push(i);return t.sort()},x.extend=function(e){return T(s.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},x.pick=function(e){var t={},i=l.apply(n,s.call(arguments,1));return T(i,function(i){i in e&&(t[i]=e[i])}),t},x.omit=function(e){var t={},i=l.apply(n,s.call(arguments,1));for(var a in e)x.contains(i,a)||(t[a]=e[a]);return t},x.defaults=function(e){return T(s.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var P=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var a=c.call(e);if(a!=c.call(t))return!1;switch(a){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=i.length;o--;)if(i[o]==e)return n[o]==t;i.push(e),n.push(t);var r=0,s=!0;if("[object Array]"==a){if(r=e.length,s=r==t.length)for(;r--&&(s=P(e[r],t[r],i,n)););}else{var l=e.constructor,u=t.constructor;if(l!==u&&!(x.isFunction(l)&&l instanceof l&&x.isFunction(u)&&u instanceof u))return!1;for(var h in e)if(x.has(e,h)&&(r++,!(s=x.has(t,h)&&P(e[h],t[h],i,n))))break;if(s){for(h in t)if(x.has(t,h)&&!r--)break;s=!r}}return i.pop(),n.pop(),s};x.isEqual=function(e,t){return P(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!(!e||1!==e.nodeType)},x.isArray=w||function(e){return"[object Array]"==c.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!(!e||!x.has(e,"callee"));
}),"function"!=typeof/./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return u.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,i){for(var n=Array(e),a=0;e>a;a++)n[a]=t.call(i,a);return n},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};D.unescape=x.invert(D.escape);var A={escape:new RegExp("["+x.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(D.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(A[e],function(t){return D[e][t]})}}),x.result=function(e,t){if(null==e)return null;var i=e[t];return x.isFunction(i)?i.call(e):i},x.mixin=function(e){T(x.functions(e),function(t){var i=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return r.apply(e,arguments),z.call(this,i.apply(x,e))}})};var $=0;x.uniqueId=function(e){var t=++$+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,i){var n;i=x.defaults({},i,x.templateSettings);var a=new RegExp([(i.escape||N).source,(i.interpolate||N).source,(i.evaluate||N).source].join("|")+"|$","g"),o=0,r="__p+='";e.replace(a,function(t,i,n,a,s){return r+=e.slice(o,s).replace(O,function(e){return"\\"+I[e]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(r+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(r+="';\n"+a+"\n__p+='"),o=s+t.length,t}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{n=new Function(i.variable||"obj","_",r)}catch(s){throw s.source=r,s}if(t)return n(t,x);var l=function(e){return n.call(this,e,x)};return l.source="function("+(i.variable||"obj")+"){\n"+r+"}",l},x.chain=function(e){return x(e).chain()};var z=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];x.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],z.call(this,i)}}),T(["concat","join","slice"],function(e){var t=n[e];x.prototype[e]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){var t;return t||e._}}(this)),function(){var e,t=this,i=t.Backbone,n=[],a=n.push,o=n.slice,r=n.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.0.0";var s=t._;s||"undefined"==typeof require||(s=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var l=e.Events={on:function(e,t,i){if(!u(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,i){if(!u(this,"once",e,[t,i])||!t)return this;var n=this,a=s.once(function(){n.off(e,a),t.apply(this,arguments)});return a._callback=t,this.on(e,a,i)},off:function(e,t,i){var n,a,o,r,l,c,h,d;if(!this._events||!u(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(r=e?[e]:s.keys(this._events),l=0,c=r.length;c>l;l++)if(e=r[l],o=this._events[e]){if(this._events[e]=n=[],t||i)for(h=0,d=o.length;d>h;h++)a=o[h],(t&&t!==a.callback&&t!==a.callback._callback||i&&i!==a.context)&&n.push(a);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!u(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&h(i,t),n&&h(n,arguments),this},stopListening:function(e,t,i){var n=this._listeners;if(!n)return this;var a=!t&&!i;"object"==typeof t&&(i=this),e&&((n={})[e._listenerId]=e);for(var o in n)n[o].off(t,i,this),a&&delete this._listeners[o];return this}},c=/\s+/,u=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var a in i)e[t].apply(e,[a,i[a]].concat(n));return!1}if(c.test(i)){for(var o=i.split(c),r=0,s=o.length;s>r;r++)e[t].apply(e,[o[r]].concat(n));return!1}return!0},h=function(e,t){var i,n=-1,a=e.length,o=t[0],r=t[1],s=t[2];switch(t.length){case 0:for(;++n<a;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<a;)(i=e[n]).callback.call(i.ctx,o);return;case 2:for(;++n<a;)(i=e[n]).callback.call(i.ctx,o,r);return;case 3:for(;++n<a;)(i=e[n]).callback.call(i.ctx,o,r,s);return;default:for(;++n<a;)(i=e[n]).callback.apply(i.ctx,t)}},d={listenTo:"on",listenToOnce:"once"};s.each(d,function(e,t){l[t]=function(t,i,n){var a=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=s.uniqueId("l"));return a[o]=t,"object"==typeof i&&(n=this),t[e](i,n,this),this}}),l.bind=l.on,l.unbind=l.off,s.extend(e,l);var p=e.Model=function(e,t){var i,n=e||{};t||(t={}),this.cid=s.uniqueId("c"),this.attributes={},s.extend(this,s.pick(t,f)),t.parse&&(n=this.parse(n,t)||{}),(i=s.result(this,"defaults"))&&(n=s.defaults({},n,i)),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)},f=["url","urlRoot","collection"];s.extend(p.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,a,o,r,l,c,u,h;if(null==e)return this;if("object"==typeof e?(a=e,i=t):(a={})[e]=t,i||(i={}),!this._validate(a,i))return!1;o=i.unset,l=i.silent,r=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=s.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in a&&(this.id=a[this.idAttribute]);for(n in a)t=a[n],s.isEqual(h[n],t)||r.push(n),s.isEqual(u[n],t)?delete this.changed[n]:this.changed[n]=t,o?delete h[n]:h[n]=t;if(!l){r.length&&(this._pending=!0);for(var d=0,p=r.length;p>d;d++)this.trigger("change:"+r[d],this,h[r[d]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var a in e)s.isEqual(n[a],t=e[a])||((i||(i={}))[a]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},z(this,e),this.sync("read",this,e)},save:function(e,t,i){var n,a,o,r=this.attributes;if(null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,!(!n||i&&i.wait||this.set(n,i)))return!1;if(i=s.extend({validate:!0},i),!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=s.extend({},r,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=r;var t=l.parse(e,i);return i.wait&&(t=s.extend(n||{},t)),s.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),void l.trigger("sync",l,e,i))},z(this,i),a=this.isNew()?"create":i.patch?"patch":"update","patch"===a&&(i.attrs=n),o=this.sync(a,this,i),n&&i.wait&&(this.attributes=r),o},destroy:function(e){e=e?s.clone(e):{};var t=this,i=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(a){(e.wait||t.isNew())&&n(),i&&i(t,a,e),t.isNew()||t.trigger("sync",t,a,e)},this.isNew())return e.success(),!1;z(this,e);var a=this.sync("delete",this,e);return e.wait||n(),a},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||O();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},s.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,s.extend(t||{},{validationError:i})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];s.each(m,function(e){p.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),s[e].apply(s,t)}});var v=e.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};s.extend(v.prototype,l,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,s.defaults(t||{},y))},remove:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var i,n,a,o;for(i=0,n=e.length;n>i;i++)o=this.get(e[i]),o&&(delete this._byId[o.id],delete this._byId[o.cid],a=this.indexOf(o),this.models.splice(a,1),this.length--,t.silent||(t.index=a,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){t=s.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),s.isArray(e)||(e=e?[e]:[]);var i,n,o,l,c,u=t.at,h=this.comparator&&null==u&&t.sort!==!1,d=s.isString(this.comparator)?this.comparator:null,p=[],f=[],m={};for(i=0,n=e.length;n>i;i++)(o=this._prepareModel(e[i],t))&&((l=this.get(o))?(t.remove&&(m[l.cid]=!0),t.merge&&(l.set(o.attributes,t),h&&!c&&l.hasChanged(d)&&(c=!0))):t.add&&(p.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(t.remove){for(i=0,n=this.length;n>i;++i)m[(o=this.models[i]).cid]||f.push(o);f.length&&this.remove(f,t)}if(p.length&&(h&&(c=!0),this.length+=p.length,null!=u?r.apply(this.models,[u,0].concat(p)):a.apply(this.models,p)),c&&this.sort({silent:!0}),t.silent)return this;for(i=0,n=p.length;n>i;i++)(o=p[i]).trigger("add",o,this,t);return c&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models,this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return s.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,i){t||(t=this.comparator);var n=s.isFunction(t)?t:function(e){return e.get(t)};return s.sortedIndex(this.models,e,n,i)},pluck:function(e){return s.invoke(this.models,"get",e)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var a=e.reset?"reset":"set";i[a](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},z(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,n=t.success;return t.success=function(a){t.wait&&i.add(e,t),n&&n(e,a,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var i=new this.model(e,t);return i._validate(e,t)?i:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(b,function(e){v.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}});var w=["groupBy","countBy","sortBy"];s.each(w,function(e){v.prototype[e]=function(t,i){var n=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,n,i)}});var _=e.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},k=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];s.extend(_.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=s.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(s.isFunction(i)||(i=this[e[t]]),i){var n=t.match(k),a=n[1],o=n[2];i=s.bind(i,this),a+=".delegateEvents"+this.cid,""===o?this.$el.on(a,i):this.$el.on(a,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=s.extend({},s.result(this,"options"),e)),s.extend(this,s.pick(e,x)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t["class"]=s.result(this,"className"));var i=e.$("<"+s.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,n){var a=T[t];s.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:a,dataType:"json"};if(n.url||(o.url=s.result(i,"url")||O()),null!=n.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){o.type="POST",n.emulateJSON&&(o.data._method=a);var r=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",a),r?r.apply(this,arguments):void 0}}"GET"===o.type||n.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=e.ajax(s.extend(o,n));return i.trigger("request",i,l,n),l};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,C=/(\(\?)?:\w+/g,M=/\*\w+/g,L=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(S.prototype,l,{initialize:function(){},route:function(t,i,n){s.isRegExp(t)||(t=this._routeToRegExp(t)),s.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var a=this;return e.history.route(t,function(o){var r=a._extractParameters(t,o);n&&n.apply(a,r),a.trigger.apply(a,["route:"+i].concat(r)),a.trigger("route",i,r),e.history.trigger("route",a,i,r)}),this},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(L,"\\$&").replace(E,"(?:$1)?").replace(C,function(e,t){return t?e:"([^/]+)"}).replace(M,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return s.map(i,function(e){return e?decodeURIComponent(e):null})}});var P=e.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,A=/^\/+|\/+$/g,$=/msie [\w.]+/,N=/\/$/;P.started=!1,s.extend(P.prototype,l,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(N,"");e.indexOf(i)||(e=e.substr(i.length))}else e=this.getHash();return e.replace(D,"")},start:function(t){if(P.started)throw new Error("Backbone.history has already been started");P.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,a=$.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(A,"/"),a&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!a?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var o=this.location,r=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!r?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&r&&o.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),P.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(e){var t=this.fragment=this.getFragment(e),i=s.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return i},navigate:function(e,t){if(!P.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var i=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),e.history=new P;var I=function(e,t){var i,n=this;i=e&&s.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,t);var a=function(){this.constructor=i};return a.prototype=n.prototype,i.prototype=new a,e&&s.extend(i.prototype,e),i.__super__=n.prototype,i};p.extend=v.extend=S.extend=_.extend=P.extend=I;var O=function(){throw new Error('A "url" property or function must be specified')},z=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}}}.call(this),define("backbone",["jquery","underscore"],function(e){return function(){var t;return t||e.Backbone}}(this)),!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define("kiosk-session-manager",e):"undefined"!=typeof window?window.KioskSessionManager=e():"undefined"!=typeof global?global.KioskSessionManager=e():"undefined"!=typeof self&&(self.KioskSessionManager=e())}(function(){return function e(t,i,n){function a(r,s){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+r+"'")}var c=i[r]={exports:{}};t[r][0].call(c.exports,function(e){var i=t[r][1][e];return a(i?i:e)},c,c.exports,e,t,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(e,t,i){t.exports=e("./lib/manager.js")},{"./lib/manager.js":2}],2:[function(e,t,i){function n(e){o.call(this),this.timeout=e.timeout,this.session=null}var a=e("./session.js"),o=e("events").EventEmitter,r=e("util").inherits;r(n,o),n.prototype.startSession=function(){function e(){i.session=null,i.emit("end",n)}function t(){i.emit("reset",n)}if(this.session)throw new Error("Can't start new session as active session already exists");var i=this,n=new a(this.timeout);return n.on("end",e),n.on("reset",t),this.session=n,this.emit("start",n),n},n.prototype.reset=function(){return this.session?(this.session.reset(),this.session):this.startSession()},t.exports=n},{"./session.js":3,events:4,util:8}],3:[function(e,t,i){function n(e){c.call(this),this._timeout=e,this._start=Date.now(),this._end=this._start+e,this.ended=!1,this.data={},this.reset()}function a(){this.ended||(this._timer&&clearTimeout(this._timer),this._timer=null,this.ended=!0,this._end=Date.now(),this.emit("end"))}function o(){if(this.ended)throw new Error("Can't reset ended session");this._timer&&clearTimeout(this._timer);var e=Date.now();this._end=Math.max(e+this._timeout,this._end),this._timer=setTimeout(a.bind(this),this._end-e),this.emit("reset")}function r(){return this.ended?+this._end-this._start:+new Date-this._start}function s(){return this._end-Date.now()}function l(e){if(this.ended)throw new Error("Can't prolong ended session");return this._timer&&clearTimeout(this._timer),this._end+=e,this._timer=setTimeout(this.end.bind(this),this._end-Date.now()),this.emit("prolong"),this}var c=e("events").EventEmitter,u=e("util").inherits;u(n,c);var h={end:a,reset:o,length:r,left:s,prolong:l};for(var d in h)n.prototype[d]=h[d];t.exports=n},{events:4,util:8}],4:[function(e,t,i){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function o(e){return"number"==typeof e}function r(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,o,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(i=this._events[e],s(i))return!1;if(a(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),l=1;n>l;l++)o[l-1]=arguments[l];i.apply(this,o)}else if(r(i)){for(n=arguments.length,o=new Array(n-1),l=1;n>l;l++)o[l-1]=arguments[l];for(c=i.slice(),n=c.length,l=0;n>l;l++)c[l].apply(this,o)}return!0},n.prototype.addListener=function(e,t){var i;if(!a(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned){var i;i=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!a(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var i,n,o,s;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],o=i.length,n=-1,i===t||a(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(i)){for(s=o;s-->0;)if(i[s]===t||i[s].listener&&i[s].listener===t){n=s;break}if(0>n)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],a(i))this.removeListener(e,i);else for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var i;return i=e._events&&e._events[t]?a(e._events[t])?1:e._events[t].length:0}},{}],5:[function(e,t,i){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},{}],6:[function(e,t,i){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var i=[];return window.addEventListener("message",function(e){if(e.source===window&&"process-tick"===e.data&&(e.stopPropagation(),i.length>0)){var t=i.shift();t()}},!0),function(e){i.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],7:[function(e,t,i){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],8:[function(e,t,i){function n(e,t){var n={seen:[],stylize:o};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(t)?n.showHidden=t:t&&i._extend(n,t),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=a),s(n,e,n.depth)}function a(e,t){var i=n.styles[t];return i?"["+n.colors[i][0]+"m"+e+"["+n.colors[i][1]+"m":e}function o(e,t){return e}function r(e){var t={};return e.forEach(function(e,i){t[e]=!0}),t}function s(e,t,n){if(e.customInspect&&t&&S(t.inspect)&&t.inspect!==i.inspect&&(!t.constructor||t.constructor.prototype!==t)){var a=t.inspect(n,e);return y(a)||(a=s(e,a,n)),a}var o=l(e,t);if(o)return o;var f=Object.keys(t),m=r(f);if(e.showHidden&&(f=Object.getOwnPropertyNames(t)),T(t)&&(f.indexOf("message")>=0||f.indexOf("description")>=0))return c(t);if(0===f.length){if(S(t)){var v=t.name?": "+t.name:"";return e.stylize("[Function"+v+"]","special")}if(_(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(x(t))return e.stylize(Date.prototype.toString.call(t),"date");if(T(t))return c(t)}var g="",b=!1,w=["{","}"];if(p(t)&&(b=!0,w=["[","]"]),S(t)){var k=t.name?": "+t.name:"";g=" [Function"+k+"]"}if(_(t)&&(g=" "+RegExp.prototype.toString.call(t)),x(t)&&(g=" "+Date.prototype.toUTCString.call(t)),T(t)&&(g=" "+c(t)),0===f.length&&(!b||0==t.length))return w[0]+g+w[1];if(0>n)return _(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var E;return E=b?u(e,t,n,m,f):f.map(function(i){return h(e,t,n,m,i,b)}),e.seen.pop(),d(E,g,w)}function l(e,t){if(w(t))return e.stylize("undefined","undefined");if(y(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}return g(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function u(e,t,i,n,a){for(var o=[],r=0,s=t.length;s>r;++r)P(t,String(r))?o.push(h(e,t,i,n,String(r),!0)):o.push("");return a.forEach(function(a){a.match(/^\d+$/)||o.push(h(e,t,i,n,a,!0))}),o}function h(e,t,i,n,a,o){var r,l,c;if(c=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]},c.get?l=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(l=e.stylize("[Setter]","special")),P(n,a)||(r="["+a+"]"),l||(e.seen.indexOf(c.value)<0?(l=m(i)?s(e,c.value,null):s(e,c.value,i-1),l.indexOf("\n")>-1&&(l=o?l.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+l.split("\n").map(function(e){return"   "+e}).join("\n"))):l=e.stylize("[Circular]","special")),w(r)){if(o&&a.match(/^\d+$/))return l;r=JSON.stringify(""+a),r.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,"name")):(r=r.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),r=e.stylize(r,"string"))}return r+": "+l;
}function d(e,t,i){var n=0,a=e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return a>60?i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1]:i[0]+t+" "+e.join(", ")+" "+i[1]}function p(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return null==e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function w(e){return void 0===e}function _(e){return k(e)&&"[object RegExp]"===C(e)}function k(e){return"object"==typeof e&&null!==e}function x(e){return k(e)&&"[object Date]"===C(e)}function T(e){return k(e)&&("[object Error]"===C(e)||e instanceof Error)}function S(e){return"function"==typeof e}function E(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function C(e){return Object.prototype.toString.call(e)}function M(e){return 10>e?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[M(e.getHours()),M(e.getMinutes()),M(e.getSeconds())].join(":");return[e.getDate(),O[e.getMonth()],t].join(" ")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var D=e("__browserify_process"),A="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},$=/%[sdj%]/g;i.format=function(e){if(!y(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(n(arguments[i]));return t.join(" ")}for(var i=1,a=arguments,o=a.length,r=String(e).replace($,function(e){if("%%"===e)return"%";if(i>=o)return e;switch(e){case"%s":return String(a[i++]);case"%d":return Number(a[i++]);case"%j":try{return JSON.stringify(a[i++])}catch(t){return"[Circular]"}default:return e}}),s=a[i];o>i;s=a[++i])r+=m(s)||!k(s)?" "+s:" "+n(s);return r},i.deprecate=function(e,t){function n(){if(!a){if(D.throwDeprecation)throw new Error(t);D.traceDeprecation?console.trace(t):console.error(t),a=!0}return e.apply(this,arguments)}if(w(A.process))return function(){return i.deprecate(e,t).apply(this,arguments)};if(D.noDeprecation===!0)return e;var a=!1;return n};var N,I={};i.debuglog=function(e){if(w(N)&&(N=D.env.NODE_DEBUG||""),e=e.toUpperCase(),!I[e])if(new RegExp("\\b"+e+"\\b","i").test(N)){var t=D.pid;I[e]=function(){var n=i.format.apply(i,arguments);console.error("%s %d: %s",e,t,n)}}else I[e]=function(){};return I[e]},i.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=p,i.isBoolean=f,i.isNull=m,i.isNullOrUndefined=v,i.isNumber=g,i.isString=y,i.isSymbol=b,i.isUndefined=w,i.isRegExp=_,i.isObject=k,i.isDate=x,i.isError=T,i.isFunction=S,i.isPrimitive=E,i.isBuffer=e("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",L(),i.format.apply(i,arguments))},i.inherits=e("inherits"),i._extend=function(e,t){if(!t||!k(t))return e;for(var i=Object.keys(t),n=i.length;n--;)e[i[n]]=t[i[n]];return e}},{"./support/isBuffer":7,__browserify_process:6,inherits:5}]},{},[1])(1)}),define("framework/utils/backend",[],function(){"use strict";var e,t=function(t){var i=e.config("backend");return void 0===t?i:("/"===i.charAt(i.length-1)&&(i=i.slice(0,i.length-2)),"/"===t.charAt(0)&&(t=t.slice(1)),i+"/"+t)};return t.init=function(t){e=t},t}),define("framework/utils/log",["jquery","underscore","framework/utils/backend"],function(e,t,i){"use strict";var n={};return t.each(["trace","debug","info","warn","error"],function(e){n[e]=function(t){console.log("["+(new Date).toTimeString()+"] ["+e.toUpperCase()+"] "+t)}}),n.event=function(e,t){},n.sendUserActivity=function(t){var i=e(t.currentTarget).data("id"),n=e(t.currentTarget).data("event");console.log("send user activity "+n+" with "+i),this.event(n,{id:i})},n}),define("framework/utils/async",[],function(){"use strict";function e(e){setTimeout(e,r)}function t(t,i,n,a){function r(){for(var c=Math.min(s+o,l);c>s;s++)i.call(n,t[s]);l>s?e(r):a&&a()}var s=0,l=t.length;e(r)}function i(e,t){function i(){--n||t&&t()}var n=e.length;return n?void e.forEach(function(e){e(i)}):t&&t()}function n(e,t){!function i(){e.length?e.shift()(i):t()}()}function a(){this._locked=!1,this._queue=[]}var o=20,r=200;return a.prototype.lock=function(e){return this._locked?e&&this._queue.unshift(e):(this._locked=!0,e&&e()),this},a.prototype.unlock=function(){if(!this._locked)return!1;var e=this._queue.shift();return e?e():this._locked=!1,this},a.prototype.locked=function(){return this._locked},a.prototype.unlocked=function(){return!this._locked},{each:t,Mutex:a,parallel:i,serial:n}}),define("framework/View",["underscore","backbone","framework/utils/log","framework/utils/async"],function(e,t,i,n){"use strict";function a(t,i){return e.isFunction(i)?i.call(t):i}var o,r=t.View.extend({className:"view",subviews:{},regions:{},layout:{},openLoading:!1,i18n:!1,classNames:function(){for(var e=[],i=Object.getPrototypeOf(this);i!==t.View.prototype;)i.hasOwnProperty("className")&&e.unshift(a(this,i.className)),i=Object.getPrototypeOf(i);return e},_ensureElement:function(){if(this.el)this.setElement(e.result(this,"el"),!1);else{var i,n=e.extend({},e.result(this,"attributes"));this.id&&(n.id=e.result(this,"id")),this.className&&(n["class"]=this.classNames().join(" ")),i=t.$("<"+e.result(this,"tagName")+">").attr(n),this.setElement(i,!1)}},id:function(){var e=this.className.split(" ");return e[e.length-1]+"-"+this.cid},initialize:function(){i.trace(e.result(this,"id")+" initialize"),this._state="unloaded",this._rendered=!1,this._regions=this.regions,this._initializeSubviews(),this._stateHistory=[this._state],this._loadingAborted=!1;var t=this;this.i18n&&this.listenTo(o,"application:languagechange",function(){t.load()})},_initializeRegions:function(){var e,t=this._regions;this.regions={};for(e in t)t.hasOwnProperty(e)&&(this.regions[e]=this.$(t[e]))},_initializeSubviews:function(){var t,i=this.subviews;this.subviews={};for(t in i)i.hasOwnProperty(t)&&e.isFunction(i[t])&&(i[t].prototype instanceof r?this.subviews[t]=new i[t]:this.subviews[t]=i[t].apply(this))},data:function(){var e=this.model||this.collection;return e?e.toJSON():{}},render:function(){return this.template&&this.$el.html(this.template(e.result(this,"data"))),this._initializeRegions(),e.each(this.layout,function(e,t){this.regions[t].append(this.subviews[e].$el)},this),this.delegateEvents(),this.afterRender(),this},afterRender:function(){},state:function(e){return"undefined"==typeof e?this._state:e===this._state?this:(this._state=e,this._stateHistory.push(e),void this.trigger("state:"+e))},logStateHistory:function(){i.trace(e.result(this,"id")+" "+this._stateHistory.join(" → "))},load:function(t,n,a){var o=this;return this._loadingAborted=!1,a||i.trace(e.result(this,"id")+" load from state: "+this.state()),"unloaded"===this.state()||"closed"===this.state()?(this.state("loading"),o._rendered=!1,void this._load(function(){o._loadingAborted||(o.state("closed"),t&&t.apply(n))})):"open"===this.state()?void(this.openLoading?(this.state("loading"),this._load(function(){o.state("open"),t&&t.apply(n)})):this.close(function(){o.load(function(){o.open(t,n)})})):"opening"===this.state()?void this.once("state:open",function(){o.load(t,n)}):void this.close(function(){o.load(t,n)},n,!0)},open:function(t,n,a){var o=this;return a||i.trace(e.result(this,"id")+" open from state: "+this.state()),"open"===this.state()?void(t&&t.apply(n)):"closed"===this.state()?(this.state("opening"),this._rendered||(this.render(),this._rendered=!0),void this._open(function(){o.state("open"),t&&t.apply(n)})):"opening"===this.state()?void this.once("state:open",function(){t&&t.apply(n)}):void this.close(function(){o.open(t,n,!0)},n,!0)},close:function(t,n,a){var o=this;return a||i.trace(e.result(this,"id")+" close from state: "+this.state()),"closed"===this.state()?void(t&&t.apply(n)):"open"===this.state()?(this.state("closing"),void this._close(function(){o.state("closed"),t&&t.apply(n)})):"unloaded"===this.state()?void this.load(t,n,!0):"loading"===this.state()?(this._loadingAborted=!0,this.state("unloaded"),void(t&&t.apply(n))):"closing"===this.state()?void this.once("state:closed",function(){t&&t.apply(n)}):void this.open(function(){o.close(t,n,!0)},n,!0)},openSubviews:function(e){this._performMethodOnSubviews("open",e)},closeSubviews:function(e){this._performMethodOnSubviews("close",e)},loadSubviews:function(e){this._performMethodOnSubviews("load",e)},_load:function(e){e()},_open:function(e){this.openSubviews(e)},_close:function(e){this.closeSubviews(e)},_performMethodOnSubviews:function(e,t){var i=Object.keys(this.subviews);n.parallel(i.map(function(t){return this.subviews[t][e].bind(this.subviews[t])},this),t)},logEvent:function(e){i.sendUserActivity(e)}});return r.extend=function(i,n){var a=i.initialize,o=this;return i&&i.hasOwnProperty("initialize")&&e.isFunction(i.initialize)?i.initialize=function(){o.prototype.initialize.apply(this,arguments),a.apply(this,arguments)}:i.initialize=function(){o.prototype.initialize.apply(this,arguments)},i&&i.hasOwnProperty("mixins")&&e.isArray(i.mixins)&&e.each(i.mixins,function(t){e.each(t,function(e,t){if("initialize"===t){var n=i.initialize;i.initialize=function(){n.apply(this,arguments),e.apply(this,arguments)}}else i[t]=e})}),t.View.extend.call(this,i,n)},r.init=function(e){o=e},r}),function(e,t){"function"==typeof define&&define.amd?define("jquery.transit",["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(e.jQuery)}(this,function(e){function t(e){if(e in h.style)return e;for(var t=["Moz","Webkit","O","ms"],i=e.charAt(0).toUpperCase()+e.substr(1),n=0;n<t.length;++n){var a=t[n]+i;if(a in h.style)return a}}function i(){return h.style[d.transform]="",h.style[d.transform]="rotateY(90deg)",""!==h.style[d.transform]}function n(e){return"string"==typeof e&&this.parse(e),this}function a(e,t,i){t===!0?e.queue(i):t?e.queue(t,i):e.each(function(){i.call(this)})}function o(t){var i=[];return e.each(t,function(t){t=e.camelCase(t),t=e.transit.propertyMap[t]||e.cssProps[t]||t,t=l(t),d[t]&&(t=l(d[t])),-1===e.inArray(t,i)&&i.push(t)}),i}function r(t,i,n,a){var r=o(t);e.cssEase[n]&&(n=e.cssEase[n]);var s=""+u(i)+" "+n;parseInt(a,10)>0&&(s+=" "+u(a));var l=[];return e.each(r,function(e,t){l.push(t+" "+s)}),l.join(", ")}function s(t,i){i||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=d.transform,e.cssHooks[t]={get:function(i){var n=e(i).css("transit:transform");return n.get(t)},set:function(i,n){var a=e(i).css("transit:transform");a.setFromString(t,n),e(i).css({"transit:transform":a})}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function c(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function u(t){var i=t;return"string"!=typeof i||i.match(/^[\-0-9\.]+/)||(i=e.fx.speeds[i]||e.fx.speeds._default),c(i,"ms")}e.transit={version:"0.9.12",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var h=document.createElement("div"),d={},p=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;d.transition=t("transition"),d.transitionDelay=t("transitionDelay"),d.transform=t("transform"),d.transformOrigin=t("transformOrigin"),d.filter=t("Filter"),d.transform3d=i();var f={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},m=d.transitionEnd=f[d.transition]||null;for(var v in d)d.hasOwnProperty(v)&&"undefined"==typeof e.support[v]&&(e.support[v]=d[v]);return h=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeInCubic:"cubic-bezier(.550,.055,.675,.190)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new n},set:function(t,i){var a=i;a instanceof n||(a=new n(a)),"WebkitTransform"!==d.transform||p?t.style[d.transform]=a.toString():t.style[d.transform]=a.toString(!0),e(t).data("transform",a)}},e.cssHooks.transform={set:e.cssHooks["transit:transform"].set},e.cssHooks.filter={get:function(e){return e.style[d.filter]},set:function(e,t){e.style[d.filter]=t}},e.fn.jquery<"1.8"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[d.transformOrigin]},set:function(e,t){e.style[d.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[d.transition]},set:function(e,t){e.style[d.transition]=t}}),s("scale"),s("scaleX"),s("scaleY"),s("translate"),s("rotate"),s("rotateX"),s("rotateY"),s("rotate3d"),s("perspective"),s("skewX"),s("skewY"),s("x",!0),s("y",!0),n.prototype={setFromString:function(e,t){var i="string"==typeof t?t.split(","):t.constructor===Array?t:[t];i.unshift(e),n.prototype.set.apply(this,i)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=c(e,"deg")},rotateX:function(e){this.rotateX=c(e,"deg")},rotateY:function(e){this.rotateY=c(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=c(e,"deg")},skewY:function(e){this.skewY=c(e,"deg")},perspective:function(e){this.perspective=c(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&void 0!==e&&(this._translateX=c(e,"px")),null!==t&&void 0!==t&&(this._translateY=c(t,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;3>=t;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=c(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,i,n){t.setFromString(i,n)})},toString:function(e){var t=[];for(var i in this)if(this.hasOwnProperty(i)){if(!d.transform3d&&("rotateX"===i||"rotateY"===i||"perspective"===i||"transformOrigin"===i))continue;"_"!==i[0]&&(e&&"scale"===i?t.push(i+"3d("+this[i]+",1)"):e&&"translate"===i?t.push(i+"3d("+this[i]+",0)"):t.push(i+"("+this[i]+")"))}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,i,n,o){var s=this,l=0,c=!0,h=e.extend(!0,{},t);"function"==typeof i&&(o=i,i=void 0),"object"==typeof i&&(n=i.easing,l=i.delay||0,c="undefined"==typeof i.queue?!0:i.queue,o=i.complete,i=i.duration),"function"==typeof n&&(o=n,n=void 0),"undefined"!=typeof h.easing&&(n=h.easing,delete h.easing),"undefined"!=typeof h.duration&&(i=h.duration,delete h.duration),"undefined"!=typeof h.complete&&(o=h.complete,delete h.complete),"undefined"!=typeof h.queue&&(c=h.queue,delete h.queue),"undefined"!=typeof h.delay&&(l=h.delay,delete h.delay),"undefined"==typeof i&&(i=e.fx.speeds._default),"undefined"==typeof n&&(n=e.cssEase._default),i=u(i);var p=r(h,i,n,l),f=e.transit.enabled&&d.transition,v=f?parseInt(i,10)+parseInt(l,10):0;if(0===v){var g=function(e){s.css(h),o&&o.apply(s),e&&e()};return a(s,c,g),s}var y={},b=function(t){var i=!1,n=function(){i&&s.unbind(m,n),v>0&&s.each(function(){this.style[d.transition]=y[this]||null}),"function"==typeof o&&o.apply(s),"function"==typeof t&&t()};v>0&&m&&e.transit.useTransitionEnd?(i=!0,s.bind(m,n)):window.setTimeout(n,v),s.each(function(){v>0&&(this.style[d.transition]=p),e(this).css(h)})},w=function(e){this.offsetWidth,b(e)};return a(s,c,w),this},e.transit.getTransitionValue=r,e}),define("framework/utils/transition",["underscore","framework/utils/async","jquery.transit"],function(e,t){"use strict";function i(e,t,n,a){var o=n.name;i[o](e,t,n,a)}return e.extend(i,{none:function(e,t,i,n){n()},slide:function(e,i,n,a){var o,r,s,l=n.direction||"left",c=n.duration||400,u=(n.reverse||!1,0),h=0,d={},p={};"left"===l||"right"===l?o="left":("up"===l||"down"===l)&&(o="top"),"left"===l||"up"===l?(r="-100%",s="100%"):("right"===l||"down"===l)&&(r="100%",s="-100%"),d[o]=r,p[o]=h,e.css(o,u),i.css(o,s),t.parallel([function(t){e.animate(d,c,t)},function(e){i.animate(p,c,e)}],a)},"slide-css":function(e,t,i,n){var a,o,r,s=i.direction||"left",l=(i.duration||400,i.reverse||!1,0),c=0,u={},h={};"left"===s||"right"===s?a="x":("up"===s||"down"===s)&&(a="y"),"left"===s||"up"===s?(o="-100%",r="100%"):("right"===s||"down"===s)&&(o="100%",r="-100%"),u[a]=o,h[a]=c,e.css(a,l),t.css(a,r),e.transition(u,_callback),t.transition(h,_callback)},fade:function(e,t,i,n){var a=!1,o=function(){a&&n?n():a=!0},r=i.duration||200;e.css("opacity",1),t.css("opacity",0),e.animate({opacity:0},{duration:r,complete:o}),t.animate({opacity:1},{duration:r,complete:o})},scale:function(e,t,i,n){t.css({scale:.1,opacity:0}).transition({scale:1,opacity:1},n)}}),i}),define("framework/Container",["underscore","framework/View","framework/utils/transition","framework/utils/log"],function(e,t,i,n){"use strict";return t.extend({className:"container",initialize:function(t){n.trace(e.result(this,"id")+" initialize"),t=t||{},this.transitionOptions=t.transitionOptions||this.transitionOptions||"none",this._locked=!1,this._queue=[]},prepareView:function(e){e.$el.addClass("container-item")},show:function(t,i,n){e.isFunction(i)&&(n=i,i=void 0),i=i||this.transitionOptions,e.isString(i)&&(i={name:i}),n=n||i.complete,this._queue[0]={view:t,transitionOptions:i,done:n},this._locked||(this._locked=!0,this._next())},_next:function(){var e=this._queue.shift(),t=this;return e?void this._show(e.view,e.transitionOptions,function(){e.done&&e.done(),t._next()}):void(this._locked=!1)},_show:function(e,t,a){function o(){i(r.currentView.$el,e.$el,t,function(){t.beforeDetach&&t.beforeDetach(),r.currentView.$el.detach(),r.currentView=e,r.currentView.open(a)})}n.trace("Showing view "+e.id());var r=this;return this.currentView===e?(n.trace("Showing view which is already shown"),a&&a(),this):(this.prepareView(e),this.$el.append(e.$el),this.currentView?(this.currentView.close(function(){e._rendered?o():"unloaded"===e.state()?e.load(function(){e.render(),e._rendered=!0,o()}):(e.render(),e._rendered=!0,o())}),this):(this.currentView=e,e.open(a),this))}})}),define("framework/Viewport",["framework/Container","framework/utils/log"],function(e,t){"use strict";return e.extend({className:"viewport",events:{mousedown:"touch"},transition:"slide",initialize:function(){t.trace("Viewport initialized"),this.modal=null,this.message=null,this.onMessageMousedown=this.onMessageMousedown.bind(this)},onMessageMousedown:function(e){this.trigger("touch"),e.stopPropagation()},showMessage:function(e,t){function i(){n.message=e,e.$el.on("mousedown",n.onMessageMousedown).appendTo(n.$el),n.currentView.$el.addClass("blockElement"),e.open(t)}var n=this;this.message?this.hideMessage(i):i()},hideMessage:function(e){var t=this;return this.message?void this.message.close(function(){t.message.$el.off("mousedown",t.onMessageMousedown),t.message.$el.detach(),t.modal||t.currentView.$el.removeClass("blockElement"),e&&e()}):void(e&&(t.currentView.$el.removeClass("blockElement"),e()))},showModal:function(e,t){var i=this;this.modal&&this.hideModal(),e.$el.on("mousedown",function(e){i.trigger("touch"),e.stopPropagation()}).appendTo(this.$el),e.open(t),this.modal=e},hideModal:function(e){var t=this.modal;this.modal=null,t&&t.close(function(){t.$el.detach(),e&&e()}),this.$(".main-screen-content .view.container").css("display","block").animate({opacity:1})},touch:function(){this.hideModal(),this.trigger("touch")}})}),define("framework/utils/milliseconds",[],function(){"use strict";var e,t,i,n,a=function(e){var n;for(n in e)e.hasOwnProperty(n)&&(a[n]=e[n]);return i(),t};return a.ms=a.millisecond=a.milliseconds=a[""]=1,a.s=a.sec=a.second=a.seconds=1e3*a.ms,a.m=a.min=a.minute=a.minutes=60*a.s,a.h=a.hour=a.hours=60*a.m,a.d=a.day=a.days=24*a.h,a.w=a.week=a.weeks=7*a.d,n=function(e){var t,i="",n=function(e){for(var t=e.toString(16),i=4-t.length;i>0;)t="0"+t,i-=1;return t};for(t=0;t<e.length;t+=1)i+="\\u"+n(e.charCodeAt(t));return i},i=function(){var t,i="((?:(?:\\d+)?.\\d+)|(?:\\d+)) *(";for(t in a)a.hasOwnProperty(t)&&""!==t&&(i+=n(t)+"|");i=i.slice(0,-1),"undefined"!==a[""]&&(i+="|"),i+=")",e=new RegExp(i,"gi")},i(),t=function(t){var i,n=!0,o=0;if("number"==typeof t)return t;if("string"==typeof t){for(i=e.exec(t);i;)n=!1,o+=parseFloat(i[1])*a[i[2]],i=e.exec(t);return n?NaN:o}return NaN},t.config=a,t}),define("framework/utils/i18n",[],function(){"use strict";var e,t=function(t){return e.config("dictionaries")[e.lang()][t]||t};return t.init=function(t){e=t},t}),define("framework/utils/ticketBackend",[],function(){"use strict";var e,t=function(t,i){var n=e.config("ticketBackend");return void 0===t?n:("/"===t.charAt(0)&&(t=t.slice(1)),i=i?i:"",n+"/"+i+t)};return t.init=function(t){e=t},t}),define("framework/utils/keyboard",["jquery","underscore"],function(e,t){"use strict";var i={layouts:{ru:[[1,2,3,4,5,6,7,8,9,0,"backspace"],["й","ц","у","к","е","н","г","ш","щ","з","х","ъ"],["ф","ы","в","а","п","р","о","л","д","ж","э","ё","search"],["я","ч","с","м","и","т","ь","б","ю","hide","layout"],["space"]],en:[[1,2,3,4,5,6,7,8,9,0,"backspace"],["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","search"],["z","x","c","v","b","n","m","#","hide","layout"],["-","_","space","@","."]]},defaultLayout:"ru",offset:100,buttons:{hide:{cls:"keyboard-button-hide",action:function(){i.hide()},display:function(e){return"ru"===e?"скрыть":"hide"}},space:{cls:"keyboard-button-space",type:" ",display:" "},backspace:{cls:"keyboard-button-backspace",action:function(){var e=i.$input.val();e.length>0&&i.$input.val(e.slice(0,-1)).change(),i.placeCursor()},display:"←"},number:{action:function(e){if(isNaN(e))if("backspace"===e)e="";else{if("hide"!==e)return;i.hide()}var t=i.buttons.number,n=i.$input.val().replace(/\D/g,"").slice(1,e?12:-1);n.length;i.$input.val(t.applyMask(n+e)).change(),i.placeCursor()},applyMask:function(e){return console.log(e),"+7 "+e.replace(/(\d{3})(\d{3}){0,1}(\d{2}){0,1}(\d{2}){0,1}/,"($1) $2 $3 $4").slice(0,15).replace(/\s*$/g,"")}},layout:{cls:"keyboard-button-layout",action:function(e){var t="ru"===i.currentLayout?"en":"ru";i.layout(""+e.match(/en|ru/)=="null"?t:e)},display:"eng/рус"},search:{cls:"keyboard-button-search",action:function(){},display:function(e){return"ru"===e?"поиск":"search"}}},selector:"input[type=text], input[type=tel]",init:function(t){this.$el=this.createKeyboard(),this.cacheLayouts(),this.layout(this.defaultLayout),t.append(this.$el).on("focusin",this.selector,function(t){i.$input=e(this),i.$input.on("focusout",function(){i.hide()}),i.show(t.target)})},cacheLayouts:function(){var e,t;this.cachedLayouts={};for(e in this.layouts)this.layouts.hasOwnProperty(e)&&(t=this.layouts[e],this.cachedLayouts[e]=this.createLayout(t,e))},createButton:function(t,i){var n,a=this.buttons[t]||{},o=a.display;return o||(o=t),"function"==typeof o&&(o=o(i)),n=e('<button class="keyboard-button"></button>').attr("data-action",t).text(o),a.cls&&n.addClass(a.cls),n},createRow:function(n,a){var o=e('<div class="keyboard-row"></div>');return t.each(n,function(e){o.append(i.createButton(e,a))}),o},createLayout:function(n,a){var o=e('<div class="keyboard-layout"></div>');return t.each(n,function(e){o.append(i.createRow(e,a))}),o},createKeyboard:function(){var t=e('<div class="keyboard keyboard-hidden"></div>');return t.on("click",".keyboard-button",function(t){var n=e(t.target).attr("data-action");i.processKey(n)}).on("mousedown",function(e){e.preventDefault()}),t},processKey:function(e){console.log();var t=("tel"===this.$input.attr("type")?this.buttons.number:0)||this.buttons[e]||{},n=t.type||e,a=t.action||function(){i.type(n)};a(e)},type:function(e){var t=this.$input.val();this.$input.val(t+e).change(),this.placeCursor()},placeCursor:function(e){var t=e||this.$input.val().length;this.$input[0].selectionStart=this.$input[0].selectionEnd=t},show:function(t){switch(this.$input=e(t),t.className){case"email-input":this.buttons.layout.action("en");break;case"credentials-input":this.buttons.layout.action("ru")}var i=this.$input.offset().top;this.$el.removeClass("keyboard-hidden").addClass("keyboard-visible").css("top",i+this.offset)},hide:function(){this.$input&&(this.$input[0].blur(),this.$input=null),this.$el.removeClass("keyboard-visible").addClass("keyboard-hidden")},layout:function(e){var t=this.cachedLayouts[e],i=this;i.$el.empty().append(t),this.currentLayout=e}};return i}),function(e){"use strict";function t(){this.node=document.createElement("span"),this.node.classList.add("_phantom-limb_finger"),document.body.appendChild(this.node)}function i(e,t,i){var n=document.createEvent("MouseEvent");return n.initMouseEvent(e,!0,!0,t.view,t.detail,i.x||t.screenX,i.y||t.screenY,i.x||t.clientX,i.y||t.clientY,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey,t.button,i.target||t.relatedTarget),n.synthetic=!0,n._finger=i,n}function n(t,n){var a=[],o=[];if(p.forEach(function(o){if(o.target){var r="on"+t;if(r in o.target&&(console.warn("Converting `"+r+"` property to event listener.",o.target),o.target.addEventListener(t,o.target[r],!1),delete o.target[r]),o.target.hasAttribute(r)){console.warn("Converting `"+r+"` attribute to event listener.",o.target);var s=new e.Function("event",o.target.getAttribute(r));o.target.addEventListener(t,s,!1),o.target.removeAttribute(r)}var l=i(t,n,o);a.push(l)}}),a.length>1){var r=a[0].pageX-a[1].pageX,s=a[0].pageY-a[1].pageY,l=Math.sqrt(Math.pow(r,2)+Math.pow(s,2)),c=Math.atan2(r,s)*(180/Math.PI),u="gesturechange";"touchstart"===t&&(u="gesturestart",f=l,m=c),"touchend"===t&&(u="gestureend"),a.forEach(function(e){var t=i(u,e,e._finger);o.push(t)}),a.concat(o).forEach(function(e){e.scale=l/f,e.rotation=m-c})}a.forEach(function(e){e.touches=a.filter(function(e){return~e.type.indexOf("touch")&&"touchend"!==e.type}),e.changedTouches=a.filter(function(t){return~t.type.indexOf("touch")&&t._finger.target===e._finger.target}),e.targetTouches=e.changedTouches.filter(function(e){return~e.type.indexOf("touch")&&"touchend"!==e.type})}),a.concat(o).forEach(function(e,t){e.identifier=t,e._finger.target.dispatchEvent(e)})}function a(e){e.synthetic||(d=!0,n("touchstart",e))}function o(e){var t=e.clientX-p[0].x||0,i=e.clientY-p[0].y||0;if(p[0].move(e.clientX,e.clientY),e.altKey){v||g||(v=window.innerWidth/2,g=window.innerHeight/2),e.shiftKey&&(v+=t,g+=i);var n=v+(v-e.clientX),a=g+(g-e.clientY);p[1].move(n,a)}else p[1].move(NaN,NaN),v=NaN,g=NaN}function r(e){e.synthetic||(o(e),d&&n("touchmove",e))}function s(e){e.synthetic||(d=!1,n("touchend",e),p.forEach(function(t){t.target&&(t.target.dispatchEvent(i("mouseover",e,t)),t.target.dispatchEvent(i("mousemove",e,t)),t.target.dispatchEvent(i("mousedown",e,t)),t.target.dispatchEvent(i("mouseup",e,t)),t.target.dispatchEvent(i("click",e,t)))}))}function l(e){e.synthetic||(e.preventDefault(),e.stopPropagation())}function c(){document.addEventListener("mousedown",a,!0),document.addEventListener("mousemove",r,!0),document.addEventListener("mouseup",s,!0),document.addEventListener("click",l,!0),document.documentElement.classList.add("_phantom-limb")}var u={style:!0,startOnLoad:!0};for(var h in e.phantomLimbConfig)u[h]=e.phantomLimbConfig[h];var d=!1;t.prototype={node:null,x:NaN,y:NaN,target:null,place:function(){document.body.appendChild(this.node)},hide:function(){this.node.style.display="none"},show:function(){this.node.style.display=""},move:function(e,t){isNaN(e)||isNaN(t)?(this.hide(),this.target=null):(this.show(),this.node.style.left=e+"px",this.node.style.top=t+"px",this.x=e,this.y=t,d||(this.target=document.elementFromPoint(e,t)))}};var p=[new t,new t],f=NaN,m=NaN,v=NaN,g=NaN;u.startOnLoad&&c()}(this),define("framework/utils/phantom-limb",function(){}),define("framework/Application",["jquery","underscore","backbone","kiosk-session-manager","framework/Viewport","framework/View","framework/utils/milliseconds","framework/utils/backend","framework/utils/i18n","framework/utils/log","framework/utils/ticketBackend","framework/utils/keyboard","framework/utils/phantom-limb"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";var d,p=function(e){var i,a=this;t.extend(this._config={},e),this._lang=this.config("defaultLanguage"),this.screens={},s.init(this),u.init(this),l.init(this),o.init(this),i=this.sessionManager=new n({timeout:r(this.config("sessionTimeout"))}),i.on("start",function(){a.trigger("session:start"),c.event("session:start"),c.info("session start")}),i.on("end",function(){a.trigger("session:end"),a.router.navigate("",{trigger:!0}),a.lang(a.config("defaultLanguage")),a.viewport.hideModal(),a.viewport.hideMessage(),c.event("session:end"),c.info("session end")}),i.on("reset",function(){c.info("session reset"),c.info(i.session.left())}),this._defers=1,d=this},f=i.Router.extend({routes:{"":"process",":screen":"process",":screen/*route":"process"},process:function(e,t){d.route(e,t)}});return t.extend(p.prototype,{addScreens:function(e){return t.each(e,function(e){e.render()}),t.extend(this.screens,e),this},config:function(e){return void 0===e?this._config:this._config[e]},lang:function(e){return void 0===e?this._lang:this._lang===e?e:(this._lang=e,this.trigger("application:languagechange",{language:e}),c.event("language:change",{language:e}),e)},start:function(){this.advanceReadiness()},deferReadiness:function(e){"number"!=typeof e&&(e=1),this._defers++},advanceReadiness:function(){return this._defers&&this._defers--,this._defers?void 0:(this.viewport=(new a).render(),e("body").append(this.viewport.$el),h.init(this.viewport.$el),this.viewport.on("touch",function(){d.sessionManager.session?d.sessionManager.session.reset():d.sessionManager.startSession()}),this.router=new f,i.history.start(),this.trigger("start"),this)},route:function(e,t){void 0===e&&(e=this.config("defaultScreen")),void 0===t&&(t=""),c.info('Route "'+t+'" of screen "'+e+'" will be processed'),this.viewport.show(this.screens[e]),this.screens[e].route(t)},navigate:function(e){this.router.navigate(e,{trigger:!0})}},i.Events),i._ajax=i.ajax,i.ajax=function(e){var t=e.data||{};return t.lang=d.lang(),e.data=t,i._ajax(e)},p}),define("framework/Screen",["underscore","backbone","framework/View","framework/utils/log"],function(e,t,i,n){"use strict";return i.extend({className:"screen",routes:{},initialize:function(){n.trace("Screen initialized"),this._routes=[],e.each(this.routes,function(e,i){this._routes.push({
regexp:t.Router.prototype._routeToRegExp(i),callback:e})},this)},route:function(i){var n,a;e.each(this._routes,function(e){e.regexp.test(i)&&(n=e.callback,a=t.Router.prototype._extractParameters(e.regexp,i))},this),this[n].apply(this,a)}})}),this.Handlebars={},function(e){e.VERSION="1.0.0-rc.3",e.COMPILER_REVISION=2,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:">= 1.0.0-rc.3"},e.helpers={},e.partials={},e.registerHelper=function(e,t,i){i&&(t.not=i),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return void 0;throw new Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,i="[object Function]";e.registerHelper("blockHelperMissing",function(n,a){var o=a.inverse||function(){},r=a.fn,s=t.call(n);return s===i&&(n=n.call(this)),n===!0?r(this):n===!1||null==n?o(this):"[object Array]"===s?n.length>0?e.helpers.each(n,a):o(this):r(n)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var i=new e.K;return e.K.prototype=null,i},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,i){if(e.logger.level<=t){var n=e.logger.methodMap[t];"undefined"!=typeof console&&console[n]&&console[n].call(console,i)}}},e.log=function(t,i){e.logger.log(t,i)},e.registerHelper("each",function(t,i){var n,a=i.fn,o=i.inverse,r=0,s="";if(i.data&&(n=e.createFrame(i.data)),t&&"object"==typeof t)if(t instanceof Array)for(var l=t.length;l>r;r++)n&&(n.index=r),s+=a(t[r],{data:n});else for(var c in t)t.hasOwnProperty(c)&&(n&&(n.key=c),s+=a(t[c],{data:n}),r++);return 0===r&&(s=o(this)),s}),e.registerHelper("if",function(n,a){var o=t.call(n);return o===i&&(n=n.call(this)),!n||e.Utils.isEmpty(n)?a.inverse(this):a.fn(this)}),e.registerHelper("unless",function(t,i){var n=i.fn,a=i.inverse;return i.fn=a,i.inverse=n,e.helpers["if"].call(this,t,i)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;e.log(n,t)})}(this.Handlebars);var e=["description","fileName","lineNumber","message","name","number","stack"];Handlebars.Exception=function(t){for(var i=Error.prototype.constructor.apply(this,arguments),n=0;n<e.length;n++)this[e[n]]=i[e[n]]},Handlebars.Exception.prototype=new Error,Handlebars.SafeString=function(e){this.string=e},Handlebars.SafeString.prototype.toString=function(){return this.string.toString()},function(){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},t=/[&<>"'`]/g,i=/[&<>"'`]/,n=function(t){return e[t]||"&amp;"};Handlebars.Utils={escapeExpression:function(e){return e instanceof Handlebars.SafeString?e.toString():null==e||e===!1?"":i.test(e)?e.replace(t,n):e},isEmpty:function(e){return e||0===e?"[object Array]"===Object.prototype.toString.call(e)&&0===e.length?!0:!1:!0}}}(),Handlebars.VM={template:function(e){var t={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(e,t,i){var n=this.programs[e];return i?Handlebars.VM.program(t,i):n?n:n=this.programs[e]=Handlebars.VM.program(t)},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop,compilerInfo:null};return function(i,n){n=n||{};var a=e.call(t,Handlebars,i,n.helpers,n.partials,n.data),o=t.compilerInfo||[],r=o[0]||1,s=Handlebars.COMPILER_REVISION;if(r!==s){if(s>r){var l=Handlebars.REVISION_CHANGES[s],c=Handlebars.REVISION_CHANGES[r];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+l+") or downgrade your runtime to an older version ("+c+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return a}},programWithDepth:function(e,t,i){var n=Array.prototype.slice.call(arguments,2);return function(i,a){return a=a||{},e.apply(this,[i,a.data||t].concat(n))}},program:function(e,t){return function(i,n){return n=n||{},e(i,n.data||t)}},noop:function(){return""},invokePartial:function(e,t,i,n,a,o){var r={helpers:n,partials:a,data:o};if(void 0===e)throw new Handlebars.Exception("The partial "+t+" could not be found");if(e instanceof Function)return e(i,r);if(Handlebars.compile)return a[t]=Handlebars.compile(e,{data:void 0!==o}),a[t](i,r);throw new Handlebars.Exception("The partial "+t+" could not be compiled when running in runtime-only mode")}},Handlebars.template=Handlebars.VM.template,define("handlebars",function(e){return function(){var t;return t||e.Handlebars}}(this)),define("framework/utils/handlebars",["handlebars","framework/utils/i18n","framework/utils/backend","framework/utils/ticketBackend"],function(e,t,i,n){"use strict";function a(e){var t=e.getMinutes();return(10>t?"0":"")+t}e.registerHelper("i18n",t),e.registerHelper("backend",i),e.registerHelper("ticketBackend",n),e.registerHelper("ticketFormatDate",function(e){var t=new Date(e),i=["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"];return t.getDate()+" "+i[t.getMonth()]+" "+t.getHours()+":"+a(t)}),e.registerHelper("equal",function(e,t,i){if(arguments.length<3)throw new Error("Handlebars Helper equal needs 2 parameters");return e!==t?i.inverse(this):i.fn(this)}),e.registerHelper("multiply",function(){var e=1;return Array.prototype.slice.call(arguments).forEach(function(t){isNaN(t)||(e*=t)}),e}),e.registerHelper("ticketsInclinations",function(e){return 1==e?"":e>=2&&4>=e?"а":"ов"}),e.registerHelper("findInHash",function(e,t){return e[t]}),e.registerHelper("paragraphize",function(t){if(t){var i=t.split("\n");return new e.SafeString("<p>"+i.join("</p><p>")+"</p>")}})}),define("templates/search-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var o,r,s="",l=i.helperMissing,c=this.escapeExpression;return s+='<form class="search-form">\n    <input type="text" placeholder="',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"Search",r):l.call(t,"i18n","Search",r)))+'..." readonly>\n</form>\n'})}),define("views/SearchView",["framework/View","templates/search-view"],function(e,t){"use strict";return e.extend({className:"search-view",i18n:!0,template:t,events:{"submit .search-form":"search"},initialize:function(){Firefly.on("session:end",this.clear,this)},afterRender:function(){this.$input=this.$("input")},search:function(e){e.preventDefault(),Firefly.navigate("main/search/"+encodeURI(this.$("input").val()))},hide:function(){this.$el.addClass("search-view-hidden")},show:function(){this.$el.removeClass("search-view-hidden")},clear:function(){this.$input.trigger("focusout"),this.$input.val("")}})}),define("templates/main-screen-widget-view-tab",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var o,r,s="",l=i.helperMissing,c=this.escapeExpression;return s+='<div class="main-screen-widget-view-tab">\n    <div class="main-screen-widget-view-tab-item main-screen-widget-view-tab-item-map" data-widget="map">\n    	<div>\n    		<i class="icon-map"></i>\n	    	',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"MAP",r):l.call(t,"i18n","MAP",r)))+'\n    	</div>\n    	\n    </div>\n    <div class="main-screen-widget-view-tab-item main-screen-widget-view-tab-item-weather" data-widget="weather">\n    	<div>\n    		<i class="icon-weather"></i>',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"WEATHER",r):l.call(t,"i18n","WEATHER",r)))+'\n    	</div>\n    	\n    </div>\n    <div class="main-screen-widget-view-tab-item main-screen-widget-view-tab-item-currency" data-widget="currency">\n    	<div>\n    		<i class="icon-currency"></i>',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"CURRENCY",r):l.call(t,"i18n","CURRENCY",r)))+'\n    	</div>\n    	\n    </div>\n    <div class="main-screen-widget-view-tab-item main-screen-widget-view-tab-item-language" data-widget="language">\n    	<div>\n    		<i class="icon-langs"></i>\n    	</div>\n    </div>\n</div>'})}),define("views/MainScreenWidgetViewTab",["jquery","framework/View","templates/main-screen-widget-view-tab"],function(e,t,i){"use strict";return t.extend({className:"main-screen-widget-view-tab",template:i,i18n:!0,events:{"click .main-screen-widget-view-tab-item":"onItemClicked"},initialize:function(){this.current=null},onItemClicked:function(t){var i=e(t.currentTarget).attr("data-widget");this.select(i)},select:function(e){this.current!==e&&(this.current=e,this.unhighlight(),this.highlight(e),this.trigger("select",e))},deselect:function(){this.unhighlight(),this.current=null},afterRender:function(){this.current&&this.highlight(this.current)},unhighlight:function(){this.$(".main-screen-widget-view-tab-item-highlighted").removeClass("main-screen-widget-view-tab-item-highlighted")},highlight:function(e){this.$(".main-screen-widget-view-tab-item-"+e).addClass("main-screen-widget-view-tab-item-highlighted")}})}),define("templates/language-widget-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{},'<div class="language-widget-view-item" data-lang="en">\n    <img class="language-widget-view-item-image" src="images/gb.png">\n    <span class="language-widget-view-item-title">English</span>\n</div>\n<div class="language-widget-view-item" data-lang="ru">\n    <img class="language-widget-view-item-image" src="images/rus.png">\n    <span class="language-widget-view-item-title">Русский</span>\n</div>\n<div class="language-widget-view-item" data-lang="de">\n    <img class="language-widget-view-item-image" src="images/ger.png">\n    <span class="language-widget-view-item-title">Deutsch</span>\n</div>\n'})}),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,i,n,a){return jQuery.easing[jQuery.easing.def](e,t,i,n,a)},easeInQuad:function(e,t,i,n,a){return n*(t/=a)*t+i},easeOutQuad:function(e,t,i,n,a){return-n*(t/=a)*(t-2)+i},easeInOutQuad:function(e,t,i,n,a){return(t/=a/2)<1?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,n,a){return n*(t/=a)*t*t+i},easeOutCubic:function(e,t,i,n,a){return n*((t=t/a-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,n,a){return(t/=a/2)<1?n/2*t*t*t+i:n/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,n,a){return n*(t/=a)*t*t*t+i},easeOutQuart:function(e,t,i,n,a){return-n*((t=t/a-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,n,a){return(t/=a/2)<1?n/2*t*t*t*t+i:-n/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,n,a){return n*(t/=a)*t*t*t*t+i},easeOutQuint:function(e,t,i,n,a){return n*((t=t/a-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,n,a){return(t/=a/2)<1?n/2*t*t*t*t*t+i:n/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,n,a){return-n*Math.cos(t/a*(Math.PI/2))+n+i},easeOutSine:function(e,t,i,n,a){return n*Math.sin(t/a*(Math.PI/2))+i},easeInOutSine:function(e,t,i,n,a){return-n/2*(Math.cos(Math.PI*t/a)-1)+i},easeInExpo:function(e,t,i,n,a){return 0==t?i:n*Math.pow(2,10*(t/a-1))+i},easeOutExpo:function(e,t,i,n,a){return t==a?i+n:n*(-Math.pow(2,-10*t/a)+1)+i},easeInOutExpo:function(e,t,i,n,a){return 0==t?i:t==a?i+n:(t/=a/2)<1?n/2*Math.pow(2,10*(t-1))+i:n/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(e,t,i,n,a){return-n*(Math.sqrt(1-(t/=a)*t)-1)+i},easeOutCirc:function(e,t,i,n,a){return n*Math.sqrt(1-(t=t/a-1)*t)+i},easeInOutCirc:function(e,t,i,n,a){return(t/=a/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+i:n/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,n,a){var o=1.70158,r=0,s=n;if(0==t)return i;if(1==(t/=a))return i+n;if(r||(r=.3*a),s<Math.abs(n)){s=n;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(n/s);return-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*a-o)*Math.PI/r))+i},easeOutElastic:function(e,t,i,n,a){var o=1.70158,r=0,s=n;if(0==t)return i;if(1==(t/=a))return i+n;if(r||(r=.3*a),s<Math.abs(n)){s=n;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(n/s);return s*Math.pow(2,-10*t)*Math.sin(2*(t*a-o)*Math.PI/r)+n+i},easeInOutElastic:function(e,t,i,n,a){var o=1.70158,r=0,s=n;if(0==t)return i;if(2==(t/=a/2))return i+n;if(r||(r=.3*a*1.5),s<Math.abs(n)){s=n;var o=r/4}else var o=r/(2*Math.PI)*Math.asin(n/s);return 1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*a-o)*Math.PI/r)+i:s*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*a-o)*Math.PI/r)*.5+n+i},easeInBack:function(e,t,i,n,a,o){return void 0==o&&(o=1.70158),n*(t/=a)*t*((o+1)*t-o)+i},easeOutBack:function(e,t,i,n,a,o){return void 0==o&&(o=1.70158),n*((t=t/a-1)*t*((o+1)*t+o)+1)+i},easeInOutBack:function(e,t,i,n,a,o){return void 0==o&&(o=1.70158),(t/=a/2)<1?n/2*t*t*(((o*=1.525)+1)*t-o)+i:n/2*((t-=2)*t*(((o*=1.525)+1)*t+o)+2)+i},easeInBounce:function(e,t,i,n,a){return n-jQuery.easing.easeOutBounce(e,a-t,0,n,a)+i},easeOutBounce:function(e,t,i,n,a){return(t/=a)<1/2.75?7.5625*n*t*t+i:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+i:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+i:n*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(e,t,i,n,a){return a/2>t?.5*jQuery.easing.easeInBounce(e,2*t,0,n,a)+i:.5*jQuery.easing.easeOutBounce(e,2*t-a,0,n,a)+.5*n+i}}),define("jquery.easing",["jquery"],function(){}),define("views/LanguageWidgetView",["jquery","framework/View","templates/language-widget-view","framework/utils/log","jquery.easing"],function(e,t,i,n){"use strict";return t.extend({className:"language-widget-view",template:i,i18n:!0,events:{"click .language-widget-view-item":"onItemClicked"},onItemClicked:function(e){n.trace("Language item clicked")},afterRender:function(){var t=this.$(".language-widget-view-item");e(t[1]).css("z-index",100),t.css({left:471,opacity:0}),this.delegateEvents()},_open:function(t){var i=this.$(".language-widget-view-item"),n=0,a=400,o=function(){1===n&&t(),n+=1};e(i).animate({opacity:1},{duration:100}),e(i[0]).animate({left:"-=230"},{complete:o,duration:a,easing:"easeOutBounce"}),e(i[2]).animate({left:"+=230",opacity:1},{complete:o,duration:a,easing:"easeOutBounce"})},_close:function(t){var i=this.$(".language-widget-view-item");e(i).animate({opacity:0,left:450},{duration:300}).promise().done(t)}})}),define("templates/currency-widget-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var o,r,s="",l="function",c=this.escapeExpression,u=i.helperMissing;return s+='<table class="currency-widget-view-table">\n    <tr>\n        <td>\n            <div>\n                <span>'+c((o=t[0],o=null==o||o===!1?o:o.sign,typeof o===l?o.apply(t):o))+"</span>\n            </div>\n        </td>\n        <td>\n        </td>\n        <td>\n            <div>\n                <span>"+c((o=t[1],o=null==o||o===!1?o:o.sign,typeof o===l?o.apply(t):o))+"</span>\n            </div>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            "+c((o=t[0],o=null==o||o===!1?o:o.buy,typeof o===l?o.apply(t):o))+"\n        </td>\n        <td>\n            ",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"BUY",r):u.call(t,"i18n","BUY",r)))+"\n        </td>\n        <td>\n            "+c((o=t[1],o=null==o||o===!1?o:o.buy,typeof o===l?o.apply(t):o))+"\n        </td>\n    </tr>\n    <tr>\n        <td>\n            "+c((o=t[0],o=null==o||o===!1?o:o.sell,typeof o===l?o.apply(t):o))+"\n        </td>\n        <td>\n            ",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"SELL",r):u.call(t,"i18n","SELL",r)))+"\n        </td>\n        <td>\n            "+c((o=t[1],o=null==o||o===!1?o:o.sell,typeof o===l?o.apply(t):o))+"\n        </td>\n    </tr>\n</table>"})}),define("views/CurrencyWidgetView",["framework/View","templates/currency-widget-view"],function(e,t){"use strict";return e.extend({className:"currency-widget-view",template:t,i18n:!0,initialize:function(){this.$el.css("opacity",0)},data:function(){return[{name:"dollar",sign:"$",buy:"65,13",sell:"65,71"},{name:"euro",sign:"€",buy:"69,10",sell:"70,35"}]},_open:function(e){this.$el.animate({opacity:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0},{complete:e})}})}),define("templates/modal-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var o,r,s="",l=i.helperMissing,c=this.escapeExpression;return s+='<div class="modal-view-tab-bar">\n    <div class="modal-view-tab-bar-item modal-view-tab-bar-item-city">\n        ',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"CITY MAP",r):l.call(t,"i18n","CITY MAP",r)))+'\n    </div>\n    <div class="modal-view-tab-bar-item modal-view-tab-bar-item-metro">\n        ',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"METRO MAP",r):l.call(t,"i18n","METRO MAP",r)))+'\n    </div>\n</div>\n<div class="modal-view-container">\n</div>'})}),define("views/ModalView",["framework/View","framework/Container","templates/modal-view"],function(e,t,i){"use strict";return e.extend({className:"modal-view",template:i,regions:{content:".modal-view-container"},subviews:{container:t},layout:{content:"container"},events:{"click .modal-view-tab-bar-item-city":"city","click .modal-view-tab-bar-item-metro":"metro"},initialize:function(e){this._map=e.map,this._metro=e.metro},afterRender:function(){this.$el.css({opacity:0}),this.current&&this.select(this.current)},_open:function(e){this.$el.animate({opacity:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0},{complete:e})},city:function(){return"city"!==this.current&&(this.select("city"),this.subviews.container.show(this._map),this.current="city"),this},metro:function(){return"metro"!==this.current&&(this.select("metro"),this.subviews.container.show(this._metro),this.current="metro"),this},select:function(e){this.current&&this.$(".modal-view-tab-bar-item-"+this.current).removeClass("modal-view-tab-bar-item-selected"),this.$(".modal-view-tab-bar-item-"+e).addClass("modal-view-tab-bar-item-selected")}})}),define("templates/metro-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+='\n    <div id="imageContainer">\n        <img id="metroimage" src= ',(n=i.metroImage)?n=n.call(e,{hash:{},data:t}):(n=e.metroImage,n=typeof n===c?n.apply(e):n),a+=u(n)+"/>\n    </div>\n"}function r(e,t){return'\n    <iframe src="metromap/index.htm" width="100%" height="100%" scrolling="no"></iframe>\n'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var s,l="",c="function",u=this.escapeExpression,h=this;return s=i["if"].call(t,t.metroImage,{hash:{},inverse:h.program(3,r,a),fn:h.program(1,o,a),data:a}),(s||0===s)&&(l+=s),l+="\n\n\n\n\n\n\n"})}),define("views/MetroView",["jquery","framework/View","templates/metro-view"],function(e,t,i){"use strict";return t.extend({template:i,afterRender:function(){this.$("iframe").load(function(){e(this).contents().on("mousedown",function(){window.Firefly.viewport.trigger("touch")})})}})}),define("models/Location",["backbone","framework/utils/backend"],function(e,t){"use strict";return e.Model.extend({})}),define("models/City",["backbone","framework/utils/backend"],function(e,t){"use strict";return e.Model.extend({urlRoot:function(){return t("city")}})}),define("framework/utils/leaflet",["leaflet"],function(e){"use strict";var t={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(t){var i=e.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,a=Math.max(Math.min(n,t.lat),-n),o=this.R_MAJOR,r=this.R_MINOR,s=t.lng*i*o,l=a*i,c=r/o,u=Math.sqrt(1-c*c),h=u*Math.sin(l);h=Math.pow((1-h)/(1+h),.5*u);var d=Math.tan(.5*(.5*Math.PI-l))/h;return l=-r*Math.log(d),new e.Point(s,l)},unproject:function(t){for(var i,n=e.LatLng.RAD_TO_DEG,a=this.R_MAJOR,o=this.R_MINOR,r=t.x*n/a,s=o/a,l=Math.sqrt(1-s*s),c=Math.exp(-t.y/o),u=Math.PI/2-2*Math.atan(c),h=15,d=1e-7,p=h,f=.1;Math.abs(f)>d&&--p>0;)i=l*Math.sin(u),f=Math.PI/2-2*Math.atan(c*Math.pow((1-i)/(1+i),.5*l))-u,u+=f;return new e.LatLng(u*n,r)}},i=e.extend({},e.CRS,{code:"EPSG:3395",projection:t,transformation:function(){var i=t,n=i.R_MAJOR,a=i.R_MINOR;return new e.Transformation(.5/(Math.PI*n),.5,-.5/(Math.PI*a),.5)}()});return{YANDEX_EPSG3395:i}}),define("views/MapView",["underscore","jquery","leaflet","framework/View","views/ModalView","views/MetroView","models/Location","models/City","framework/utils/backend","framework/utils/leaflet"],function(e,t,i,n,a,o,r,s,l,c){"use strict";var u,h=new r,d=new s,p={en:i.icon({iconUrl:"/images/marker_en.png",iconSize:[145,101],iconAnchor:[42,80]}),ru:i.icon({iconUrl:"/images/marker_ru.png",iconSize:[145,101],iconAnchor:[42,80]}),de:i.icon({iconUrl:"/images/marker_de.png",iconSize:[145,101],iconAnchor:[42,80]})};return u=n.extend({className:"map-view",i18n:!0,events:{"click .zoom-in-btn":"zoomIn","click .zoom-out-btn":"zoomOut","click .traffic-btn":"toggleTraffic","click .open-btn":"showLargeMap","click .metro-btn":"showMetro","click .close-btn":"triggerClose"},initialize:function(e){e=e||{},this.$el.css("opacity",0),this.layers={yandex:i.tileLayer("http://vec04.maps.yandex.net/tiles?l=map&v=2.42.0&x={x}&y={y}&z={z}&lang=ru_RU")},this.marks={locations:[]},e&&e.hasOwnProperty("close")||(this.options.close=!1),this.map=new i.Map(this.el,{crs:c.YANDEX_EPSG3395,layers:[this.layers.yandex],center:new i.LatLng(52.603584,39.596017),zoom:11,zoomControl:!1,attributionControl:!1,keyboard:!1,touchZoom:!1}),this.map.on("mousedown",function(){window.Firefly.viewport.trigger("touch")}),this._attribution=i.control.attribution({position:"bottomleft",prefix:!1}),this._attribution.addTo(this.map),e.large||(this.metro=new o,this.large=new u({large:!0}),this.large.on("close",function(){window.Firefly.viewport.hideModal()})),setTimeout(function(){h.set({address:"address",latitude:52.603584,longitude:39.596017})},100),this.listenTo(h,"change",this.addKioskMarker),this.listenTo(d,"change",this.initMapCenter),this.listenTo(window.Firefly,"session:end",this.initMapCenter),this.listenTo(window.Firefly,"map:locations:product",this.updateLocations),this.listenTo(window.Firefly,"map:locations:category",this.updateLocations),this.listenTo(window.Firefly,"map:locations:ticket",this.showTicketLocation),this.listenTo(window.Firefly,"map:locations:clear",this.clearLocations)},initMapCenter:function(){var e=11,t=d.get("latitude"),n=d.get("longitude");t&&n&&this.map.setView(new i.LatLng(t,n),e)},afterRender:function(){this._init||(this.addControls(),this._init=!0);var e=this.map;this.$el.on("DOMNodeInsertedIntoDocument",function(t){t.target===t.currentTarget&&e.invalidateSize()}),this.addKioskMarker()},addKioskMarker:function(){this.marks.kiosk&&this.map.removeLayer(this.marks.kiosk),h.get("latitude")&&h.get("longitude")&&(this.marks.kiosk=i.marker([h.get("latitude"),h.get("longitude")],{icon:p[window.Firefly.lang()]}).addTo(this.map))},clearLocations:function(){var t=this.map;e.each(this.marks.locations,function(e){t.removeLayer(e)})},updateLocations:function(t){this.clearLocations(),e.each(t,function(e){this.marks.locations.push(i.marker([e.latitude,e.longitude]).addTo(this.map))},this),t.length>0&&this.map.panTo(new i.LatLng(t[0].latitude,t[0].longitude))},showTicketLocation:function(e){this.clearLocations(),this.marks.locations.push(i.marker(e).addTo(this.map)),this.map.panTo(e)},addControls:function(){this.$el.append('<button class="zoom-in-btn map-btn"></button><button class="zoom-out-btn map-btn"></button>')},zoomIn:function(){this.map.zoomIn()},zoomOut:function(){this.map.zoomOut()},_open:function(e){this.map.invalidateSize(),this.$el.animate({opacity:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0},{complete:e})},toggleTraffic:function(){this.traffic?(this.traffic=!1,this.map.removeLayer(this.layers.traffic)):(this.traffic=!0,this.map.addLayer(this.layers.traffic))},showLargeMap:function(){window.Firefly.viewport.showModal(new a({map:this.large,metro:this.metro}).city())},triggerClose:function(){this.trigger("close")},showMetro:function(){window.Firefly.viewport.showModal(new a({map:this.large,metro:this.metro}).metro())}})}),define("templates/weather-widget-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var o,r,s="",l="function",c=this.escapeExpression,u=i.helperMissing;return s+='<table class="weather-widget-view-table">\n    <tr>\n        <td>\n            <p><span>'+c((o=t[0],o=null==o||o===!1?o:o.day,typeof o===l?o.apply(t):o))+"</span> ",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,(o=t[0],null==o||o===!1?o:o.month),r):u.call(t,"i18n",(o=t[0],null==o||o===!1?o:o.month),r)))+"</p>\n\n            <p>",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,(o=t[0],null==o||o===!1?o:o.wday),r):u.call(t,"i18n",(o=t[0],null==o||o===!1?o:o.wday),r)))+'</p>\n        </td>\n        <td>\n        </td>\n        <td>\n        </td>\n        <td>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div>\n                <div class="weather-widget-view-icon weather-widget-view-icon-'+c((o=t[0],o=null==o||o===!1?o:o.type,typeof o===l?o.apply(t):o))+'"></div>\n                <div class="weather-widget-view-data">\n                    <div class="weather-widget-view-temperature">\n                            '+c((o=t[0],o=null==o||o===!1?o:o.temperature,o=null==o||o===!1?o:o.day,typeof o===l?o.apply(t):o))+'&deg;\n                    </div>\n                    <div class="weather-widget-view-pressure">\n                        '+c((o=t[0],o=null==o||o===!1?o:o.pressure,typeof o===l?o.apply(t):o))+' mm Hg\n                    </div>\n                    <div class="weather-widget-view-humidity">\n                        '+c((o=t[0],o=null==o||o===!1?o:o.humidity,typeof o===l?o.apply(t):o))+'% <i class="humidity-icon"></i>\n                    </div>\n                </div>\n            </div>\n        </td>\n        <td>\n            <div class="weather-widget-days-wrapper">\n                <div class="weather-widget-view-icon-small weather-widget-view-icon-'+c((o=t[1],o=null==o||o===!1?o:o.type,typeof o===l?o.apply(t):o))+'"></div>\n                <div class="weather-widget-view-temperature-small">\n                        '+c((o=t[1],o=null==o||o===!1?o:o.temperature,o=null==o||o===!1?o:o.day,typeof o===l?o.apply(t):o))+'&deg;\n                </div>\n            </div>\n        </td>\n        <td>\n            <div class="weather-widget-days-wrapper">\n                <div class="weather-widget-view-icon-small  weather-widget-view-icon-'+c((o=t[2],o=null==o||o===!1?o:o.type,typeof o===l?o.apply(t):o))+'"></div>\n                <div class="weather-widget-view-temperature-small">\n                        '+c((o=t[2],o=null==o||o===!1?o:o.temperature,o=null==o||o===!1?o:o.day,typeof o===l?o.apply(t):o))+'&deg;\n                </div>\n            </div>\n        </td>\n        <td>\n            <div class="weather-widget-days-wrapper">\n                <div class="weather-widget-view-icon-small weather-widget-view-icon-'+c((o=t[3],o=null==o||o===!1?o:o.type,typeof o===l?o.apply(t):o))+'"></div>\n                <div class="weather-widget-view-temperature-small">\n                        '+c((o=t[3],o=null==o||o===!1?o:o.temperature,o=null==o||o===!1?o:o.day,typeof o===l?o.apply(t):o))+'&deg;\n                </div>\n            </div>\n\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <div class="weather-widget-view-today-item">\n                <h1>',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"MORNING",r):u.call(t,"i18n","MORNING",r)))+"</h1>\n                <span>"+c((o=t[0],o=null==o||o===!1?o:o.temperature,o=null==o||o===!1?o:o.morning,typeof o===l?o.apply(t):o))+'&deg;</span>\n            </div>\n            <div class="weather-widget-view-today-item">\n                <h1>',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"AFTERNOON",r):u.call(t,"i18n","AFTERNOON",r)))+"</h1>\n                <span>"+c((o=t[0],o=null==o||o===!1?o:o.temperature,o=null==o||o===!1?o:o.afternoon,typeof o===l?o.apply(t):o))+'&deg;</span>\n            </div>\n            <div class="weather-widget-view-today-item">\n                <h1>',r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,"EVENING",r):u.call(t,"i18n","EVENING",r)))+"</h1>\n                <span>"+c((o=t[0],o=null==o||o===!1?o:o.temperature,o=null==o||o===!1?o:o.evening,typeof o===l?o.apply(t):o))+"&deg;</span>\n            </div>\n        </td>\n        <td>\n            <p>"+c((o=t[1],o=null==o||o===!1?o:o.day,typeof o===l?o.apply(t):o))+"</p>\n\n            <p>",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,(o=t[1],null==o||o===!1?o:o.month),r):u.call(t,"i18n",(o=t[1],null==o||o===!1?o:o.month),r)))+"</p>\n\n            <p>",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,(o=t[1],null==o||o===!1?o:o.wday),r):u.call(t,"i18n",(o=t[1],null==o||o===!1?o:o.wday),r)))+"</p>\n        </td>\n        <td>\n            <p>"+c((o=t[2],o=null==o||o===!1?o:o.day,typeof o===l?o.apply(t):o))+"</p>\n\n            <p>",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,(o=t[2],null==o||o===!1?o:o.month),r):u.call(t,"i18n",(o=t[2],null==o||o===!1?o:o.month),r)))+"</p>\n\n            <p>",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,(o=t[2],null==o||o===!1?o:o.wday),r):u.call(t,"i18n",(o=t[2],null==o||o===!1?o:o.wday),r)))+"</p>\n        </td>\n        <td>\n            <p>"+c((o=t[3],o=null==o||o===!1?o:o.day,typeof o===l?o.apply(t):o))+"</p>\n\n            <p>",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,(o=t[3],null==o||o===!1?o:o.month),r):u.call(t,"i18n",(o=t[3],null==o||o===!1?o:o.month),r)))+"</p>\n\n            <p>",r={hash:{},data:a},s+=c((o=i.i18n,o?o.call(t,(o=t[3],null==o||o===!1?o:o.wday),r):u.call(t,"i18n",(o=t[3],null==o||o===!1?o:o.wday),r)))+"</p>\n        </td>\n    </tr>\n</table>"})}),define("views/WeatherWidgetView",["framework/View","templates/weather-widget-view"],function(e,t){"use strict";function i(e){var t=e.date.split("-"),i=new Date(t[0],t[1]-1,t[2]);return e.day=parseInt(t[2],10),e.month=n[parseInt(t[1]-1,10)],e.wday=a[i.getDay()],e}var n=["january","february","march","april","may","june","july","august","september","october","november","december"],a=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];return e.extend({className:"weather-widget-view",template:t,i18n:!0,initialize:function(){this.$el.css("opacity",0)},data:function(){return[{date:"2015-11-18",type:"snowy",humidity:"0",pressure:"755",temperature:{day:"0",morning:"0",afternoon:"0",evening:"0"}},{date:"2015-11-19",type:"rainy",humidity:"+5",pressure:"755",temperature:{day:"+4",morning:"+1",afternoon:"+1",evening:"+5"}},{date:"2015-11-20",type:"rainy",humidity:"+7",pressure:"755",temperature:{day:"+4",morning:"+1",afternoon:"+1",evening:"+5"}},{date:"2015-11-21",type:"rainy",humidity:"+6",pressure:"755",temperature:{day:"+4",morning:"+1",afternoon:"+1",evening:"+5"}},{date:"2015-11-22",type:"partly-rainy",humidity:"+5",pressure:"755",temperature:{day:"+4",morning:"+1",afternoon:"+1",evening:"+5"}}].map(i)},_open:function(e){this.$el.animate({opacity:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0},{complete:e})}})}),define("templates/main-screen-widget-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{},'<div class="main-screen-widget-view-header">\n</div>\n<div class="main-screen-widget-view-content">\n</div>'})}),define("views/MainScreenWidgetView",["framework/View","framework/Container","views/MainScreenWidgetViewTab","views/LanguageWidgetView","views/CurrencyWidgetView","views/MapView","views/WeatherWidgetView","templates/main-screen-widget-view"],function(e,t,i,n,a,o,r,s){"use strict";return e.extend({className:"main-screen-widget-view",i18m:!0,template:s,events:{"click .close-widget-btn":"showDefault"},regions:{header:".main-screen-widget-view-header",
content:".main-screen-widget-view-content"},subviews:{tab:i,container:t},layout:{content:"container",header:"tab"},select:function(e){this.subviews.tab.select(e)},initialize:function(){this.listenTo(this.subviews.tab,"select",this.showTab),this.widgets={language:new n,currency:new a,map:new o,weather:new r}},showTab:function(e){this.subviews.container.show(this.widgets[e])},showDefault:function(){this.showTab("language")},afterRender:function(){this.showDefault()}})}),define("templates/central-banner-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{},'<img src="/images/lipeck/zadonsk.jpg" style="width: 467px; "class="central-banner-image">\n'})}),define("views/CentralBannerView",["framework/View","templates/central-banner-view"],function(e,t){"use strict";return e.extend({className:"central-banner-view",template:t,events:{"click .central-banner-a":"logEvent"},initialize:function(){this.$el.css({opacity:0,perspective:"1000px",rotateY:"180deg"})},data:function(){return{image:"/images/central.png",productId:1}},_open:function(e){this.$el.transition({opacity:1,rotateY:"0deg"},e)},_close:function(e){this.$el.transition({opacity:0,rotateY:"180deg"},e)}})}),define("templates/category-list-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+='\n    <div class="category-list-view-item',n=i["if"].call(e,e.local,{hash:{},inverse:p.noop,fn:p.program(2,r,t),data:t}),(n||0===n)&&(a+=n),a+='">\n        ',n=i["if"].call(e,e.url,{hash:{},inverse:p.program(6,l,t),fn:p.program(4,s,t),data:t}),(n||0===n)&&(a+=n),a+='\n            <figure>\n                <img src="',(n=i.icon)?n=n.call(e,{hash:{},data:t}):(n=e.icon,n=typeof n===h?n.apply(e):n),a+=d(n)+'">\n                <figcaption>\n                    ',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===h?n.apply(e):n),a+=d(n)+"\n                </figcaption>\n            </figure>\n        </a>\n    </div>\n"}function r(e,t){return" category-list-view-item-local"}function s(e,t){var n,a="";return a+='\n            <a class="category-list-view-item-a" href="',(n=i.url)?n=n.call(e,{hash:{},data:t}):(n=e.url,n=typeof n===h?n.apply(e):n),a+=d(n)+'">\n        '}function l(e,t){return'\n            <a class="category-list-view-item-a">\n        '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var c,u="",h="function",d=this.escapeExpression,p=this;return u+="\n<div class=\"search-view-container\"></div>\n<div class = 'category-list-view-tickets-wrapper' >\n    \n</div>\n\n\n",c=i.each.call(t,t,{hash:{},inverse:p.noop,fn:p.program(1,o,a),data:a}),(c||0===c)&&(u+=c),u+='\n<div class="central-banner-container"> \n\n'})}),define("views/CategoryListView",["jquery","framework/View","views/CentralBannerView","templates/category-list-view","framework/utils/log","framework/utils/async","jquery.transit","jquery.easing"],function(e,t,i,n,a,o){"use strict";function r(t,i){var n,a;"angle"===i.prop&&(n=-Math.floor(s*Math.cos(t)),a=-Math.floor(s*Math.sin(t)),e(i.elem).css({translate:[n,a]}))}var s=300,l=1.75*Math.PI,c=-(l-Math.PI)/2,u=1e3;return t.extend({className:"category-list-view",template:n,i18n:!0,initialize:function(){var e=Firefly.config("showTickets");"string"==typeof e&&(e="true"===e)},regions:{center:".central-banner-container"},subviews:{banner:i},layout:{center:"banner"},data:function(){return[{id:585,name:"Отели",icon:"/images/hotels.png",url:"#main/hotel-categories",local:!1},{id:583,name:"Досуг",icon:"/images/dosug.png",url:"#main/dosug",local:!1},{id:586,name:"Питание",icon:"/images/food.png",url:"#main/food",local:!1},{id:581,name:"Культура",icon:"/images/culture.png",url:"#main/culture",local:!1},{id:582,name:"Транспорт",icon:"/images/transport.png",url:"#main/transport",local:!1},{id:582,name:"Магазины",icon:"/images/shops.png",url:"#main/shops",local:!1}]},events:{"click .category-list-view-item-a":"logEvent"},afterRender:function(){this._items=this.$(".category-list-view-item:not(.category-list-view-item-local)"),this._local=this.$(".category-list-view-item-local"),this._step=l/(this._items.length-1),this._items.css({opacity:0,left:470,top:399}),this._local.css({opacity:0,left:489,top:648})},_open:function(t){var i=this._step,n=[],a=this;this._items.each(function(t,a){a.angle=c,n.push(e(a).animate({angle:c+i*t,opacity:1},{duration:u,step:r}).promise())}),n.push(this._local.animate({opacity:1,top:700}).promise()),o.parallel([function(t){e.when.apply(e,n).done(t)},function(e){a.subviews.banner.open(e)}],t)},_close:function(t){var i=[];this._items.each(function(t,n){i.push(e(n).animate({angle:c,opacity:0},{duration:u,step:r}).promise())}),i.push(this._local.animate({opacity:0,top:300}).promise()),o.parallel([function(t){e.when.apply(e,i).done(t)},this.closeSubviews.bind(this)],t)}})}),define("models/Category",["backbone","framework/utils/backend"],function(e,t){"use strict";return e.Model.extend({defaults:{local:!1},urlRoot:function(){return t("categories")}})}),define("templates/category-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a,o,r="";return r+='\n            <li>\n                <a class="category-view-item-a" data-event="navigation:subcategory" data-id="',(n=i.id)?n=n.call(e,{hash:{},data:t}):(n=e.id,n=typeof n===c?n.apply(e):n),r+=u(n)+'" href="#main/subcategories/',(n=i.id)?n=n.call(e,{hash:{},data:t}):(n=e.id,n=typeof n===c?n.apply(e):n),r+=u(n)+'">\n                    <figure>\n                        <img src="',o={hash:{},data:t},r+=u((n=i.backend,n?n.call(e,e.icon,o):h.call(e,"backend",e.icon,o)))+'">\n                        <figcaption>\n                            ',(a=i.name)?a=a.call(e,{hash:{},data:t}):(a=e.name,a=typeof a===c?a.apply(e):a),r+=u(a)+"\n                        </figcaption>\n                    </figure>\n                </a>\n            </li>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var r,s,l="",c="function",u=this.escapeExpression,h=i.helperMissing,d=this;return l+='<h1 class="category-view-name">',(r=i.name)?r=r.call(t,{hash:{},data:a}):(r=t.name,r=typeof r===c?r.apply(t):r),l+=u(r)+'</h1>\n<div class="category-view-list-wrapper">\n    <ul class="category-view-list">\n        ',r=i.each.call(t,t.subcategories,{hash:{},inverse:d.noop,fn:d.program(1,o,a),data:a}),(r||0===r)&&(l+=r),l+='\n    </ul>\n</div>\n<span class="category-view-breadcrumbs"><a href="#main"\n                                           class="home-button"></a> <i\n        class="light-arrow"></i><button class="back-button">',s={hash:{},data:a},l+=u((r=i.i18n,r?r.call(t,"BACK",s):h.call(t,"i18n","BACK",s)))+"</button></span>"})}),define("views/CategoryView",["jquery","framework/View","models/Category","templates/category-view","framework/utils/log","framework/utils/async"],function(e,t,i,n,a,o){"use strict";var r=5,s=50,l=30,c=130,u=160,h=800,d=150;return t.extend({className:"category-view",template:n,i18n:!0,events:{"click .back-button":"back","click .category-view-item-a":"logEvent"},initialize:function(){this.$el.css({opacity:0,scale:2})},back:function(){window.history.back()},_load:function(e){this.model.fetch({success:e,error:e})},afterRender:function(){this._items=this.$(".category-view-list > li");var t=this._items.length,i=t%r?Math.floor(t/r)+1:t/r,n=1===i?t*(c+l)-l:r*(c+l)-l,o=i*(u+s)-s;t&&(this.duration=Math.max(d,h/t)),a.trace("item count: "+t),a.trace("row count: "+i),a.trace("list width: "+n),a.trace("list height: "+o),this.$(".category-view-list").css({top:(615-o)/2,left:(900-n)/2,width:n,height:o}),this._items.each(function(t,i){var n=t%r,o=Math.floor(t/r);a.trace("xIndex: "+n),a.trace("yIndex: "+o),e(i).css({top:o*(u+s),left:n*(c+l),scale:2,opacity:0})})},_open:function(t){var i=[],n=this.duration,a=this.$el;i.push(function(e){a.animate({opacity:1,scale:1},e)}),this._items.each(function(t,a){n-=5,i.push(function(t){e(a).animate({scale:1,opacity:1},n,t)})}),o.serial(i,t)},_close:function(t){var i=[],n=this.duration,a=this.$el;i.push(function(e){a.animate({opacity:0,scale:2},e)}),this._items.each(function(t,a){n-=5,i.unshift(function(t){e(a).animate({scale:2,opacity:0},n,t)})}),o.serial(i,t)}})}),define("models/Subcategory",["underscore","backbone","framework/utils/backend"],function(e,t,i){"use strict";return t.Model.extend({urlRoot:function(){return i("subcategories")},parse:function(t){return t.locations=[],e.each(t.products,function(i){e.each(i.locations,function(e){e.product=i,t.locations.push(e)})}),t}})}),define("templates/subcategory-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a,o,u="";return u+='\n            <a class="subcategory-view-list-a" data-event="navigation:product" data-id="',(n=i.id)?n=n.call(e,{hash:{},data:t}):(n=e.id,n=typeof n===m?n.apply(e):n),u+=f(n)+'" href="#main/products/',(n=i.id)?n=n.call(e,{hash:{},data:t}):(n=e.id,n=typeof n===m?n.apply(e):n),u+=f(n)+'">\n                <div class="subcategory-view-list-item">\n                    <h1 class="subcategory-view-list-item-name">',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===m?n.apply(e):n),u+=f(n)+'</h1>\n\n                    <div class="subcategory-view-list-item-image-background',n=i["if"].call(e,e.recommended,{hash:{},inverse:v.noop,fn:v.program(2,r,t),data:t}),(n||0===n)&&(u+=n),u+='">\n                        <img class="subcategory-view-list-item-image" src="',n=i["if"].call(e,e.logo,{hash:{},inverse:v.program(6,l,t),fn:v.program(4,s,t),data:t}),(n||0===n)&&(u+=n),u+='">\n                    </div>\n                    <div class="subcategory-view-list-item-info">\n                        <div class="subcategory-view-list-item-description">\n                            ',(n=i.shortDesc)?n=n.call(e,{hash:{},data:t}):(n=e.shortDesc,n=typeof n===m?n.apply(e):n),u+=f(n)+'\n                        </div>\n                        <div class="subcategory-view-list-item-location">\n                            '+f((n=e.locations,n=null==n||n===!1?n:n[0],n=null==n||n===!1?n:n.address,typeof n===m?n.apply(e):n))+'\n                        </div>\n                        <div class="subcategory-view-list-more-info">',a=i["if"].call(e,e.discount,{hash:{},inverse:v.noop,fn:v.program(8,c,t),data:t}),(a||0===a)&&(u+=a),o={hash:{},data:t},u+=f((n=i.i18n,n?n.call(e,"MORE INFO",o):p.call(e,"i18n","MORE INFO",o)))+'<i\n                                class="light-arrow-d"></i>\n                            <i class="light-arrow-d"></i>\n                        </div>\n                    </div>\n                </div>\n            </a>\n        '}function r(e,t){return" subcategory-view-list-item-image-background-recommended"}function s(e,t){var n,a;return a={hash:{},data:t},f((n=i.backend,n?n.call(e,e.logo,a):p.call(e,"backend",e.logo,a)))}function l(e,t){return"/images/no-image-logo.png"}function c(e,t){return'<i\n                                class="discount-icon"></i>'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var u,h,d="",p=i.helperMissing,f=this.escapeExpression,m="function",v=this;return d+='<h1 class="subcategory-view-name">\n    ',(u=i.name)?u=u.call(t,{hash:{},data:a}):(u=t.name,u=typeof u===m?u.apply(t):u),d+=f(u)+'\n</h1>\n<div class="subcategory-view-list-wrapper">\n    <div class="subcategory-view-list">\n        ',u=i.each.call(t,t.products,{hash:{},inverse:v.noop,fn:v.program(1,o,a),data:a}),(u||0===u)&&(d+=u),d+='\n    </div>\n</div>\n<div class="subcategory-view-scroll">\n    <div class="subcategory-view-scroll-knob">\n    </div>\n</div>\n<span class="subcategory-view-breadcrumbs"><a href="#main"\n                                              class="home-button"></a>\n    <i class="light-arrow"></i><button class="back-button">',h={hash:{},data:a},d+=f((u=i.i18n,u?u.call(t,"BACK",h):p.call(t,"i18n","BACK",h)))+'</button></span>\n<button class="subcategory-view-previous-page-button"></button>\n<button class="subcategory-view-next-page-button"></button>\n'})}),define("views/SubcategoryView",["framework/View","models/Subcategory","templates/subcategory-view"],function(e,t,i){"use strict";var n=615;return e.extend({className:"subcategory-view",template:i,i18n:!0,events:{"click .back-button":"back","click .subcategory-view-next-page-button":"next","click .subcategory-view-previous-page-button":"previous","click .subcategory-view-list-a":"logEvent"},initialize:function(e){e=e||{},this.currentPage=e.page||0,this.$el.css({opacity:0,scale:2})},_load:function(e){this.model.fetch({success:e,error:e})},afterRender:function(){this.$(".subcategory-view-list").css({top:0}),this.currentPage||(this.currentPage=0);var e=this.model.get("products")?this.model.get("products").length:0;e>4?(this.pages=e%4===0?e/4:Math.floor(e/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages):(this.$(".subcategory-view-scroll").hide(),this.$(".subcategory-view-next-page-button").hide(),this.$(".subcategory-view-previous-page-button").hide()),this.model.get("products")&&(this.pages=this.model.get("products").length%4===0?this.model.get("products").length/4:Math.floor(this.model.get("products").length/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages),this.goToPageStatic(this.currentPage)},back:function(){window.history.back()},_open:function(e){window.Firefly.trigger("map:locations:category",this.model.get("locations")),this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0,scale:2},{complete:e})},goToPageStatic:function(e){this.$(".subcategory-view-list").css({top:-n*e}),this.$(".subcategory-view-scroll-knob").css({top:this.scrollStep*e}),this.currentPage=e},goToPage:function(e){this.$(".subcategory-view-list").animate({top:-n*e}),this.$(".subcategory-view-scroll-knob").animate({top:this.scrollStep*e}),this.currentPage=e},next:function(){if(this.currentPage<this.pages-1){var e="main/subcategories/"+this.model.id+"/"+(this.currentPage+1);window.history.replaceState({},"","#"+e),this.goToPage(this.currentPage+1)}},previous:function(){if(this.currentPage>0){var e="main/subcategories/"+this.model.id+"/"+(this.currentPage-1);window.history.replaceState({},"","#"+e),this.goToPage(this.currentPage-1)}}})}),define("models/Product",["underscore","backbone","framework/utils/backend"],function(e,t,i){"use strict";return t.Model.extend({initialize:function(){this.on("sync",function(t){var i=t.get("locations");e.each(i,function(e){e.product=t.toJSON()}),t.locations=i})},parse:function(t){return t.locations?(e.each(t.locations,function(e){e.product=t}),t):t},urlRoot:function(){return i("products")}})}),define("templates/product-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){return" product-view-name-recommended"}function r(e,t){var n;return(n=i.logo)?n=n.call(e,{hash:{},data:t}):(n=e.logo,n=typeof n===k?n.apply(e):n),x(n)}function s(e,t){return"/images/no-image-logo.png"}function l(e,t){var n,a,o="";return o+='\n            <div><span class="product-view-contacts-item-heading">',a={hash:{},data:t},o+=x((n=i.i18n,n?n.call(e,"Address",a):T.call(e,"i18n","Address",a)))+":</span>"+x((n=e.locations,n=null==n||n===!1?n:n[0],n=null==n||n===!1?n:n.address,typeof n===k?n.apply(e):n))+"\n            </div>"}function c(e,t){var n,a,o="";return o+='\n            <div><span class="product-view-contacts-item-heading">',a={hash:{},data:t},o+=x((n=i.i18n,n?n.call(e,"Phone",a):T.call(e,"i18n","Phone",a)))+":</span>"+x((n=e.phones,n=null==n||n===!1?n:n[0],typeof n===k?n.apply(e):n))+"\n            </div>"}function u(e,t){var n,a,o,r="";return r+='\n            <div><span class="product-view-contacts-item-heading">',o={hash:{},data:t},r+=x((n=i.i18n,n?n.call(e,"Opening hours",o):T.call(e,"i18n","Opening hours",o)))+":</span>",(a=i.workTime)?a=a.call(e,{hash:{},data:t}):(a=e.workTime,a=typeof a===k?a.apply(e):a),r+=x(a)+"\n            </div>"}function h(e,t){var n,a,o,r="";return r+='\n            <div><span class="product-view-contacts-item-heading">',o={hash:{},data:t},r+=x((n=i.i18n,n?n.call(e,"Metro",o):T.call(e,"i18n","Metro",o)))+":</span>",(a=i.metro)?a=a.call(e,{hash:{},data:t}):(a=e.metro,a=typeof a===k?a.apply(e):a),r+=x(a)+"</div>"}function d(e,t){var n,a,o,r="";return r+='\n            <div><span class="product-view-contacts-item-heading">',o={hash:{},data:t},r+=x((n=i.i18n,n?n.call(e,"Website",o):T.call(e,"i18n","Website",o)))+":</span>",(a=i.site)?a=a.call(e,{hash:{},data:t}):(a=e.site,a=typeof a===k?a.apply(e):a),r+=x(a)+"</div>"}function p(e,t){var n,a,o,r="";return r+='\n        <div class="product-view-discount product-view-discount-',(n=i.templateId)?n=n.call(e,{hash:{},data:t}):(n=e.templateId,n=typeof n===k?n.apply(e):n),r+=x(n)+'">\n            <span class="product-view-discount-heading">',o={hash:{},data:t},r+=x((n=i.i18n,n?n.call(e,"DISCOUNT",o):T.call(e,"i18n","DISCOUNT",o)))+'</span><span\n                class="product-view-discount-amount">',(a=i.discount)?a=a.call(e,{hash:{},data:t}):(a=e.discount,a=typeof a===k?a.apply(e):a),r+=x(a)+'</span><i class="discount-icon-light"></i>\n        </div>\n    '}function f(e,t){var n,a="";return a+="\n                ",n=i.each.call(e,e.images,{hash:{},inverse:S.noop,fn:S.program(20,m,t),data:t}),(n||0===n)&&(a+=n),a+="\n            "}function m(e,t){var i="";return i+='\n                    <li><img src="'+x(typeof e===k?e.apply(e):e)+'"></li>\n                '}function v(e,t){return'\n                <li><img src="/images/no-image.png"></li>\n            '}function g(e,t){var n,a,o="";return o+='\n    <button class="print-discount-button">',a={hash:{},data:t},o+=x((n=i.i18n,n?n.call(e,"PRINT DISCOUNT",a):T.call(e,"i18n","PRINT DISCOUNT",a)))+"</button>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var y,b,w,_="",k="function",x=this.escapeExpression,T=i.helperMissing,S=this;return _+='<h1 class="product-view-name',y=i["if"].call(t,t.recommended,{hash:{},inverse:S.noop,fn:S.program(1,o,a),data:a}),(y||0===y)&&(_+=y),_+='">',(y=i.name)?y=y.call(t,{hash:{},data:a}):(y=t.name,y=typeof y===k?y.apply(t):y),_+=x(y)+'</h1>\n<div class="product-view-wrapper">\n    <img src="',y=i["if"].call(t,t.logo,{hash:{},inverse:S.program(5,s,a),fn:S.program(3,r,a),data:a}),(y||0===y)&&(_+=y),_+='"\n         class="product-view-logo product-view-logo-',(y=i.templateId)?y=y.call(t,{hash:{},data:a}):(y=t.templateId,y=typeof y===k?y.apply(t):y),_+=x(y)+'">\n\n    <div class="product-view-contacts product-view-contacts-',(y=i.templateId)?y=y.call(t,{hash:{},data:a}):(y=t.templateId,y=typeof y===k?y.apply(t):y),_+=x(y)+'">\n        <h1 class="product-view-contacts-heading">',w={hash:{},data:a},_+=x((y=i.i18n,y?y.call(t,"CONTACTS",w):T.call(t,"i18n","CONTACTS",w)))+":</h1>\n\n        ",b=i["if"].call(t,(y=t.locations,null==y||y===!1?y:y[0]),{hash:{},inverse:S.noop,fn:S.program(7,l,a),data:a}),(b||0===b)&&(_+=b),_+="\n        ",b=i["if"].call(t,(y=t.phones,null==y||y===!1?y:y[0]),{hash:{},inverse:S.noop,fn:S.program(9,c,a),data:a}),(b||0===b)&&(_+=b),_+="\n        ",b=i["if"].call(t,t.workTime,{hash:{},inverse:S.noop,fn:S.program(11,u,a),data:a}),(b||0===b)&&(_+=b),_+="\n        ",b=i["if"].call(t,t.metro,{hash:{},inverse:S.noop,fn:S.program(13,h,a),data:a}),(b||0===b)&&(_+=b),_+="\n        ",b=i["if"].call(t,t.site,{hash:{},inverse:S.noop,fn:S.program(15,d,a),data:a}),(b||0===b)&&(_+=b),_+='\n    </div>\n    <div class="product-view-info product-view-info-',(b=i.templateId)?b=b.call(t,{hash:{},data:a}):(b=t.templateId,b=typeof b===k?b.apply(t):b),_+=x(b)+'">\n        <h1 class="product-view-info-heading">',w={hash:{},data:a},_+=x((y=i.i18n,y?y.call(t,"ABOUT",w):T.call(t,"i18n","ABOUT",w)))+'</h1>\n\n        <div class="product-view-description">\n            <article>\n                ',w={hash:{},data:a},_+=x((y=i.paragraphize,y?y.call(t,t.description,w):T.call(t,"paragraphize",t.description,w)))+'\n            </article>\n        </div>\n    </div>\n    <div class="product-view-description-scroll product-view-description-scroll-',(b=i.templateId)?b=b.call(t,{hash:{},data:a}):(b=t.templateId,b=typeof b===k?b.apply(t):b),_+=x(b)+'">\n        <div class="product-view-description-scroll-knob">\n        </div>\n    </div>\n    ',b=i["if"].call(t,t.discount,{hash:{},inverse:S.noop,fn:S.program(17,p,a),data:a}),(b||0===b)&&(_+=b),_+='\n    <div class="product-view-slider-wrapper product-view-slider-wrapper-',(b=i.templateId)?b=b.call(t,{hash:{},data:a}):(b=t.templateId,b=typeof b===k?b.apply(t):b),_+=x(b)+'">\n        <ul class="bxslider product-view-slider">\n            ',b=i["if"].call(t,(y=t.images,null==y||y===!1?y:y[0]),{hash:{},inverse:S.program(22,v,a),fn:S.program(19,f,a),data:a}),(b||0===b)&&(_+=b),_+='\n        </ul>\n    </div>\n</div>\n<span class="product-view-breadcrumbs">\n    <a href="#main"\n       class="home-button"></a>\n    <i class="light-arrow"></i><button class="back-button">',w={hash:{},data:a},_+=x((y=i.i18n,y?y.call(t,"BACK",w):T.call(t,"i18n","BACK",w)))+"</button>\n</span>\n",b=i["if"].call(t,t.discount,{hash:{},inverse:S.noop,fn:S.program(24,g,a),data:a}),(b||0===b)&&(_+=b),_+='\n<!-- <button class="print-button">',w={hash:{},data:a},_+=x((y=i.i18n,y?y.call(t,"PRINT",w):T.call(t,"i18n","PRINT",w)))+"</button> -->\n"})}),define("framework/utils/scroller",[],function(){"use strict";!function(e){var t=Date.now||function(){return+new Date},i=60,n=1e3,a={},o=1;e.core?core.effect||(core.effect={}):e.core={effect:{}},core.effect.Animate={requestAnimationFrame:function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame,i=!!t;if(t&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(t.toString())&&(i=!1),i)return function(e,i){t(e,i)};var n=60,a={},o=0,r=1,s=null,l=+new Date;return function(e,t){var i=r++;return a[i]=e,o++,null===s&&(s=setInterval(function(){var e=+new Date,t=a;a={},o=0;for(var i in t)t.hasOwnProperty(i)&&(t[i](e),l=e);e-l>2500&&(clearInterval(s),s=null)},1e3/n)),i}}(),stop:function(e){var t=null!=a[e];return t&&(a[e]=null),t},isRunning:function(e){return null!=a[e]},start:function(e,r,s,l,c,u){var h=t(),d=h,p=0,f=0,m=o++;if(u||(u=document.body),m%20===0){var v={};for(var g in a)v[g]=!0;a=v}var y=function(o){var v=o!==!0,g=t();if(!a[m]||r&&!r(m))return a[m]=null,void(s&&s(i-f/((g-h)/n),m,!1));if(v)for(var b=Math.round((g-d)/(n/i))-1,w=0;w<Math.min(b,4);w++)y(!0),f++;l&&(p=(g-h)/l,p>1&&(p=1));var _=c?c(p):p;e(_,g,v)!==!1&&1!==p||!v?v&&(d=g,core.effect.Animate.requestAnimationFrame(y,u)):(a[m]=null,s&&s(i-f/((g-h)/n),m,1===p||null==l))};return a[m]=!0,core.effect.Animate.requestAnimationFrame(y,u),m}}}(window);var e;return function(){e=function(e,t){this.__callback=e,this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3};for(var i in t)this.options[i]=t[i]};var t=function(e){return Math.pow(e-1,3)+1},i=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},n={__isSingleTouch:!1,__isTracking:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setDimensions:function(e,t,i,n){var a=this;e&&(a.__clientWidth=e),t&&(a.__clientHeight=t),i&&(a.__contentWidth=i),n&&(a.__contentHeight=n),a.__computeScrollMax(),a.scrollTo(a.__scrollLeft,a.__scrollTop,!0)},setPosition:function(e,t){var i=this;i.__clientLeft=e||0,i.__clientTop=t||0},setSnapSize:function(e,t){var i=this;i.__snapWidth=e,i.__snapHeight=t},activatePullToRefresh:function(e,t,i,n){var a=this;a.__refreshHeight=e,a.__refreshActivate=t,a.__refreshDeactivate=i,a.__refreshStart=n},finishPullToRefresh:function(){var e=this;e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},getValues:function(){var e=this;return{left:e.__scrollLeft,top:e.__scrollTop,zoom:e.__zoomLevel}},getScrollMax:function(){var e=this;return{left:e.__maxScrollLeft,top:e.__maxScrollTop}},zoomTo:function(e,t,i,n){var a=this;if(!a.options.zooming)throw new Error("Zooming is not enabled!");a.__isDecelerating&&(core.effect.Animate.stop(a.__isDecelerating),a.__isDecelerating=!1);var o=a.__zoomLevel;null==i&&(i=a.__clientWidth/2),null==n&&(n=a.__clientHeight/2),e=Math.max(Math.min(e,a.options.maxZoom),a.options.minZoom),a.__computeScrollMax(e);var r=(i+a.__scrollLeft)*e/o-i,s=(n+a.__scrollTop)*e/o-n;r>a.__maxScrollLeft?r=a.__maxScrollLeft:0>r&&(r=0),s>a.__maxScrollTop?s=a.__maxScrollTop:0>s&&(s=0),a.__publish(r,s,e,t)},zoomBy:function(e,t,i,n){var a=this;a.zoomTo(a.__zoomLevel*e,t,i,n)},scrollTo:function(e,t,i,n){var a=this;if(a.__isDecelerating&&(core.effect.Animate.stop(a.__isDecelerating),a.__isDecelerating=!1),null!=n&&n!==a.__zoomLevel){if(!a.options.zooming)throw new Error("Zooming is not enabled!");e*=n,t*=n,a.__computeScrollMax(n)}else n=a.__zoomLevel;a.options.scrollingX?a.options.paging?e=Math.round(e/a.__clientWidth)*a.__clientWidth:a.options.snapping&&(e=Math.round(e/a.__snapWidth)*a.__snapWidth):e=a.__scrollLeft,a.options.scrollingY?a.options.paging?t=Math.round(t/a.__clientHeight)*a.__clientHeight:a.options.snapping&&(t=Math.round(t/a.__snapHeight)*a.__snapHeight):t=a.__scrollTop,e=Math.max(Math.min(a.__maxScrollLeft,e),0),t=Math.max(Math.min(a.__maxScrollTop,t),0),e===a.__scrollLeft&&t===a.__scrollTop&&(i=!1),a.__publish(e,t,n,i)},scrollBy:function(e,t,i){var n=this,a=n.__isAnimating?n.__scheduledLeft:n.__scrollLeft,o=n.__isAnimating?n.__scheduledTop:n.__scrollTop;n.scrollTo(a+(e||0),o+(t||0),i)},doMouseZoom:function(e,t,i,n){var a=this,o=e>0?.97:1.03;return a.zoomTo(a.__zoomLevel*o,!1,i-a.__clientLeft,n-a.__clientTop)},doTouchStart:function(e,t){if(null==e.length)throw new Error("Invalid touch list: "+e);if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var i=this;i.__isDecelerating&&(core.effect.Animate.stop(i.__isDecelerating),i.__isDecelerating=!1),i.__isAnimating&&(core.effect.Animate.stop(i.__isAnimating),i.__isAnimating=!1);var n,a,o=1===e.length;o?(n=e[0].pageX,a=e[0].pageY):(n=Math.abs(e[0].pageX+e[1].pageX)/2,a=Math.abs(e[0].pageY+e[1].pageY)/2),i.__initialTouchLeft=n,i.__initialTouchTop=a,i.__zoomLevelStart=i.__zoomLevel,i.__lastTouchLeft=n,i.__lastTouchTop=a,i.__lastTouchMove=t,i.__lastScale=1,i.__enableScrollX=!o&&i.options.scrollingX,i.__enableScrollY=!o&&i.options.scrollingY,i.__isTracking=!0,i.__isDragging=!o,i.__isSingleTouch=o,i.__positions=[]},doTouchMove:function(e,t,i){if(null==e.length)throw new Error("Invalid touch list: "+e);if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var n=this;if(n.__isTracking){var a,o;2===e.length?(a=Math.abs(e[0].pageX+e[1].pageX)/2,o=Math.abs(e[0].pageY+e[1].pageY)/2):(a=e[0].pageX,o=e[0].pageY);var r=n.__positions;if(n.__isDragging){var s=a-n.__lastTouchLeft,l=o-n.__lastTouchTop,c=n.__scrollLeft,u=n.__scrollTop,h=n.__zoomLevel;if(null!=i&&n.options.zooming){var d=h;if(h=h/n.__lastScale*i,h=Math.max(Math.min(h,n.options.maxZoom),n.options.minZoom),d!==h){var p=a-n.__clientLeft,f=o-n.__clientTop;c=(p+c)*h/d-p,u=(f+u)*h/d-f,n.__computeScrollMax(h)}}if(n.__enableScrollX){c-=s;var m=n.__maxScrollLeft;(c>m||0>c)&&(n.options.bouncing?c+=s/2:c=c>m?m:0)}if(n.__enableScrollY){u-=l;var v=n.__maxScrollTop;(u>v||0>u)&&(n.options.bouncing?(u+=l/2,n.__enableScrollX||null==n.__refreshHeight||(!n.__refreshActive&&u<=-n.__refreshHeight?(n.__refreshActive=!0,n.__refreshActivate&&n.__refreshActivate()):n.__refreshActive&&u>-n.__refreshHeight&&(n.__refreshActive=!1,n.__refreshDeactivate&&n.__refreshDeactivate()))):u=u>v?v:0)}r.length>60&&r.splice(0,30),r.push(c,u,t),n.__publish(c,u,h)}else{var g=n.options.locking?3:0,y=5,b=Math.abs(a-n.__initialTouchLeft),w=Math.abs(o-n.__initialTouchTop);n.__enableScrollX=n.options.scrollingX&&b>=g,n.__enableScrollY=n.options.scrollingY&&w>=g,r.push(n.__scrollLeft,n.__scrollTop,t),n.__isDragging=(n.__enableScrollX||n.__enableScrollY)&&(b>=y||w>=y)}n.__lastTouchLeft=a,n.__lastTouchTop=o,n.__lastTouchMove=t,n.__lastScale=i}},doTouchEnd:function(e){if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e);var t=this;if(t.__isTracking){if(t.__isTracking=!1,t.__isDragging&&(t.__isDragging=!1,t.__isSingleTouch&&t.options.animating&&e-t.__lastTouchMove<=100)){for(var i=t.__positions,n=i.length-1,a=n,o=n;o>0&&i[o]>t.__lastTouchMove-100;o-=3)a=o;if(a!==n){var r=i[n]-i[a],s=t.__scrollLeft-i[a-2],l=t.__scrollTop-i[a-1];t.__decelerationVelocityX=s/r*(1e3/60),t.__decelerationVelocityY=l/r*(1e3/60);var c=t.options.paging||t.options.snapping?4:1;(Math.abs(t.__decelerationVelocityX)>c||Math.abs(t.__decelerationVelocityY)>c)&&(t.__refreshActive||t.__startDeceleration(e))}}t.__isDecelerating||(t.__refreshActive&&t.__refreshStart?(t.__publish(t.__scrollLeft,-t.__refreshHeight,t.__zoomLevel,!0),t.__refreshStart&&t.__refreshStart()):(t.scrollTo(t.__scrollLeft,t.__scrollTop,!0,t.__zoomLevel),t.__refreshActive&&(t.__refreshActive=!1,t.__refreshDeactivate&&t.__refreshDeactivate()))),t.__positions.length=0}},__publish:function(e,n,a,o){var r=this,s=r.__isAnimating;if(s&&(core.effect.Animate.stop(s),r.__isAnimating=!1),o&&r.options.animating){r.__scheduledLeft=e,r.__scheduledTop=n,r.__scheduledZoom=a;var l=r.__scrollLeft,c=r.__scrollTop,u=r.__zoomLevel,h=e-l,d=n-c,p=a-u,f=function(e,t,i){i&&(r.__scrollLeft=l+h*e,r.__scrollTop=c+d*e,r.__zoomLevel=u+p*e,r.__callback&&r.__callback(r.__scrollLeft,r.__scrollTop,r.__zoomLevel))},m=function(e){return r.__isAnimating===e},v=function(e,t,i){t===r.__isAnimating&&(r.__isAnimating=!1),r.options.zooming&&r.__computeScrollMax()};r.__isAnimating=core.effect.Animate.start(f,m,v,r.options.animationDuration,s?t:i)}else r.__scheduledLeft=r.__scrollLeft=e,r.__scheduledTop=r.__scrollTop=n,r.__scheduledZoom=r.__zoomLevel=a,r.__callback&&r.__callback(e,n,a),r.options.zooming&&r.__computeScrollMax()},__computeScrollMax:function(e){var t=this;null==e&&(e=t.__zoomLevel),t.__maxScrollLeft=Math.max(t.__contentWidth*e-t.__clientWidth,0),t.__maxScrollTop=Math.max(t.__contentHeight*e-t.__clientHeight,0)},__startDeceleration:function(e){var t=this;if(t.options.paging){var i=Math.max(Math.min(t.__scrollLeft,t.__maxScrollLeft),0),n=Math.max(Math.min(t.__scrollTop,t.__maxScrollTop),0),a=t.__clientWidth,o=t.__clientHeight;t.__minDecelerationScrollLeft=Math.floor(i/a)*a,t.__minDecelerationScrollTop=Math.floor(n/o)*o,t.__maxDecelerationScrollLeft=Math.ceil(i/a)*a,t.__maxDecelerationScrollTop=Math.ceil(n/o)*o}else t.__minDecelerationScrollLeft=0,t.__minDecelerationScrollTop=0,t.__maxDecelerationScrollLeft=t.__maxScrollLeft,t.__maxDecelerationScrollTop=t.__maxScrollTop;var r=function(e,i,n){t.__stepThroughDeceleration(n)},s=t.options.snapping?4:.1,l=function(){return Math.abs(t.__decelerationVelocityX)>=s||Math.abs(t.__decelerationVelocityY)>=s},c=function(e,i,n){t.__isDecelerating=!1,t.scrollTo(t.__scrollLeft,t.__scrollTop,t.options.snapping)};t.__isDecelerating=core.effect.Animate.start(r,l,c)},__stepThroughDeceleration:function(e){var t=this,i=t.__scrollLeft+t.__decelerationVelocityX,n=t.__scrollTop+t.__decelerationVelocityY;
if(!t.options.bouncing){var a=Math.max(Math.min(t.__maxDecelerationScrollLeft,i),t.__minDecelerationScrollLeft);a!==i&&(i=a,t.__decelerationVelocityX=0);var o=Math.max(Math.min(t.__maxDecelerationScrollTop,n),t.__minDecelerationScrollTop);o!==n&&(n=o,t.__decelerationVelocityY=0)}if(e?t.__publish(i,n,t.__zoomLevel):(t.__scrollLeft=i,t.__scrollTop=n),!t.options.paging){var r=.95;t.__decelerationVelocityX*=r,t.__decelerationVelocityY*=r}if(t.options.bouncing){var s=0,l=0,c=.03,u=.08;i<t.__minDecelerationScrollLeft?s=t.__minDecelerationScrollLeft-i:i>t.__maxDecelerationScrollLeft&&(s=t.__maxDecelerationScrollLeft-i),n<t.__minDecelerationScrollTop?l=t.__minDecelerationScrollTop-n:n>t.__maxDecelerationScrollTop&&(l=t.__maxDecelerationScrollTop-n),0!==s&&(s*t.__decelerationVelocityX<=0?t.__decelerationVelocityX+=s*c:t.__decelerationVelocityX=s*u),0!==l&&(l*t.__decelerationVelocityY<=0?t.__decelerationVelocityY+=l*c:t.__decelerationVelocityY=l*u)}}};for(var a in n)e.prototype[a]=n[a]}(),e}),define("framework/utils/Scroll",["jquery","framework/utils/scroller"],function(e,t){function i(i,n,a){function o(e){e.fromElement||(l.startX=e.pageX,l.startY=e.pageY,d.doTouchStart([{pageX:e.pageX,pageY:e.pageY}],e.timeStamp),c=!0),e.preventDefault()}function r(e){c&&(l.curX=e.pageX,l.curY=e.pageY,a.activeView&&a.activeView.rollBack&&l.calcDelta()>=l.deltaConstraint&&a.activeView.rollBack(),d.doTouchMove([{pageX:e.pageX,pageY:e.pageY}],e.timeStamp),c=!0)}function s(e){c&&(e.fromElement||(d.doTouchEnd(e.timeStamp),c=!1))}var l={deltaConstraint:10,curX:0,curY:0,startX:0,startY:0,calcDelta:function(){return Math.sqrt(Math.pow(this.curY-this.startY,2)+Math.pow(this.curX-this.startX,2))}};a=a||{};var c,u=a.deltaHeight||0,h=a.deltaWidth||0,d=this,p=a.scrollbarFn,f=e("body");t.call(this,function(e,t,i){a.callback&&a.callback(e,t,i),n.css({translate:[-e,-t]}),p&&p(e,t)},a.options||{}),this.setDimensions(i.outerWidth(),i.outerHeight(),n.outerWidth()+h,n.outerHeight()+u),i.on("mousedown",o),f.on("mousemove",r),f.on("mouseup",s),i.height()>=n.height()&&i.width()>=n.width()&&(this.options.scrollingY=this.options.scrollingX=!1),a.scrollbar&&(p=function(e,t){var a=e.height(),o=i.height(),r=n.height(),s=o/r*a;return o>=r?void e.hide():(t.css("height",s),e.animate({opacity:1}),function(e,i){t.css({translate:[0,i/r*a]})})}(a.scrollbar.$scroll,a.scrollbar.$scrollKnob)),this.destroy=function(){i.off("mousedown",o),f.off("mousemove",r),f.off("mouseup",s)}}i.prototype.destroy=function(){};for(var n in t.prototype)i.prototype[n]=t.prototype[n];return i}),function(e){var t={},n={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){}};e.fn.bxSlider=function(a){if(0==this.length)return this;if(this.length>1)return this.each(function(){e(this).bxSlider(a)}),this;var o={},r=this;t.el=this;var s=e(window).width(),l=e(window).height(),c=function(){o.settings=e.extend({},n,a),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=r.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"==o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!=o.settings.mode&&function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in t)if(void 0!==e.style[t[i]])return o.cssPrefix=t[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"==o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),r.data("origStyle",r.attr("style")),r.children(o.settings.slideSelector).each(function(){e(this).data("origStyle",e(this).attr("style"))}),u()},u=function(){r.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>'),o.viewport=r.parent(),o.loader=e('<div class="bx-loading" />'),o.viewport.prepend(o.loader),r.css({width:"horizontal"==o.settings.mode?100*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?r.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing");v();o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:f()}),o.settings.pager||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"==o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",m()),"horizontal"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"==o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:50,display:"block"})),o.controls.el=e('<div class="bx-controls" />'),o.settings.captions&&S(),o.active.last=o.settings.startSlide==g()-1,o.settings.video&&r.fitVids();var t=o.children.eq(o.settings.startSlide);"all"==o.settings.preloadImages&&(t=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.pager&&k(),o.settings.controls&&x(),o.settings.auto&&o.settings.autoControls&&T(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),h(t,d)},h=function(t,i){var n=t.find("img, iframe").length;if(0==n)return void i();var a=0;t.find("img, iframe").each(function(){e(this).one("load",function(){++a==n&&i()}).each(function(){this.complete&&e(this).load()})})},d=function(){if(o.settings.infiniteLoop&&"fade"!=o.settings.mode&&!o.settings.ticker){var t="vertical"==o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,t).clone().addClass("bx-clone"),n=o.children.slice(-t).clone().addClass("bx-clone");r.append(i).prepend(n)}o.loader.remove(),b(),"vertical"==o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(p()),r.redrawSlider(),o.settings.onSliderLoad(o.active.index),o.initialized=!0,o.settings.responsive&&e(window).bind("resize",H),o.settings.auto&&o.settings.autoStart&&I(),o.settings.ticker&&O(),o.settings.pager&&D(o.settings.startSlide),o.settings.controls&&N(),o.settings.touchEnabled&&!o.settings.ticker&&B()},p=function(){var t=0,n=e();if("vertical"==o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var a=1==o.settings.moveSlides?o.active.index:o.active.index*y();for(n=o.children.eq(a),i=1;i<=o.settings.maxSlides-1;i++)n=a+i>=o.children.length?n.add(o.children.eq(i-1)):n.add(o.children.eq(a+i))}else n=o.children.eq(o.active.index);else n=o.children;return"vertical"==o.settings.mode?(n.each(function(i){t+=e(this).outerHeight()}),o.settings.slideMargin>0&&(t+=o.settings.slideMargin*(o.settings.minSlides-1))):t=Math.max.apply(Math,n.map(function(){return e(this).outerHeight(!1)}).get()),t},f=function(){var e="100%";return o.settings.slideWidth>0&&(e="horizontal"==o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),e},m=function(){var e=o.settings.slideWidth,t=o.viewport.width();return 0==o.settings.slideWidth||o.settings.slideWidth>t&&!o.carousel||"vertical"==o.settings.mode?e=t:o.settings.maxSlides>1&&"horizontal"==o.settings.mode&&(t>o.maxThreshold||t<o.minThreshold&&(e=(t-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides)),e},v=function(){var e=1;if("horizontal"==o.settings.mode&&o.settings.slideWidth>0)if(o.viewport.width()<o.minThreshold)e=o.settings.minSlides;else if(o.viewport.width()>o.maxThreshold)e=o.settings.maxSlides;else{var t=o.children.first().width();e=Math.floor(o.viewport.width()/t)}else"vertical"==o.settings.mode&&(e=o.settings.minSlides);return e},g=function(){var e=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)e=o.children.length/y();else for(var t=0,i=0;t<o.children.length;)++e,t=i+v(),i+=o.settings.moveSlides<=v()?o.settings.moveSlides:v();else e=Math.ceil(o.children.length/v());return e},y=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=v()?o.settings.moveSlides:v()},b=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if("horizontal"==o.settings.mode){var e=o.children.last(),t=e.position();w(-(t.left-(o.viewport.width()-e.width())),"reset",0)}else if("vertical"==o.settings.mode){var i=o.children.length-o.settings.minSlides,t=o.children.eq(i).position();w(-t.top,"reset",0)}}else{var t=o.children.eq(o.active.index*y()).position();o.active.index==g()-1&&(o.active.last=!0),void 0!=t&&("horizontal"==o.settings.mode?w(-t.left,"reset",0):"vertical"==o.settings.mode&&w(-t.top,"reset",0))}},w=function(e,t,i,n){if(o.usingCSS){var a="vertical"==o.settings.mode?"translate3d(0, "+e+"px, 0)":"translate3d("+e+"px, 0, 0)";r.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==t?(r.css(o.animProp,a),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),A()})):"reset"==t?r.css(o.animProp,a):"ticker"==t&&(r.css("-"+o.cssPrefix+"-transition-timing-function","linear"),r.css(o.animProp,a),r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),w(n.resetValue,"reset",0),z()}))}else{var s={};s[o.animProp]=e,"slide"==t?r.animate(s,i,o.settings.easing,function(){A()}):"reset"==t?r.css(o.animProp,e):"ticker"==t&&r.animate(s,speed,"linear",function(){w(n.resetValue,"reset",0),z()})}},_=function(){for(var t="",i=g(),n=0;i>n;n++){var a="";o.settings.buildPager&&e.isFunction(o.settings.buildPager)?(a=o.settings.buildPager(n),o.pagerEl.addClass("bx-custom-pager")):(a=n+1,o.pagerEl.addClass("bx-default-pager")),t+='<div class="bx-pager-item"><a href="" data-slide-index="'+n+'" class="bx-pager-link">'+a+"</a></div>"}o.pagerEl.html(t)},k=function(){o.settings.pagerCustom?o.pagerEl=e(o.settings.pagerCustom):(o.pagerEl=e('<div class="bx-pager" />'),o.settings.pagerSelector?e(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("bx-has-pager").append(o.pagerEl),_()),o.pagerEl.delegate("a","click",P)},x=function(){o.controls.next=e('<a class="bx-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=e('<a class="bx-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click",E),o.controls.prev.bind("click",C),o.settings.nextSelector&&e(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&e(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=e('<div class="bx-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("bx-has-controls-direction").append(o.controls.directionEl))},T=function(){o.controls.start=e('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=e('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=e('<div class="bx-controls-auto" />'),o.controls.autoEl.delegate(".bx-start","click",M),o.controls.autoEl.delegate(".bx-stop","click",L),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?e(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("bx-has-controls-auto").append(o.controls.autoEl),$(o.settings.autoStart?"stop":"start")},S=function(){o.children.each(function(t){var i=e(this).find("img:first").attr("title");void 0!=i&&(""+i).length&&e(this).append('<div class="bx-caption"><span>'+i+"</span></div>")})},E=function(e){o.settings.auto&&r.stopAuto(),r.goToNextSlide(),e.preventDefault()},C=function(e){o.settings.auto&&r.stopAuto(),r.goToPrevSlide(),e.preventDefault()},M=function(e){r.startAuto(),e.preventDefault()},L=function(e){r.stopAuto(),e.preventDefault()},P=function(t){o.settings.auto&&r.stopAuto();var i=e(t.currentTarget),n=parseInt(i.attr("data-slide-index"));n!=o.active.index&&r.goToSlide(n),t.preventDefault()},D=function(t){var i=o.children.length;return"short"==o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),void o.pagerEl.html(t+1+o.settings.pagerShortSeparator+i)):(o.pagerEl.find("a").removeClass("active"),void o.pagerEl.each(function(i,n){e(n).find("a").eq(t).addClass("active")}))},A=function(){if(o.settings.infiniteLoop){var e="";0==o.active.index?e=o.children.eq(0).position():o.active.index==g()-1&&o.carousel?e=o.children.eq((g()-1)*y()).position():o.active.index==o.children.length-1&&(e=o.children.eq(o.children.length-1).position()),e&&("horizontal"==o.settings.mode?w(-e.left,"reset",0):"vertical"==o.settings.mode&&w(-e.top,"reset",0))}o.working=!1,o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)},$=function(e){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[e]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.bx-"+e+")").addClass("active"))},N=function(){1==g()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0==o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index==g()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},I=function(){if(o.settings.autoDelay>0){setTimeout(r.startAuto,o.settings.autoDelay)}else r.startAuto();o.settings.autoHover&&r.hover(function(){o.interval&&(r.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(r.startAuto(!0),o.autoPaused=null)})},O=function(){var t=0;if("next"==o.settings.autoDirection)r.append(o.children.clone().addClass("bx-clone"));else{r.prepend(o.children.clone().addClass("bx-clone"));var i=o.children.first().position();t="horizontal"==o.settings.mode?-i.left:-i.top}w(t,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&!o.usingCSS&&o.viewport.hover(function(){r.stop()},function(){var t=0;o.children.each(function(i){t+="horizontal"==o.settings.mode?e(this).outerWidth(!0):e(this).outerHeight(!0)});var i=o.settings.speed/t,n="horizontal"==o.settings.mode?"left":"top",a=i*(t-Math.abs(parseInt(r.css(n))));z(a)}),z()},z=function(e){speed=e?e:o.settings.speed;var t={left:0,top:0},i={left:0,top:0};"next"==o.settings.autoDirection?t=r.find(".bx-clone").first().position():i=o.children.first().position();var n="horizontal"==o.settings.mode?-t.left:-t.top,a="horizontal"==o.settings.mode?-i.left:-i.top,s={resetValue:a};w(n,"ticker",speed,s)},B=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart",j)},j=function(e){if(o.working)e.preventDefault();else{o.touch.originalPos=r.position();var t=e.originalEvent;o.touch.start.x=t.changedTouches[0].pageX,o.touch.start.y=t.changedTouches[0].pageY,o.viewport.bind("touchmove",R),o.viewport.bind("touchend",F)}},R=function(e){var t=e.originalEvent,i=Math.abs(t.changedTouches[0].pageX-o.touch.start.x),n=Math.abs(t.changedTouches[0].pageY-o.touch.start.y);if(3*i>n&&o.settings.preventDefaultSwipeX?e.preventDefault():3*n>i&&o.settings.preventDefaultSwipeY&&e.preventDefault(),"fade"!=o.settings.mode&&o.settings.oneToOneTouch){var a=0;if("horizontal"==o.settings.mode){var r=t.changedTouches[0].pageX-o.touch.start.x;a=o.touch.originalPos.left+r}else{var r=t.changedTouches[0].pageY-o.touch.start.y;a=o.touch.originalPos.top+r}w(a,"reset",0)}},F=function(e){o.viewport.unbind("touchmove",R);var t=e.originalEvent,i=0;if(o.touch.end.x=t.changedTouches[0].pageX,o.touch.end.y=t.changedTouches[0].pageY,"fade"==o.settings.mode){var n=Math.abs(o.touch.start.x-o.touch.end.x);n>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto())}else{var n=0;"horizontal"==o.settings.mode?(n=o.touch.end.x-o.touch.start.x,i=o.touch.originalPos.left):(n=o.touch.end.y-o.touch.start.y,i=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0==o.active.index&&n>0||o.active.last&&0>n)?w(i,"reset",200):Math.abs(n)>=o.settings.swipeThreshold?(0>n?r.goToNextSlide():r.goToPrevSlide(),r.stopAuto()):w(i,"reset",200)}o.viewport.unbind("touchend",F)},H=function(t){var i=e(window).width(),n=e(window).height();(s!=i||l!=n)&&(s=i,l=n,r.redrawSlider())};return r.goToSlide=function(t,i){if(!o.working&&o.active.index!=t)if(o.working=!0,o.oldIndex=o.active.index,0>t?o.active.index=g()-1:t>=g()?o.active.index=0:o.active.index=t,o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index),"next"==i?o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index):"prev"==i&&o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index),o.active.last=o.active.index>=g()-1,o.settings.pager&&D(o.active.index),o.settings.controls&&N(),"fade"==o.settings.mode)o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",51).fadeIn(o.settings.speed,function(){e(this).css("zIndex",50),A()});else{o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed);var n=0,a={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last)if("horizontal"==o.settings.mode){var s=o.children.eq(o.children.length-1);a=s.position(),n=o.viewport.width()-s.outerWidth()}else{var l=o.children.length-o.settings.minSlides;a=o.children.eq(l).position()}else if(o.carousel&&o.active.last&&"prev"==i){var c=1==o.settings.moveSlides?o.settings.maxSlides-y():(g()-1)*y()-(o.children.length-o.settings.maxSlides),s=r.children(".bx-clone").eq(c);a=s.position()}else if("next"==i&&0==o.active.index)a=r.find("> .bx-clone").eq(o.settings.maxSlides).position(),o.active.last=!1;else if(t>=0){var u=t*y();a=o.children.eq(u).position()}if("undefined"!=typeof a){var h="horizontal"==o.settings.mode?-(a.left-n):-a.top;w(h,"slide",o.settings.speed)}}},r.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var e=parseInt(o.active.index)+1;r.goToSlide(e,"next")}},r.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!=o.active.index){var e=parseInt(o.active.index)-1;r.goToSlide(e,"prev")}},r.startAuto=function(e){o.interval||(o.interval=setInterval(function(){"next"==o.settings.autoDirection?r.goToNextSlide():r.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&1!=e&&$("stop"))},r.stopAuto=function(e){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&1!=e&&$("start"))},r.getCurrentSlide=function(){return o.active.index},r.getSlideCount=function(){return o.children.length},r.redrawSlider=function(){o.children.add(r.find(".bx-clone")).outerWidth(m()),o.viewport.css("height",p()),o.settings.ticker||b(),o.active.last&&(o.active.index=g()-1),o.active.index>=g()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(_(),D(o.active.index))},r.destroySlider=function(){o.initialized&&(o.initialized=!1,e(".bx-clone",this).remove(),o.children.each(function(){void 0!=e(this).data("origStyle")?e(this).attr("style",e(this).data("origStyle")):e(this).removeAttr("style")}),void 0!=e(this).data("origStyle")?this.attr("style",e(this).data("origStyle")):e(this).removeAttr("style"),e(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.settings.controls&&o.pagerEl.remove(),e(".bx-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&e(window).unbind("resize",H))},r.reloadSlider=function(e){void 0!=e&&(a=e),r.destroySlider(),c()},c(),this}}(jQuery),define("bxslider",["jquery"],function(){}),define("views/ProductView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back","click .print-button":"print","click .print-discount-button":"printDiscount"},initialize:function(){this.$el.css({opacity:0})},_load:function(e){this.model.fetch({success:e,error:function(){throw new Error("can't load product view")}})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},_open:function(e){this.printAvailable=!0,this.printDiscountAvailable=!0,window.Firefly.trigger("map:locations:product",this.model.get("locations"));var i=this,n=this.$(".product-view-description");this.scroller=new o(n,n.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t(".bxslider").bxSlider({buildPager:function(){return'<div class="product-view-pager"></div>'},onSliderLoad:function(){i.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})}})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},print:function(){this.printAvailable&&(t.ajax({method:"POST",url:r("print")+"/"+this.model.get("id")+"?lang="+window.Firefly.lang()}),s.event("product:print",{id:this.model.get("id")}),this.printAvailable=!1)},printDiscount:function(){this.printDiscountAvailable&&(t.ajax({method:"POST",url:r("print/discount")+"/"+this.model.get("id")+"?lang="+window.Firefly.lang()}),s.event("product:print_discount",{id:this.model.get("id")}),this.printDiscountAvailable=!1)}})}),define("templates/ticket-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var i,n="";return n+='\n                <img src="'+m((i=e.venue,i=null==i||i===!1?i:i.image,typeof i===f?i.apply(e):i))+'"/>\n\n            '}function r(e,t){return'\n                <img src="/images/no-image.png">\n            '}function s(e,t){var n,a="";return a+='\n            <div class="ticket-view-desc"><span>',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===f?n.apply(e):n),a+=m(n)+": </span><span>",(n=i.value)?n=n.call(e,{hash:{},data:t}):(n=e.value,n=typeof n===f?n.apply(e):n),a+=m(n)+"</span></div>\n        "}function l(e,t){var i,n="";return n+='\n                <img src="'+m((i=e.images,i=null==i||i===!1?i:i[0],typeof i===f?i.apply(e):i))+'">\n            '}function c(e,t){var i,n="";return n+='\n                <div class="ticket-view-scheme">\n                    <h1>Схема зала</h1>\n                    <i class="light-arrow"></i>\n                    <i class="light-arrow"></i>\n                    <i class="light-arrow"></i>\n                    <div class="ticket-view-scheme-image">\n                        <button class="close"></button>\n                        <div class="ticket-view-scheme-image-wrapper">\n                            <img src="'+m((i=e.venue,i=null==i||i===!1?i:i.seating_plan_image,typeof i===f?i.apply(e):i))+'"/>\n                        </div>\n                    </div>\n                </div>\n            '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var u,h,d,p="",f="function",m=this.escapeExpression,v=i.helperMissing,g=this;return p+="<div class = 'ticket-view-header'>\n    <table>\n        <tr>\n            <td><span>"+m((u=t.venue,u=null==u||u===!1?u:u.name,typeof u===f?u.apply(t):u))+"</span></td>\n            <td><span>",d={hash:{},data:a},p+=m((u=i.ticketFormatDate,u?u.call(t,t.date,d):v.call(t,"ticketFormatDate",t.date,d)))+"</span></td>\n            <td><span>",(h=i.name)?h=h.call(t,{hash:{},data:a}):(h=t.name,h=typeof h===f?h.apply(t):h),p+=m(h)+"</span></td>\n        </tr>\n    </table>\n	<div class='ticket-view-companyName'></div>\n	<div class='ticket-view-eventDate'> </div>\n	<div class='ticket-view-eventName'></div>\n\n</div>\n\n<div class=\"ticket-view-wrapper\">\n\n    <div class=\"ticket-view-venue-image-wrapper\">\n        <div>\n            ",h=i["if"].call(t,(u=t.venue,null==u||u===!1?u:u.image),{hash:{},inverse:g.program(3,r,a),fn:g.program(1,o,a),data:a}),(h||0===h)&&(p+=h),p+='\n\n        </div>\n\n    </div>\n\n    <div class="ticket-view-desc-wrapper">\n        <div class="ticket-view-desc"> <span>Адрес: </span><span>'+m((u=t.venue,u=null==u||u===!1?u:u.address,typeof u===f?u.apply(t):u))+"</span></div>\n        ",h=i.each.call(t,t.fields,{hash:{},inverse:g.noop,fn:g.program(5,s,a),data:a}),(h||0===h)&&(p+=h),p+='\n\n    </div>\n\n    <div class="ticket-view-description ">\n        <p>',(h=i.descriptions)?h=h.call(t,{hash:{},data:a}):(h=t.descriptions,h=typeof h===f?h.apply(t):h),(h||0===h)&&(p+=h),p+='</p>\n    </div>\n    <div class="ticket-view-description-scroll">\n        <div class="ticket-view-description-scroll-knob">\n        </div>\n    </div>\n\n\n\n\n    <div class="ticket-view-event-image-wrapper">\n        <div>\n            ',h=i["if"].call(t,(u=t.images,null==u||u===!1?u:u[0]),{hash:{},inverse:g.program(3,r,a),fn:g.program(7,l,a),data:a}),(h||0===h)&&(p+=h),p+='\n        </div>\n    </div>\n        <div class = \'ticket-view-bottom-section\'>\n\n            <div class="ticket-view-table-head">\n                <div>категория</div>\n                <div>кол-во мест</div>\n                <div>цена</div>\n                <div>выбор</div>\n            </div>\n            <div class="table-dots">\n                <div></div>\n                <div></div>\n                <div></div>\n            </div>\n            <div class="spinner">\n                  <div class="spinner-container container1">\n                    <div class="circle1"></div>\n                    <div class="circle2"></div>\n                    <div class="circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n                <div class="spinner-container container2">\n                    <div class="circle1"></div>\n                    <div class="circle2"></div>\n                    <div class="circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n                <div class="spinner-container container3">\n                    <div class="circle1"></div>\n                    <div class="circle2"></div>\n                    <div class="circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n            </div>\n            <div class="ticket-view-table-wrapper">\n            </div>\n            ',h=i["if"].call(t,(u=t.venue,null==u||u===!1?u:u.seating_plan_image),{hash:{},inverse:g.noop,fn:g.program(9,c,a),data:a}),(h||0===h)&&(p+=h),p+='\n\n        <div class="ticket-view-table-scroll">\n            <div class="ticket-view-table-scroll-knob">\n            </div>\n        </div>\n        </div>\n\n</div>\n<div class="ticket-view-footer">\n    <a href="#main" class="home-button ticket-view-home-button"></a>\n    <button href="#main/confirmTicket" class="button ticket-view-buy-button">забронировать</button>\n\n</div>\n'})}),define("models/Event",["jquery","underscore","backbone","framework/utils/ticketBackend"],function(e,t,i){"use strict";return i.Model.extend({initialize:function(){},urlRoot:function(){}})}),define("collections/EventCollection",["backbone","models/Event","framework/utils/ticketBackend"],function(e,t,i){"use strict";return e.Collection.extend({initialize:function(){},model:t,url:function(){return i("events")}})}),define("collections/_eventCollection",["collections/EventCollection"],function(e){"use strict";return new e}),define("models/ticketCart",["underscore","backbone"],function(e,t){"use strict";var i=t.Collection.extend({url:"a",model:t.Model.extend({url:"a",defaults:{amount:1},validate:function(){},initialize:function(){},incrementAmount:function(){var e=this.get("amount");this.set("amount",e+1)},decrementAmount:function(){var e=this.get("amount");this.set("amount",--e),0===e&&this.collection.remove(this)}})});return{CONSTRAINT:6,model:{toJSON:function(){return{id:2,name:"ЗВЕЗДЫ ДЖАЗА",date:"2013-12-04T13:53:03.026Z",images:["1386943911358.jpg"],descriptions:"Нильс ЛАНДГРЕН Квартет и Камерный оркестр – это мировая премьера новой джазо-симфонической программы, которая состоится 28 февраля 2014 года в Светлановском зале Московского международного Дома музыки. В составе квартета всемирно-известные джазовые музыканты – Нильс ЛАНДГРЕН (Швеция), Ларс ДАНИЕЛЬССОН (Швеция), Себастьян СТУДНИЦКИЙ (Германия), Рани КРИЖА (Марокко). Выступление именитых джазовых музыкантов с оркестром вызывают большой интерес на международной сцене. Музыканты дают возможность по новому услышать полюбившиеся публике джазовые стандарты и популярные песни в джазово-симфоническом исполнении. Этот концерт пройдет в рамках международного проекта “ЗВЕЗДЫ JAZZ’A” благодаря сотрудничеству дирекции Московского международного Дома музыки и концертного агентства “Бон Фиеста”. Узнать больше: Купить билеты на концерт Звезды Джаза в Московский международный Дом музыки. Стоимость билетов на концерт Звезды Джаза в Москве без наценки! ",fields:[{name:"Режиссер",value:"Имя режиссера"},{name:"Актеры",value:"Список актеров"}],venue:{name:"ММДМ",address:"Космодамианская набережная, дом 52, строение 8, м. Павелецкая",image:"ММDM_1.jpg",seating_plan_image:"1348743538552.jpg"},ticketsWithSeats:[{id:2,type:"Партер",min_price:100,max_price:1e3,available:10,seats:!0},{id:2,type:"Партер",min_price:100,max_price:1e3,available:10,seats:!0}],ticketsWithoutSeats:[{id:1,type:"Входной билет!",min_price:1e3,max_price:1e3,available:40,seats:!1},{id:2,type:"Партер",min_price:100,max_price:1e3,available:10,seats:!0}]}}},initialize:function(n){this.initialized=!0,this.model=new t.Model,this.model.set({ticketsWithSeats:new i,ticketsWithoutSeats:new i,eventInfo:n.toJSON()}),e.bindAll(this,"addTicket","rmTicket"),this.model.toJSON=function(){var e=t.Model.prototype.toJSON.call(this),i={},n=Object.keys(e);return n.forEach(function(t){i[t]=e[t].toJSON?e[t].toJSON():e[t]}),i}},addTicket:function(e){var t=this.get(e);t?t.incrementAmount():this.getSuitableChosenTickets(e).add(e.toJSON()),
this.model.trigger("addTicket",e)},rmTicket:function(e,t){this.get(e).decrementAmount(),t||this.model.trigger("rmTicket",e)},calculateTotalSum:function(){function e(e){t+=(e.get("max_price")||e.get("price"))*e.get("amount")}var t=0;return this.model.get("ticketsWithSeats").forEach(function(t){e(t)}),this.model.get("ticketsWithoutSeats").forEach(function(t){e(t)}),this.model.set("total",t),t},calculateTotalTickets:function(){var e=0;return this.model.get("ticketsWithoutSeats").forEach(function(t){e+=t.get("amount")}),this.ticketsWithoutSeatsN=e,this.model.get("ticketsWithSeats").forEach(function(t){e+=t.get("amount")}),this.ticketsWithSeatsN=e-this.ticketsWithoutSeatsN,e},isEmpty:function(){return 0===this.calculateTotalTickets()},get:function(e){return this.getSuitableChosenTickets(e).get(e.id)},getById:function(e,t){return"undefined"==typeof t?this.model.get("ticketsWithoutSeats").get(e):this.model.get("ticketsWithSeats").get(t)},getByCategoryId:function(e){return this.model.get("ticketsWithSeats").where({categoryId:e})||[]},getSuitableChosenTickets:function(e){return this.model.get(e.get("seats")===!1?"ticketsWithoutSeats":"ticketsWithSeats")},getSuitableChosenTicketsAmount:function(e){return this.getSuitableChosenTickets(e).filter(this.filter).length},format:function(){var e={event_id:this.model.get("eventInfo").id,tickets:[]};return this.model.get("ticketsWithoutSeats").forEach(function(t){e.tickets.push({id:t.get("id"),amount:t.get("amount"),price:t.get("max_price")})}),this.model.get("ticketsWithSeats").forEach(function(t){e.tickets.push({seat_id:t.get("id"),id:t.get("categoryId")})}),e},formatStatistics:function(){var e={event_id:void 0,subevent_id:this.model.get("eventInfo").id,order_id:void 0,event_name:this.model.get("eventInfo").name,items:[]};return this.model.get("ticketsWithoutSeats").forEach(function(t){e.items.push({name:t.get("type"),price:t.get("max_price"),quantity:t.get("amount")})}),this.model.get("ticketsWithSeats").forEach(function(t){e.items.push({name:t.get("category"),price:t.get("price"),quantity:t.get("amount"),row:t.get("row"),seat:t.get("number")})}),e},destroy:function(){this.initialized=!1,this.model={}}}}),define("templates/ticket-view-table",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{},'<thead class="ticket-view-table-head">\n</thead>\n'})}),define("templates/ticket-view-table-row",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+="\n        ",(n=i.min_price)?n=n.call(e,{hash:{},data:t}):(n=e.min_price,n=typeof n===m?n.apply(e):n),a+=v(n)+" руб\n    "}function r(e,t){var n,a="";return a+="\n        ",(n=i.min_price)?n=n.call(e,{hash:{},data:t}):(n=e.min_price,n=typeof n===m?n.apply(e):n),a+=v(n)+"-",(n=i.max_price)?n=n.call(e,{hash:{},data:t}):(n=e.max_price,n=typeof n===m?n.apply(e):n),a+=v(n)+" руб\n    "}function s(e,t){var n,a="";return a+="\n    \n    <td>\n        ",n=i["if"].call(e,e.amount,{hash:{},inverse:g.program(8,c,t),fn:g.program(6,l,t),data:t}),(n||0===n)&&(a+=n),a+="\n    </button></td>\n\n"}function l(e,t){var n,a="";return a+=' \n            <button class="ticket-view-table-row-choose number"> <span>',(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===m?n.apply(e):n),a+=v(n)+" </span>\n        "}function c(e,t){return'\n            <button class="ticket-view-table-row-choose"><span>выбрать билет</span>\n        '}function u(e,t){var n,a="";return a+='\n    \n        <td> \n            <div class="ticket-view-choice-wrapper"> \n                <button class="ticket-view-table-choice-minus"></button> \n                <div>\n                    <div class="numbers-container" style="-webkit-transform:translateY(0px);">\n                        ',n=i["if"].call(e,e.amount,{hash:{},inverse:g.program(13,d,t),fn:g.program(11,h,t),data:t}),(n||0===n)&&(a+=n),a+='\n                    </div>\n                </div> \n                <button class="ticket-view-table-choice-plus"></button> \n            </div> \n        </td>                      \n'}function h(e,t){var n,a="";return a+="\n                        <span data-active='",(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===m?n.apply(e):n),a+=v(n)+"'>",(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===m?n.apply(e):n),a+=v(n)+"</span>\n                            "}function d(e,t){return"\n                        <span data-active='0'>0</span>    \n                        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var p,f="",m="function",v=this.escapeExpression,g=this;return f+="<td>",(p=i.type)?p=p.call(t,{hash:{},data:a}):(p=t.type,p=typeof p===m?p.apply(t):p),f+=v(p)+"</td> \n<td>",(p=i.available)?p=p.call(t,{hash:{},data:a}):(p=t.available,p=typeof p===m?p.apply(t):p),f+=v(p)+"</td> \n<td>\n    ",p=i["if"].call(t,t.equalPrices,{hash:{},inverse:g.program(3,r,a),fn:g.program(1,o,a),data:a}),(p||0===p)&&(f+=p),f+="\n</td>\n",p=i["if"].call(t,t.seats,{hash:{},inverse:g.program(10,u,a),fn:g.program(5,s,a),data:a}),(p||0===p)&&(f+=p),f})}),define("templates/ticket-view-hall-scheme",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var o,r="",s="function",l=this.escapeExpression;return r+='<div class="hall-scheme">\n    <h1>',(o=i.type)?o=o.call(t,{hash:{},data:a}):(o=t.type,o=typeof o===s?o.apply(t):o),r+=l(o)+'</h1>\n    <button class="close"></button>\n    <div class="hall-scheme-legend">\n        <div>\n            <div class="unavailable-ticket"></div>Занятые места\n        </div>\n    </div>\n\n    <div class="loading-indicator">\n            <img src="../images/clock.png">\n            <h1>подождите, идет загрузка</h1>\n            <div class="spinner">\n                  <div class="spinner-container container1">\n                    <div class="circle1"></div>\n                    <div class="circle2"></div>\n                    <div class="circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n                <div class="spinner-container container2">\n                    <div class="circle1"></div>\n                    <div class="circle2"></div>\n                    <div class="circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n                <div class="spinner-container container3">\n                    <div class="circle1"></div>\n                    <div class="circle2"></div>\n                    <div class="circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n            </div>\n    </div>\n    <div class="table-wrapper">\n        <div class="table-frame">\n            <div class="rows-numbers-wrapper">\n                <div class="rows-numbers"></div>\n                <div class="scene">Сцена</div>\n            </div>\n        </div>\n        <section></section>\n\n    </div>\n    <div class="hall-scheme-purchase-list"></div>\n\n</div>\n'})}),define("templates/ticket-view-hall-scheme-cell",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+=" \n    ",n=i["if"].call(e,e.available,{hash:{},inverse:d.program(4,s,t),fn:d.program(2,r,t),data:t}),(n||0===n)&&(a+=n),a+="\n"}function r(e,t){var n,a="";return a+=' \n        <div style="background:',(n=i.color)?n=n.call(e,{hash:{},data:t}):(n=e.color,n=typeof n===u?n.apply(e):n),a+=h(n)+'">',(n=i.number)?n=n.call(e,{hash:{},data:t}):(n=e.number,n=typeof n===u?n.apply(e):n),a+=h(n)+"</div>\n    "}function s(e,t){var n,a="";return a+='\n        <div class="unavailable-ticket">',(n=i.number)?n=n.call(e,{hash:{},data:t}):(n=e.number,n=typeof n===u?n.apply(e):n),a+=h(n)+"</div>\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var l,c="",u="function",h=this.escapeExpression,d=this;return l=i["if"].call(t,t.number,{hash:{},inverse:d.noop,fn:d.program(1,o,a),data:a}),(l||0===l)&&(c+=l),c+="\n"})}),define("templates/message-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){return'\n		<button class="message-close"></button>\n	'}function r(e,t){return'\n        <div class="spinner">\n              <div class="spinner-container container1">\n                <div class="circle1"></div>\n                <div class="circle2"></div>\n                <div class="circle3"></div>\n                <div class="circle4"></div>\n            </div>\n            <div class="spinner-container container2">\n                <div class="circle1"></div>\n                <div class="circle2"></div>\n                <div class="circle3"></div>\n                <div class="circle4"></div>\n            </div>\n            <div class="spinner-container container3">\n                <div class="circle1"></div>\n                <div class="circle2"></div>\n                <div class="circle3"></div>\n                <div class="circle4"></div>\n            </div>\n        </div>\n	'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var s,l="",c="function",u=this.escapeExpression,h=this;return l+='\n<div class="message">\n\n	<img src="',(s=i.img)?s=s.call(t,{hash:{},data:a}):(s=t.img,s=typeof s===c?s.apply(t):s),l+=u(s)+'">\n	<h1>',(s=i.header)?s=s.call(t,{hash:{},data:a}):(s=t.header,s=typeof s===c?s.apply(t):s),l+=u(s)+"</h1>\n	<p>",(s=i.message)?s=s.call(t,{hash:{},data:a}):(s=t.message,s=typeof s===c?s.apply(t):s),l+=u(s)+"</p>\n	",s=i["if"].call(t,t.closeBtn,{hash:{},inverse:h.noop,fn:h.program(1,o,a),data:a}),(s||0===s)&&(l+=s),l+="\n	",s=i["if"].call(t,t.spinner,{hash:{},inverse:h.noop,fn:h.program(3,r,a),data:a}),(s||0===s)&&(l+=s),l+="\n	\n</div>"})}),define("views/MessageView",["underscore","jquery","backbone","framework/View","templates/message-view"],function(e,t,i,n,a){"use strict";var o={img:"images/bang.png",header:"Внимание!",message:"",closeBtn:!0,spinner:!1};return n.extend({events:{"click .message-close":"closeMessage"},template:a,initialize:function(t){this.options=e.defaults(t,o),this.options.img&&!/^\/?images/.test(this.options.img)&&(this.options.img+="images")},closeMessage:function(){Firefly.viewport.hideMessage()},data:function(){return this.options},afterRender:function(){var e=this.options.dimensions;this.$msg=this.$el.find(".message"),this.$msg.css({opacity:0,scale:2}),e&&(e.width&&this.$msg.css({width:e.width,"margin-left":-e.width/2}),e.height&&this.$msg.css({height:e.height,"margin-top":-e.height/2}))},_open:function(e){this.$msg.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$msg.animate({opacity:0,scale:2},{complete:e})}})}),define("views/TicketViewHallScheme",["underscore","jquery","backbone","framework/View","templates/ticket-view-hall-scheme","framework/utils/ticketBackend","templates/ticket-view-hall-scheme-cell","models/ticketCart","framework/utils/scroller","views/MessageView","framework/utils/Scroll"],function(e,t,i,n,a,o,r,s,l,c,u){"use strict";function h(e){return e.color=w[e.id],e}function d(e){return t(p(e.map(h)))}function p(t){var i=e.template('<div><div style="background:#<%= color %>"></div> <span><%= price %> руб.</span></div>');return t[0]=i(t[0]),t.reduce(function(e,t){return e+i(t)})}function f(){return t('<div class="seat"></div>')}function m(){S.push(f())}function v(t){var i,n=S.pop()||f(),a=!!s.getById(void 0,t.id);return t.number?(n.text(t.number),t.available?n.css("background","#"+w[t.type]).addClass(a?"active":""):n.addClass("unavailable-ticket")):(n.addClass("no-seat"),n.text("0"),t.available=!1),e.extend(t,{el:n[0],active:a,price:_[t.type].price,category:k,categoryId:b}),i=new L(t),i.model=t,i}function g(e){return(+e%255).toString(16)}for(var y,b,w={},_={},k="",x={},T=["8CF0AC","8981E2","F1FF5E","FFCF75"],S=[],E=500,C=0,M={activeView:{},deltaHeight:60,deltaWidth:60},L=i.View.extend({toggled:!1,events:{mousedown:"toggleTicket",mouseup:"mouseup"},initialize:function(e){this.active=e.active,this.available=e.available},toggleTicket:function(e){var t=this;!e.fromElement&&this.available&&(M.activeView=x=this,this.toggled=!0,setTimeout(function(){t.toggled&&(x.$el.addClass("active"),x.toggled=!0)},100))},mouseup:function(e){if(!e.fromElement&&this.available){var t=x;setTimeout(function(){t.toggled&&(t.model instanceof i.Model||(t.model=new i.Model(t.model)),t.active?(t.$el.removeClass("active"),s.rmTicket(t.model),t.active=!1):s.calculateTotalTickets()<s.CONSTRAINT?(t.$el.addClass("active"),s.addTicket(t.model),t.active=!0):(Firefly.viewport.showMessage(new c({message:"невозможно выбрать больше "+s.CONSTRAINT+" билетов"})),t.$el.removeClass("active")))},200)}},removeTicket:function(){this.active=!1,this.$el.removeClass("active")},rollBack:function(){this.active||this.$el.removeClass("active"),this.toggled=!1}}),P=n.extend({initialize:function(t){e.extend(this,t),this.refHash={}},_close:function(e){this.cells&&this.cells.forEach(m),this.scroller.destroy(),this.purchaseList.remove(),e()},_open:function(e){var i=this.scroller=new u(this.$container,this.$schemeSection,M);this.purchaseList=new D({ticketsList:s.model.get("ticketsWithSeats").where({categoryId:b}),$parentEl:t(".hall-scheme-purchase-list")}),this.purchaseList.render(),this.listenTo(this.purchaseList,"rmTicket",function(e){this.cells[this.refHash[e.id]].removeTicket()},this),this.listenTo(this.purchaseList,"center",function(e){var t=this.cells[this.refHash[e.id]],n=t.$el.position().left,a=t.$el.parent(),o=(a.prevAll().length+1)*a.height(),r=t.$el.addClass("highlight-seat").one("webkitAnimationEnd",function(){r.removeClass("highlight-seat")});i.scrollTo(n-i.__clientWidth/2,o-i.__clientHeight/2,1e3)},this),e()},_load:function(e){var t=this,i=!1;this.listenTo(y,"transitionEnd",function(){i=!0}),setTimeout(function(){return t.model.set({rows:[{number:1,seats:[{available:!0,price:500,type:1,number:0,id:816010},{available:!0,price:500,type:1,number:0,id:351429},{available:!0,price:500,type:1,number:0,id:77407},{available:!0,price:500,type:1,number:0,id:740252},{available:!0,price:500,type:1,number:28,id:618917},{available:!0,price:500,type:1,number:27,id:680773},{available:!0,price:500,type:1,number:26,id:229216},{available:!0,price:500,type:1,number:25,id:578747},{available:!0,price:500,type:1,number:0,id:63935},{available:!0,price:500,type:1,number:24,id:939544},{available:!0,price:500,type:1,number:23,id:563559},{available:!0,price:500,type:1,number:22,id:355518},{available:!0,price:500,type:1,number:21,id:628695},{available:!0,price:500,type:1,number:20,id:601444},{available:!0,price:500,type:1,number:19,id:641371},{available:!0,price:500,type:1,number:18,id:785218},{available:!0,price:500,type:1,number:17,id:491270},{available:!0,price:500,type:1,number:16,id:318148},{available:!0,price:500,type:1,number:15,id:95751},{available:!0,price:500,type:1,number:14,id:209185},{available:!0,price:500,type:1,number:13,id:300624},{available:!0,price:500,type:1,number:12,id:283163},{available:!0,price:500,type:1,number:11,id:158907},{available:!0,price:500,type:1,number:10,id:110818},{available:!0,price:500,type:1,number:9,id:262631},{available:!0,price:500,type:1,number:8,id:714576},{available:!0,price:500,type:1,number:7,id:448549},{available:!0,price:500,type:1,number:6,id:138244},{available:!0,price:500,type:1,number:5,id:719731},{available:!0,price:500,type:1,number:4,id:667405},{available:!0,price:500,type:1,number:3,id:38386},{available:!0,price:500,type:1,number:2,id:601125},{available:!0,price:500,type:1,number:1,id:180995}]},{number:2,seats:[{available:!0,price:500,type:1,number:0,id:229847},{available:!0,price:500,type:1,number:0,id:158953},{available:!0,price:500,type:1,number:0,id:176167},{available:!0,price:500,type:1,number:0,id:103172},{available:!0,price:500,type:1,number:28,id:484624},{available:!0,price:500,type:1,number:27,id:412659},{available:!0,price:500,type:1,number:26,id:735119},{available:!0,price:500,type:1,number:25,id:859501},{available:!0,price:500,type:1,number:0,id:635101},{available:!0,price:500,type:1,number:24,id:447146},{available:!0,price:500,type:1,number:23,id:375582},{available:!0,price:500,type:1,number:22,id:127966},{available:!0,price:500,type:1,number:21,id:198411},{available:!0,price:500,type:1,number:20,id:790223},{available:!0,price:500,type:1,number:19,id:198256},{available:!0,price:500,type:1,number:18,id:288903},{available:!0,price:500,type:1,number:17,id:245994},{available:!0,price:500,type:1,number:16,id:268138},{available:!0,price:500,type:1,number:15,id:714829},{available:!0,price:500,type:1,number:14,id:802754},{available:!0,price:500,type:1,number:13,id:857602},{available:!0,price:500,type:1,number:12,id:756609},{available:!0,price:500,type:1,number:11,id:855785},{available:!0,price:500,type:1,number:10,id:778086},{available:!0,price:500,type:1,number:9,id:886472},{available:!0,price:500,type:1,number:8,id:543283},{available:!0,price:500,type:1,number:7,id:459992},{available:!0,price:500,type:1,number:6,id:741793},{available:!0,price:500,type:1,number:5,id:758946},{available:!0,price:500,type:1,number:4,id:281355},{available:!0,price:500,type:1,number:3,id:75480},{available:!0,price:500,type:1,number:2,id:640532},{available:!0,price:500,type:1,number:1,id:856052}]},{number:3,seats:[{available:!0,price:500,type:1,number:0,id:158552},{available:!0,price:500,type:1,number:0,id:280594},{available:!0,price:500,type:1,number:0,id:90582},{available:!0,price:500,type:1,number:0,id:489855},{available:!0,price:500,type:1,number:28,id:182366},{available:!0,price:500,type:1,number:27,id:71946},{available:!0,price:500,type:1,number:26,id:425367},{available:!0,price:500,type:1,number:25,id:478773},{available:!0,price:500,type:1,number:0,id:223672},{available:!0,price:500,type:1,number:24,id:328826},{available:!0,price:500,type:1,number:23,id:532992},{available:!0,price:500,type:1,number:22,id:215646},{available:!0,price:500,type:1,number:21,id:889304},{available:!0,price:500,type:1,number:20,id:786075},{available:!0,price:500,type:1,number:19,id:66077},{available:!0,price:500,type:1,number:18,id:610960},{available:!0,price:500,type:1,number:17,id:515835},{available:!0,price:500,type:1,number:16,id:306952},{available:!0,price:500,type:1,number:15,id:26102},{available:!0,price:500,type:1,number:14,id:519171},{available:!0,price:500,type:1,number:13,id:537227},{available:!0,price:500,type:1,number:12,id:344730},{available:!0,price:500,type:1,number:11,id:85746},{available:!0,price:500,type:1,number:10,id:464144},{available:!0,price:500,type:1,number:9,id:636441},{available:!0,price:500,type:1,number:8,id:983425},{available:!0,price:500,type:1,number:7,id:41324},{available:!0,price:500,type:1,number:6,id:736639},{available:!0,price:500,type:1,number:5,id:18925},{available:!0,price:500,type:1,number:4,id:441690},{available:!0,price:500,type:1,number:3,id:142869},{available:!0,price:500,type:1,number:2,id:949921},{available:!0,price:500,type:1,number:1,id:870117}]},{number:4,seats:[{available:!0,price:500,type:1,number:0,id:873007},{available:!0,price:500,type:1,number:0,id:309429},{available:!0,price:500,type:1,number:0,id:864435},{available:!0,price:500,type:1,number:29,id:968625},{available:!0,price:500,type:1,number:28,id:254540},{available:!0,price:500,type:1,number:27,id:701489},{available:!0,price:500,type:1,number:26,id:676397},{available:!0,price:500,type:1,number:25,id:416617},{available:!0,price:500,type:1,number:0,id:361605},{available:!0,price:500,type:1,number:24,id:493048},{available:!0,price:500,type:1,number:23,id:551576},{available:!0,price:500,type:1,number:22,id:705153},{available:!0,price:500,type:1,number:21,id:18006},{available:!0,price:500,type:1,number:20,id:132510},{available:!0,price:500,type:1,number:19,id:141748},{available:!0,price:500,type:1,number:18,id:223325},{available:!0,price:500,type:1,number:17,id:165369},{available:!0,price:500,type:1,number:16,id:731744},{available:!0,price:500,type:1,number:15,id:251598},{available:!0,price:500,type:1,number:14,id:11808},{available:!0,price:500,type:1,number:13,id:452183},{available:!0,price:500,type:1,number:12,id:659227},{available:!0,price:500,type:1,number:11,id:206633},{available:!0,price:500,type:1,number:10,id:536509},{available:!0,price:500,type:1,number:9,id:383994},{available:!0,price:500,type:1,number:8,id:68097},{available:!0,price:500,type:1,number:7,id:673932},{available:!0,price:500,type:1,number:6,id:279537},{available:!0,price:500,type:1,number:5,id:985623},{available:!0,price:500,type:1,number:4,id:310865},{available:!0,price:500,type:1,number:3,id:425724},{available:!0,price:500,type:1,number:2,id:227237},{available:!0,price:500,type:1,number:1,id:603153}]},{number:5,seats:[{available:!0,price:500,type:1,number:0,id:379823},{available:!0,price:500,type:1,number:0,id:681121},{available:!0,price:500,type:1,number:30,id:841186},{available:!0,price:500,type:1,number:29,id:164717},{available:!0,price:500,type:1,number:28,id:368022},{available:!0,price:500,type:1,number:27,id:202316},{available:!0,price:500,type:1,number:26,id:81035},{available:!0,price:500,type:1,number:25,id:165202},{available:!0,price:500,type:1,number:0,id:99336},{available:!0,price:500,type:1,number:24,id:844008},{available:!0,price:500,type:1,number:23,id:182523},{available:!0,price:500,type:1,number:22,id:292417},{available:!0,price:500,type:1,number:21,id:552216},{available:!0,price:500,type:1,number:20,id:477183},{available:!0,price:500,type:1,number:19,id:880605},{available:!0,price:500,type:1,number:18,id:762927},{available:!0,price:500,type:1,number:17,id:743260},{available:!0,price:500,type:1,number:16,id:841029},{available:!0,price:500,type:1,number:15,id:975561},{available:!0,price:500,type:1,number:14,id:17279},{available:!0,price:500,type:1,number:13,id:415959},{available:!0,price:500,type:1,number:12,id:681505},{available:!0,price:500,type:1,number:11,id:1251},{available:!0,price:500,type:1,number:10,id:802002},{available:!0,price:500,type:1,number:9,id:896467},{available:!0,price:500,type:1,number:8,id:353071},{available:!0,price:500,type:1,number:7,id:795430},{available:!0,price:500,type:1,number:6,id:952373},{available:!0,price:500,type:1,number:5,id:366466},{available:!0,price:500,type:1,number:4,id:815331},{available:!0,price:500,type:1,number:3,id:950342},{available:!0,price:500,type:1,number:2,id:249991},{available:!0,price:500,type:1,number:1,id:782777}]},{number:6,seats:[{available:!0,price:500,type:1,number:0,id:610377},{available:!0,price:500,type:1,number:31,id:945102},{available:!0,price:500,type:1,number:30,id:382174},{available:!0,price:500,type:1,number:29,id:543973},{available:!0,price:500,type:1,number:28,id:891837},{available:!0,price:500,type:1,number:27,id:140399},{available:!0,price:500,type:1,number:26,id:895502},{available:!0,price:500,type:1,number:25,id:14069},{available:!0,price:500,type:1,number:0,id:983734},{available:!0,price:500,type:1,number:24,id:928344},{available:!0,price:500,type:1,number:23,id:20611},{available:!0,price:500,type:1,number:22,id:301179},{available:!0,price:500,type:1,number:21,id:302364},{available:!0,price:500,type:1,number:20,id:172787},{available:!0,price:500,type:1,number:19,id:918796},{available:!0,price:500,type:1,number:18,id:340776},{available:!0,price:500,type:1,number:17,id:51123},{available:!0,price:500,type:1,number:16,id:966723},{available:!0,price:500,type:1,number:15,id:929406},{available:!0,price:500,type:1,number:14,id:411820},{available:!0,price:500,type:1,number:13,id:377784},{available:!0,price:500,type:1,number:12,id:885932},{available:!0,price:500,type:1,number:11,id:637534},{available:!0,price:500,type:1,number:10,id:771175},{available:!0,price:500,type:1,number:9,id:128509},{available:!0,price:500,type:1,number:8,id:852551},{available:!0,price:500,type:1,number:7,id:790991},{available:!0,price:500,type:1,number:6,id:917781},{available:!0,price:500,type:1,number:5,id:567644},{available:!0,price:500,type:1,number:4,id:230009},{available:!0,price:500,type:1,number:3,id:324848},{available:!0,price:500,type:1,number:2,id:13831},{available:!0,price:500,type:1,number:1,id:21587}]},{number:7,seats:[{available:!0,price:500,type:1,number:32,id:406688},{available:!0,price:500,type:1,number:31,id:757811},{available:!0,price:500,type:1,number:30,id:4121},{available:!0,price:500,type:1,number:29,id:164323},{available:!0,price:500,type:1,number:28,id:728969},{available:!0,price:500,type:1,number:27,id:294878},{available:!0,price:500,type:1,number:26,id:900631},{available:!0,price:500,type:1,number:25,id:142635},{available:!0,price:500,type:1,number:0,id:771665},{available:!0,price:500,type:1,number:24,id:250132},{available:!0,price:500,type:1,number:23,id:798467},{available:!0,price:500,type:1,number:22,id:823807},{available:!0,price:500,type:1,number:21,id:510430},{available:!0,price:500,type:1,number:20,id:290134},{available:!0,price:500,type:1,number:19,id:648152},{available:!0,price:500,type:1,number:18,id:185571},{available:!0,price:500,type:1,number:17,id:743664},{available:!0,price:500,type:1,number:16,id:210178},{available:!0,price:500,type:1,number:15,id:761124},{available:!0,price:500,type:1,number:14,id:911067},{available:!0,price:500,type:1,number:13,id:639286},{available:!0,price:500,type:1,number:12,id:126040},{available:!0,price:500,type:1,number:11,id:76186},{available:!0,price:500,type:1,number:10,id:802635},{available:!0,price:500,type:1,number:9,id:722306},{available:!0,price:500,type:1,number:8,id:726567},{available:!0,price:500,type:1,number:7,id:691113},{available:!0,price:500,type:1,number:6,id:550159},{available:!0,price:500,type:1,number:5,id:96675},{available:!0,price:500,type:1,number:4,id:940964},{available:!0,price:500,type:1,number:3,id:122308},{available:!0,price:500,type:1,number:2,id:768065},{available:!0,price:500,type:1,number:1,id:962267}]},{number:8,seats:[{available:!0,price:500,type:1,number:32,id:314659},{available:!0,price:500,type:1,number:31,id:433592},{available:!0,price:500,type:1,number:30,id:212011},{available:!0,price:500,type:1,number:29,id:147651},{available:!0,price:500,type:1,number:28,id:487782},{available:!0,price:500,type:1,number:27,id:568372},{available:!0,price:500,type:1,number:26,id:970633},{available:!0,price:500,type:1,number:25,id:829703},{available:!0,price:500,type:1,number:0,id:860955},{available:!0,price:500,type:1,number:24,id:878224},{available:!0,price:500,type:1,number:23,id:346023},{available:!0,price:500,type:1,number:22,id:116488},{available:!0,price:500,type:1,number:21,id:739857},{available:!0,price:500,type:1,number:20,id:514983},{available:!0,price:500,type:1,number:19,id:868440},{available:!0,price:500,type:1,number:18,id:928485},{available:!0,price:500,type:1,number:17,id:888372},{available:!0,price:500,type:1,number:16,id:4062},{available:!0,price:500,type:1,number:15,id:463004},{available:!0,price:500,type:1,number:14,id:330010},{available:!0,price:500,type:1,number:13,id:801639},{available:!0,price:500,type:1,number:12,id:640826},{available:!0,price:500,type:1,number:11,id:992638},{available:!0,price:500,type:1,number:10,id:714797},{available:!0,price:500,type:1,number:9,id:175475},{available:!0,price:500,type:1,number:8,id:123437},{available:!0,price:500,type:1,number:7,id:960961},{available:!0,price:500,type:1,number:6,id:509172},{available:!0,price:500,type:1,number:5,id:209635},{available:!0,price:500,type:1,number:4,id:5210},{available:!0,price:500,type:1,number:3,id:773473},{available:!0,price:500,type:1,number:2,id:167536},{available:!0,price:500,type:1,number:1,id:753606}]},{number:9,seats:[{available:!0,price:500,type:1,number:32,id:686522},{available:!0,price:500,type:1,number:31,id:145489},{available:!0,price:500,type:1,number:30,id:372324},{available:!0,price:500,type:1,number:29,id:852321},{available:!0,price:500,type:1,number:28,id:367482},{available:!0,price:500,type:1,number:27,id:989574},{available:!0,price:500,type:1,number:26,id:674567},{available:!0,price:500,type:1,number:25,id:894482},{available:!0,price:500,type:1,number:0,id:723441},{available:!0,price:500,type:1,number:24,id:418465},{available:!0,price:500,type:1,number:23,id:17059},{available:!0,price:500,type:1,number:22,id:985072},{available:!0,price:500,type:1,number:21,id:861559},{available:!0,price:500,type:1,number:20,id:644759},{available:!0,price:500,type:1,number:19,id:212911},{available:!0,price:500,type:1,number:18,id:990261},{available:!0,price:500,type:1,number:17,id:861960},{available:!0,price:500,type:1,number:16,id:408480},{available:!0,price:500,type:1,number:15,id:934603},{available:!0,price:500,type:1,number:14,id:427131},{available:!0,price:500,type:1,number:13,id:159406},{available:!0,price:500,type:1,number:12,id:825554},{available:!0,price:500,type:1,number:11,id:311880},{available:!0,price:500,type:1,number:10,id:176102},{available:!0,price:500,type:1,number:9,id:359468},{available:!0,price:500,type:1,number:8,id:323512},{available:!0,price:500,type:1,number:7,id:184738},{available:!0,price:500,type:1,number:6,id:225310},{available:!0,price:500,type:1,number:5,id:799832},{available:!0,price:500,type:1,number:4,id:164636},{available:!0,price:500,type:1,number:3,id:632229},{available:!0,price:500,type:1,number:2,id:693303},{available:!0,price:500,type:1,number:1,id:154954}]},{number:10,seats:[{available:!0,price:500,type:1,number:32,id:298468},{available:!0,price:500,type:1,number:31,id:510716},{available:!0,price:500,type:1,number:30,id:572078},{available:!0,price:500,type:1,number:29,id:620080},{available:!0,price:500,type:1,number:28,id:332531},{available:!0,price:500,type:1,number:27,id:579983},{available:!0,price:500,type:1,number:26,id:588510},{available:!0,price:500,type:1,number:25,id:189652},{available:!0,price:500,type:1,number:0,id:937562},{available:!0,price:500,type:1,number:24,id:260999},{available:!0,price:500,type:1,number:23,id:52509},{available:!0,price:500,type:1,number:22,id:618247},{available:!0,price:500,type:1,number:21,id:184854},{available:!0,price:500,type:1,number:20,id:175114},{available:!0,price:500,type:1,number:19,id:64515},{available:!0,price:500,type:1,number:18,id:125159},{available:!0,price:500,type:1,number:17,id:213763},{available:!0,price:500,type:1,number:16,id:318748},{available:!0,price:500,type:1,number:15,id:855611},{available:!0,price:500,type:1,number:14,id:507632},{available:!0,price:500,type:1,number:13,id:658753},{available:!0,price:500,type:1,number:12,id:956008},{available:!0,price:500,type:1,number:11,id:659352},{available:!0,price:500,type:1,number:10,id:76228},{available:!0,price:500,type:1,number:9,id:713934},{available:!0,price:500,type:1,number:8,id:274982},{available:!0,price:500,type:1,number:7,id:970006},{available:!0,price:500,type:1,number:6,id:850219},{available:!0,price:500,type:1,number:5,id:838698},{available:!0,price:500,type:1,number:4,id:416999},{available:!0,price:500,type:1,number:3,id:75139},{available:!0,price:500,type:1,number:2,id:556986},{available:!0,price:500,type:1,number:1,id:381923}]},{number:11,seats:[{available:!0,price:500,type:1,number:32,id:905838},{available:!0,price:500,type:1,number:31,id:522911},{available:!0,price:500,type:1,number:30,id:913934},{available:!0,price:500,type:1,number:29,id:851207},{available:!0,price:500,type:1,number:28,id:50843},{available:!0,price:500,type:1,number:27,id:535221},{available:!0,price:500,type:1,number:26,id:462239},{available:!0,price:500,type:1,number:25,id:902619},{available:!0,price:500,type:1,number:0,id:687529},{available:!0,price:500,type:1,number:24,id:907703},{available:!0,price:500,type:1,number:23,id:97582},{available:!0,price:500,type:1,number:22,id:637443},{available:!0,price:500,type:1,number:21,id:708091},{available:!0,price:500,type:1,number:20,id:58962},{available:!0,price:500,type:1,number:19,id:690060},{available:!0,
price:500,type:1,number:18,id:722857},{available:!0,price:500,type:1,number:17,id:492621},{available:!0,price:500,type:1,number:16,id:683607},{available:!0,price:500,type:1,number:15,id:863764},{available:!0,price:500,type:1,number:14,id:759820},{available:!0,price:500,type:1,number:13,id:875644},{available:!0,price:500,type:1,number:12,id:666402},{available:!0,price:500,type:1,number:11,id:22839},{available:!0,price:500,type:1,number:10,id:199396},{available:!0,price:500,type:1,number:9,id:310684},{available:!0,price:500,type:1,number:8,id:940369},{available:!0,price:500,type:1,number:7,id:92645},{available:!0,price:500,type:1,number:6,id:262518},{available:!0,price:500,type:1,number:5,id:200276},{available:!0,price:500,type:1,number:4,id:846563},{available:!0,price:500,type:1,number:3,id:820261},{available:!0,price:500,type:1,number:2,id:43315},{available:!0,price:500,type:1,number:1,id:735524}]},{number:12,seats:[{available:!0,price:500,type:1,number:32,id:401910},{available:!0,price:500,type:1,number:31,id:699046},{available:!0,price:500,type:1,number:30,id:781543},{available:!0,price:500,type:1,number:29,id:235820},{available:!0,price:500,type:1,number:28,id:488959},{available:!0,price:500,type:1,number:27,id:5172},{available:!0,price:500,type:1,number:26,id:547129},{available:!0,price:500,type:1,number:25,id:19639},{available:!0,price:500,type:1,number:0,id:289489},{available:!0,price:500,type:1,number:24,id:94745},{available:!0,price:500,type:1,number:23,id:223136},{available:!0,price:500,type:1,number:22,id:18165},{available:!0,price:500,type:1,number:21,id:354012},{available:!0,price:500,type:1,number:20,id:795590},{available:!0,price:500,type:1,number:19,id:676830},{available:!0,price:500,type:1,number:18,id:380996},{available:!0,price:500,type:1,number:17,id:167605},{available:!0,price:500,type:1,number:16,id:554206},{available:!0,price:500,type:1,number:15,id:802149},{available:!0,price:500,type:1,number:14,id:403723},{available:!0,price:500,type:1,number:13,id:3010},{available:!0,price:500,type:1,number:12,id:594243},{available:!0,price:500,type:1,number:11,id:229707},{available:!0,price:500,type:1,number:10,id:902211},{available:!0,price:500,type:1,number:9,id:289536},{available:!0,price:500,type:1,number:8,id:965280},{available:!0,price:500,type:1,number:7,id:383910},{available:!0,price:500,type:1,number:6,id:632520},{available:!0,price:500,type:1,number:5,id:276361},{available:!0,price:500,type:1,number:4,id:159658},{available:!0,price:500,type:1,number:3,id:32590},{available:!0,price:500,type:1,number:2,id:392976},{available:!0,price:500,type:1,number:1,id:945180}]},{number:13,seats:[{available:!0,price:500,type:1,number:32,id:511300},{available:!0,price:500,type:1,number:31,id:854126},{available:!0,price:500,type:1,number:30,id:364646},{available:!0,price:500,type:1,number:29,id:576867},{available:!0,price:500,type:1,number:28,id:62856},{available:!0,price:500,type:1,number:27,id:381614},{available:!0,price:500,type:1,number:26,id:695556},{available:!0,price:500,type:1,number:25,id:602126},{available:!0,price:500,type:1,number:0,id:556960},{available:!0,price:500,type:1,number:24,id:774206},{available:!0,price:500,type:1,number:23,id:478268},{available:!0,price:500,type:1,number:22,id:153208},{available:!0,price:500,type:1,number:21,id:180678},{available:!0,price:500,type:1,number:20,id:294879},{available:!0,price:500,type:1,number:19,id:987083},{available:!0,price:500,type:1,number:18,id:787088},{available:!0,price:500,type:1,number:17,id:787016},{available:!0,price:500,type:1,number:16,id:985354},{available:!0,price:500,type:1,number:15,id:613176},{available:!0,price:500,type:1,number:14,id:31883},{available:!0,price:500,type:1,number:13,id:288142},{available:!0,price:500,type:1,number:12,id:802082},{available:!0,price:500,type:1,number:11,id:500803},{available:!0,price:500,type:1,number:10,id:853992},{available:!0,price:500,type:1,number:9,id:437281},{available:!0,price:500,type:1,number:8,id:722664},{available:!0,price:500,type:1,number:7,id:844694},{available:!0,price:500,type:1,number:6,id:930756},{available:!0,price:500,type:1,number:5,id:889460},{available:!0,price:500,type:1,number:4,id:222398},{available:!0,price:500,type:1,number:3,id:112370},{available:!0,price:500,type:1,number:2,id:133642},{available:!0,price:500,type:1,number:1,id:161081}]},{number:14,seats:[{available:!0,price:500,type:1,number:32,id:519031},{available:!0,price:500,type:1,number:31,id:587718},{available:!0,price:500,type:1,number:30,id:386149},{available:!0,price:500,type:1,number:29,id:580350},{available:!0,price:500,type:1,number:28,id:248114},{available:!0,price:500,type:1,number:27,id:26205},{available:!0,price:500,type:1,number:26,id:882525},{available:!0,price:500,type:1,number:25,id:365379},{available:!0,price:500,type:1,number:0,id:214315},{available:!0,price:500,type:1,number:24,id:712237},{available:!0,price:500,type:1,number:23,id:116539},{available:!0,price:500,type:1,number:22,id:492504},{available:!0,price:500,type:1,number:21,id:520769},{available:!0,price:500,type:1,number:20,id:283353},{available:!0,price:500,type:1,number:19,id:411295},{available:!0,price:500,type:1,number:18,id:945128},{available:!0,price:500,type:1,number:17,id:372623},{available:!0,price:500,type:1,number:16,id:532819},{available:!0,price:500,type:1,number:15,id:566020},{available:!0,price:500,type:1,number:14,id:243542},{available:!0,price:500,type:1,number:13,id:984953},{available:!0,price:500,type:1,number:12,id:52718},{available:!0,price:500,type:1,number:11,id:47940},{available:!0,price:500,type:1,number:10,id:749886},{available:!0,price:500,type:1,number:9,id:685508},{available:!0,price:500,type:1,number:8,id:571796},{available:!0,price:500,type:1,number:7,id:337314},{available:!0,price:500,type:1,number:6,id:321559},{available:!0,price:500,type:1,number:5,id:795109},{available:!0,price:500,type:1,number:4,id:808888},{available:!0,price:500,type:1,number:3,id:475339},{available:!0,price:500,type:1,number:2,id:608543},{available:!0,price:500,type:1,number:1,id:292957}]},{number:15,seats:[{available:!0,price:500,type:1,number:32,id:413497},{available:!0,price:500,type:1,number:31,id:198262},{available:!0,price:500,type:1,number:30,id:262966},{available:!0,price:500,type:1,number:29,id:10243},{available:!0,price:500,type:1,number:28,id:570281},{available:!0,price:500,type:1,number:27,id:811122},{available:!0,price:500,type:1,number:26,id:895017},{available:!0,price:500,type:1,number:25,id:384068},{available:!0,price:500,type:1,number:0,id:627171},{available:!0,price:500,type:1,number:24,id:216584},{available:!0,price:500,type:1,number:23,id:144101},{available:!0,price:500,type:1,number:22,id:586073},{available:!0,price:500,type:1,number:21,id:313089},{available:!0,price:500,type:1,number:20,id:397427},{available:!0,price:500,type:1,number:19,id:121429},{available:!0,price:500,type:1,number:18,id:705528},{available:!0,price:500,type:1,number:17,id:889478},{available:!0,price:500,type:1,number:16,id:300174},{available:!0,price:500,type:1,number:15,id:871125},{available:!0,price:500,type:1,number:14,id:53},{available:!0,price:500,type:1,number:13,id:392490},{available:!0,price:500,type:1,number:12,id:666484},{available:!0,price:500,type:1,number:11,id:37068},{available:!0,price:500,type:1,number:10,id:963418},{available:!0,price:500,type:1,number:9,id:957273},{available:!0,price:500,type:1,number:8,id:276026},{available:!0,price:500,type:1,number:7,id:289234},{available:!0,price:500,type:1,number:6,id:767346},{available:!0,price:500,type:1,number:5,id:656163},{available:!0,price:500,type:1,number:4,id:80176},{available:!0,price:500,type:1,number:3,id:139507},{available:!0,price:500,type:1,number:2,id:367231},{available:!0,price:500,type:1,number:1,id:313959}]},{number:16,seats:[{available:!0,price:500,type:1,number:32,id:999123},{available:!0,price:500,type:1,number:31,id:367332},{available:!0,price:500,type:1,number:30,id:580143},{available:!0,price:500,type:1,number:29,id:855343},{available:!0,price:500,type:1,number:28,id:154241},{available:!0,price:500,type:1,number:27,id:986923},{available:!0,price:500,type:1,number:26,id:550393},{available:!0,price:500,type:1,number:25,id:658233},{available:!0,price:500,type:1,number:0,id:502570},{available:!0,price:500,type:1,number:24,id:383281},{available:!0,price:500,type:1,number:23,id:504676},{available:!0,price:500,type:1,number:22,id:339771},{available:!0,price:500,type:1,number:21,id:750596},{available:!0,price:500,type:1,number:20,id:410998},{available:!0,price:500,type:1,number:19,id:190364},{available:!0,price:500,type:1,number:18,id:590097},{available:!0,price:500,type:1,number:17,id:145423},{available:!0,price:500,type:1,number:16,id:679494},{available:!0,price:500,type:1,number:15,id:722741},{available:!0,price:500,type:1,number:14,id:471693},{available:!0,price:500,type:1,number:13,id:214904},{available:!0,price:500,type:1,number:12,id:583873},{available:!0,price:500,type:1,number:11,id:420770},{available:!0,price:500,type:1,number:10,id:900715},{available:!0,price:500,type:1,number:9,id:308092},{available:!0,price:500,type:1,number:8,id:692360},{available:!0,price:500,type:1,number:7,id:652147},{available:!0,price:500,type:1,number:6,id:608797},{available:!0,price:500,type:1,number:5,id:737603},{available:!0,price:500,type:1,number:4,id:738640},{available:!0,price:500,type:1,number:3,id:924150},{available:!0,price:500,type:1,number:2,id:361969},{available:!0,price:500,type:1,number:1,id:294959}]},{number:17,seats:[{available:!0,price:500,type:1,number:32,id:379745},{available:!0,price:500,type:1,number:31,id:456350},{available:!0,price:500,type:1,number:30,id:788955},{available:!0,price:500,type:1,number:29,id:837466},{available:!0,price:500,type:1,number:28,id:273580},{available:!0,price:500,type:1,number:27,id:241914},{available:!0,price:500,type:1,number:26,id:507971},{available:!0,price:500,type:1,number:25,id:800452},{available:!0,price:500,type:1,number:0,id:58800},{available:!0,price:500,type:1,number:24,id:785043},{available:!0,price:500,type:1,number:23,id:245288},{available:!0,price:500,type:1,number:22,id:424975},{available:!0,price:500,type:1,number:21,id:12358},{available:!0,price:500,type:1,number:20,id:389257},{available:!0,price:500,type:1,number:19,id:486760},{available:!0,price:500,type:1,number:18,id:137015},{available:!0,price:500,type:1,number:17,id:51654},{available:!0,price:500,type:1,number:16,id:802645},{available:!0,price:500,type:1,number:15,id:84863},{available:!0,price:500,type:1,number:14,id:30067},{available:!0,price:500,type:1,number:13,id:904408},{available:!0,price:500,type:1,number:12,id:937540},{available:!0,price:500,type:1,number:11,id:73546},{available:!0,price:500,type:1,number:10,id:632627},{available:!0,price:500,type:1,number:9,id:515367},{available:!0,price:500,type:1,number:8,id:975670},{available:!0,price:500,type:1,number:7,id:694002},{available:!0,price:500,type:1,number:6,id:96013},{available:!0,price:500,type:1,number:5,id:611084},{available:!0,price:500,type:1,number:4,id:580445},{available:!0,price:500,type:1,number:3,id:562839},{available:!0,price:500,type:1,number:2,id:558753},{available:!0,price:500,type:1,number:1,id:703452}]},{number:18,seats:[{available:!0,price:500,type:1,number:32,id:756547},{available:!0,price:500,type:1,number:31,id:898549},{available:!0,price:500,type:1,number:30,id:698662},{available:!0,price:500,type:1,number:29,id:657500},{available:!0,price:500,type:1,number:28,id:637036},{available:!0,price:500,type:1,number:27,id:252789},{available:!0,price:500,type:1,number:26,id:34439},{available:!0,price:500,type:1,number:25,id:865796},{available:!0,price:500,type:1,number:0,id:271644},{available:!0,price:500,type:1,number:24,id:476656},{available:!0,price:500,type:1,number:23,id:706},{available:!0,price:500,type:1,number:22,id:189932},{available:!0,price:500,type:1,number:21,id:669316},{available:!0,price:500,type:1,number:20,id:809809},{available:!0,price:500,type:1,number:19,id:294884},{available:!0,price:500,type:1,number:18,id:20342},{available:!0,price:500,type:1,number:17,id:581043},{available:!0,price:500,type:1,number:16,id:626142},{available:!0,price:500,type:1,number:15,id:441702},{available:!0,price:500,type:1,number:14,id:989604},{available:!0,price:500,type:1,number:13,id:525513},{available:!0,price:500,type:1,number:12,id:221892},{available:!0,price:500,type:1,number:11,id:520631},{available:!0,price:500,type:1,number:10,id:628986},{available:!0,price:500,type:1,number:9,id:795408},{available:!0,price:500,type:1,number:8,id:653378},{available:!0,price:500,type:1,number:7,id:699281},{available:!0,price:500,type:1,number:6,id:851928},{available:!0,price:500,type:1,number:5,id:275982},{available:!0,price:500,type:1,number:4,id:85534},{available:!0,price:500,type:1,number:3,id:386424},{available:!0,price:500,type:1,number:2,id:512768},{available:!0,price:500,type:1,number:1,id:850339}]}],types:[{price:500,id:0},{price:800,id:1}]}),t.generateColors(),i?void e():void t.listenToOnce(y,"transitionEnd",function(){e()})},500)},afterRender:function(){var e,i,n,a=this,o=this.model,r=this.$container=t(".table-wrapper"),s=this.$schemeSection=this.$el.find("section").css("opacity",0),l=a.$(".rows-numbers");this.cells=[],k=o.get("type"),_=o.get("types"),o.get("rows").forEach(function(n){i=t("<div>"),l.append(t("<div>").text(n.number)),n.seats.forEach(function(t){t.row=n.number,e=v(t),a.refHash[t.id]=a.cells.length,a.cells.push(e),i.append(e.$el)}),s.append(i)}),n=d(o.get("types")).css("opacity",0).appendTo(t(".hall-scheme-legend")),t(".loading-indicator").animate({opacity:0},{done:function(){this.remove(),r.css("box-shadow","inset 0px 0px 270px #FFF"),t(".table-frame").css("opacity",1),s.animate({opacity:1}),n.animate({opacity:1})}}),M.callback=function(e,t,i){0>=e?l.addClass("inactive"):l.removeClass("inactive"),l[0].style.WebkitTransform="translate3d(0px,"+-t+"px,0) scale("+i+")"}},generateColors:function(){this.model.get("types").forEach(function(e,t){w[e.id]=T[t]||Math.random().toString().slice(2,11).match(/(\d{3})/g).map(g).join("")})}}),D=i.View.extend({tagName:"table",initialize:function(e){return this.$rows={},this.ticketsList=e.ticketsList,this.$parentEl=e.$parentEl,this.listenTo(s.model,"rmTicket",function(e){this.removeRow(e)}),this.listenTo(s.model,"addTicket",function(e){this.addRow(e)}),this.transitionDelay=100,this},render:function(){return this.$parentEl.append(this.$el),this.ticketsList.forEach(this.addRow,this),this.transitionDelay=0,this},addRow:function(e){var t=new A({model:e,purchaseList:this});this.$rows[e.id]=t,this.$el.append(t.render().$el.css({height:0,opacity:0,translate:[-500,0],transitionDelay:this.transitionDelay+"ms"})),t.$el.animate({height:32,opacity:1}),t.$el.css({translate:[0,0]}),this.transitionDelay&&(this.transitionDelay+=100)},removeRow:function(e){this.$rows[e.id].removeTicket()}}),A=i.View.extend({tagName:"tr",events:{"click .center-button":"center"},template:e.template('<td>РЯД <%= row %></td><td>МЕСТО <%= number %></td><td><%= price %> р.</td><td><button class="center-button">перейти</button></td><td><button class="remove-button">убрать</button></td>'),initialize:function(t){return e.extend(this,t),this},center:function(){this.purchaseList.trigger("center",this.model)},render:function(){return this.$el.html(this.template(this.model.toJSON())).find(".remove-button").one("click",this.removeTicket.bind(this)),this},removeTicket:function(e){var t=this;e&&(s.rmTicket(this.model,!0),this.purchaseList.trigger("rmTicket",this.model)),this.$el.animate({opacity:0,translate:[-600,0],duration:1e3,height:0},{done:function(){t.remove.call(t)}})}});E>C;C++)S.push(f());return n.extend({template:a,className:"hall-scheme-wrapper",events:{"click .close":"hide"},hide:function(){Firefly.viewport.hideModal()},subviews:{},initialize:function(e){y=this,this.model=e.model,b=e.model.id,this.subviews.scheme=new P({model:this.model})},_close:function(e){var i=this;t(".hall-scheme").toggleClass("show-hall-scheme"),Firefly.viewport.currentView.$el.removeClass("blockElement"),Firefly.viewport.hideMessage(),this.$el.one("webkitTransitionEnd",function(){i.trigger("changeAmount"),i.subviews.scheme.close(),e()})},_open:function(e){var t=this,i=this.$el.find(".hall-scheme");this.subviews.scheme.$el=this.$el.find(".table-wrapper"),setTimeout(function(){Firefly.viewport.currentView.$el.addClass("blockElement"),i.addClass("show-hall-scheme")},0),i.on("webkitTransitionEnd",function(){t.trigger("transitionEnd"),e()}),this.subviews.scheme.open()}})}),define("views/TicketViewTable",["underscore","jquery","backbone","framework/View","templates/ticket-view-table","templates/ticket-view-table-row","models/ticketCart","framework/utils/ticketBackend","views/TicketViewHallScheme","views/MessageView","framework/utils/Scroll"],function(e,t,i,n,a,o,r,s,l,c,u){"use strict";function h(e){return function(t){t.render().$el.appendTo(e.$el)}}function d(e){return new m({model:e})}var p,f={},m=i.View.extend({tagName:"tr",events:{"mousedown .ticket-view-table-choice-plus, .ticket-view-table-choice-minus, .ticket-view-table-row-choose":"toggle","mouseup .ticket-view-table-choice-plus":"clickPlus","mouseup .ticket-view-table-choice-minus":"clickMinus","mouseup .ticket-view-table-row-choose":"showScheme"},deltaY:18,initialize:function(){},toggle:function(e){if(!e.fromElement){var i=this;this.$button=t(e.currentTarget),f.activeView=p=this,this.toggled=!0,setTimeout(function(){i.toggled&&i.$button.addClass("active")},40)}},rollBack:function(){this.toggled=!1,this.$button.removeClass("active")},showScheme:function(){if(f.activeView.toggled){var e,i=this,n=r.getByCategoryId(this.model.get("id")).length,a=new l({model:this.model});this.listenToOnce(a,"changeAmount",function(){r.initialized&&(e=r.getByCategoryId(this.model.get("id")).length)!==n&&i.$el.find("span").animate({opacity:0},{done:function(){var i=this;0===e?(t(i).parent().removeClass("number"),t(i).css("color","transparent").text("").animate({opacity:1},{done:function(){t(i).css("color","rgb(65, 64, 64)").text("выбрать билет").css("color","rgb(65, 64, 64)")}})):t(i).text(e).animate({opacity:1}).parent().addClass("number")}},1e3)}),Firefly.viewport.showModal(a),this.rollBack()}},render:function(){var t={},i=r.get(this.model);return this.model.get("seats")?e.extend(t,{amount:r.getByCategoryId(this.model.id).length||0}):i&&e.extend(t,{amount:i.get("amount")}),e.extend(t,this.model.toJSON()),this.$el.html(o(t)),this},remove:function(){this.$el.hide(300,function(){this.remove()})},clickMinus:function(e){!e.fromElement&&this.toggled&&(f.activeView=this,function(e,t,i,n){if(0!==e){var a=t.find("span[data-active]");0===a.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),a.removeAttr("data-active"),a.prev().attr("data-active",e-1),t.css("transform","translateY("+(a.prevAll().length-1)*-i+"px)"),r.rmTicket(n.model)}}(+this.$el.find("span[data-active]").attr("data-active"),this.$el.find(".numbers-container"),this.deltaY,this),this.rollBack())},clickPlus:function(e){if(!e.fromElement&&this.toggled){this.rollBack(),f.activeView=this;var t=r.get(this.model)||this.model,i=t.get("amount")||0,n=t.get("available");if(r.calculateTotalTickets()>=r.CONSTRAINT)return void Firefly.viewport.showMessage(new c({message:"невозможно выбрать больше "+r.CONSTRAINT+" билетов"}));if(i>=n)return void Firefly.viewport.showMessage(new c({message:"в данной категории доступно только "+n+" билетов"}));!function(e,i,n){var a=i.find("span[data-active]");0===a.next().length&&i.append("<span>"+(e+1)),a.removeAttr("data-active"),a.next().attr("data-active",e+1),i.css("transform","translateY("+(a.prevAll().length+1)*-n+"px)"),0===a.next().length&&i.append("<span>"+(e+1)),r.addTicket(t)}(+this.$el.find("span[data-active]").attr("data-active"),this.$el.find(".numbers-container"),this.deltaY)}}}),v=i.Model.extend({initialize:function(){this.url=this.url()+"/seats"}}),g=i.Collection.extend({initialize:function(e){this.id=e},url:function(){return s("events/")+this.id+"/tickets"},model:v});return n.extend({template:a,className:"ticket-view-table",tagName:"table",url:"",initialize:function(e){this.ticketId=e.ticketId,this.open()},afterRender:function(){Firefly.viewport.hideMessage(),t(".ticket-view-table-wrapper").prepend(this.$el),this.collection&&this.collection.map(d).forEach(h(this)),e.extend(f,{scrollbar:{$scroll:t(".ticket-view-table-scroll"),$scrollKnob:t(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}})},_open:function(e){var i=t(".ticket-view-table-wrapper"),n=t(".ticket-view-table");this.$el.css("opacity",0),this.scroller=new u(i,n,f),e()},_close:function(e){this.scroller.destroy(),e()},_load:function(e){var i=this;this.collection=new g(this.ticketId),this.collection.reset([{id:9,type:"Зал",min_price:260,max_price:280,available:55,seats:!0}]),setTimeout(function(){t(".spinner").animate({scale:.2,opacity:0},{duration:500,done:function(){t(this).remove(),t(".table-dots").css("opacity",1),i.$el.animate({opacity:1}),e()}})},500)}})}),define("views/TicketView",["underscore","jquery","framework/View","templates/ticket-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView","models/Event"],function(e,t,i,n,a,o,r,s,l,c,u,h,d,p){"use strict";var f,m=i.extend({events:{"click .close":"hide"},hide:function(){Firefly.viewport.hideModal()},_close:function(e){var i=this;this.$el.removeClass("animateScheme"),Firefly.viewport.modal||Firefly.viewport.currentView.$el.removeClass("blockElement"),i.$(".close").animate({opacity:0},{done:function(){t(this).css("display","none")}}),f.$el.one("webkitTransitionEnd",function(){i.img.one("click",function(){Firefly.viewport.showModal(i)}),e(),Firefly.viewport.currentView.$el.prepend(f.$el)}),f.img.one("webkitTransitionEnd",function(e){e.stopPropagation()})},_open:function(e){var t=this;setTimeout(function(){f.$el.one("webkitTransitionEnd",function(){Firefly.viewport.currentView.$el.addClass("blockElement"),t.$(".close").css({display:"block",opacity:0}).animate({opacity:1},{done:function(){e()}})}),f.$el.addClass("animateScheme")},0)}});return i.extend({className:"ticket-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed"},initialize:function(e){e=e||{},this.$el.css({opacity:0,scale:2}),this.eventId=e.eventId,this.deltaY=18,this.preventScroll=0},afterRender:function(){var i=this.$(".ticket-view-scheme-image");t(".ticket-view-table-scroll").css("opacity",0),f=new m,e.extend(f,{$el:i,img:i.find("img"),closeBtn:i.find("button")}),f.$el.one("click",function(){Firefly.viewport.showModal(f)}),f.img.on("load",function(){var e=/\#/,i=this.naturalWidth>963?963:this.naturalWidth,n=i*this.naturalHeight/this.naturalWidth-20;t("head").append("<style>.animateScheme{margin-left:-#; width:#; height:#;margin-top:-#</style>".replace(e,(i+20)/2+"px !important").replace(e,i+"px !important").replace(e,n+"px !important").replace(e,n/2+"px !important"))})},model:new p({id:1,name:"007: СПЕКТР. 19 ноября.",date:"2015-11-19T13:00:00.026Z",images:["/images/lipeck/spectre.jpg"],descriptions:"Зашифрованное послание из неизвестного источника выводит Бонда на след зловещей глобальной организации под кодовым названием СПЕКТР, в то время как М пытается спасти секретную разведывательную службу от ликвидации.",fields:[{name:"Мировая премьера",value:"26 октября 2015"},{name:"Режиссер",value:"Сэм Мендес"},{name:"Продолжительность",value:"148 мин"}],venue:{name:"Киноплекс Молл",address:"г. Липецк, ул. Терешковой, д. 25б, ТРЦ «Малибу»",image:"/images/lipeck/spectre1.jpg",seating_plan_image:"/images/zal.png"}}),_open:function(e){var t=this.$(".ticket-view-description");this.scroller=new a(t,t.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,i){i>0?t.css("box-shadow","inset 0px 17px 14px -17px"):t.css("box-shadow","none")},options:{scrollingX:!1}}),f.$el.css("opacity",0),Firefly.viewport.currentView.$el.prepend(f.$el),f.$el.animate({opacity:1},400),this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.ticketViewTable.close(),this.$el.prepend(f.$el),this.$el.animate({opacity:0,scale:2},{complete:e})},_load:function(e){var t=this;u.initialized||u.initialize(t.model),t.ticketViewTable=new h({ticketId:t.model.id}),setTimeout(e,0)},back:function(){window.history.back()},proceed:function(){u.calculateTotalTickets(),u.calculateTotalSum(),u.isEmpty()?Firefly.viewport.showMessage(new d({message:"вы не выбрали ни одного билета"})):Firefly.viewport.showMessage(new d({message:"Билеты забронированы"}))}})}),define("templates/ticket-buy-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+="\n		        ",n=i["if"].call(e,e.amount,{hash:{},inverse:f.noop,fn:f.program(2,r,t),data:t}),(n||0===n)&&(a+=n),a+="\n        	"}function r(e,t){var n,a="";return a+="\n		        	<tr>\n						<td>",(n=i.category)?n=n.call(e,{hash:{},data:t}):(n=e.category,n=typeof n===d?n.apply(e):n),a+=p(n)+"</td>\n						<td>РЯД ",(n=i.row)?n=n.call(e,{hash:{},data:t}):(n=e.row,n=typeof n===d?n.apply(e):n),a+=p(n)+"</td>\n						<td>МЕСТО ",(n=i.number)?n=n.call(e,{hash:{},data:t}):(n=e.number,n=typeof n===d?n.apply(e):n),a+=p(n)+"</td>\n						<td>",(n=i.price)?n=n.call(e,{hash:{},data:t}):(n=e.price,n=typeof n===d?n.apply(e):n),a+=p(n)+" р.</td>\n		            </tr>\n	            "}function s(e,t){var n,a,o,r="";return r+="\n            <tr>\n				<td>",(n=i.type)?n=n.call(e,{hash:{},data:t}):(n=e.type,n=typeof n===d?n.apply(e):n),r+=p(n)+'</td>\n				<td class="long-dash">-</td>\n				<td>',(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===d?n.apply(e):n),r+=p(n)+" билет",o={hash:{},data:t},r+=p((n=i.ticketsInclinations,n?n.call(e,e.amount,o):m.call(e,"ticketsInclinations",e.amount,o)))+"</td>\n				<td>",(a=i.max_price)?a=a.call(e,{hash:{},data:t}):(a=e.max_price,a=typeof a===d?a.apply(e):a),r+=p(a)+" руб</td>\n            </tr>\n            "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var l,c,u,h="",d="function",p=this.escapeExpression,f=this,m=i.helperMissing;return h+='\n<div class="ticket-buy-view-header">\n	<h1>подтверждение заказа</h1>\n</div>\n<div class="ticket-buy-view-main">\n	<h1>для завершения оформления укажите свой <br/>мобильный номер телефона, на который вам будет выслана <br/>информация о заказе</h1>\n	<div class="ticket-buy-view-main-credentials">\n		<span>Ваши ФИО:</span>\n		<input readonly type="text" class="credentials-input"></input>\n		<div class="credentials-input-message">ФИО введено некорректно</div>\n	</div>\n	<div class="ticket-buy-view-main-phone">\n		<span>Моб. телефон:</span>\n		<input readonly type="tel" value="+7 "></input>\n		<div class="phone-input-message">Телефон введен некорректно</div>\n	</div>\n	<div class="ticket-buy-view-main-email">\n		<span>Ваш e-mail:</span>\n		<input readonly type="text" class="email-input"></input>\n		<div class="email-input-message">e-mail введен некорректно</div>\n	</div>\n	<button class="ticket-buy-view-main-phone-btn">получить код</button>\n	<div class="ticket-buy-view-main-wait-message">\n		<h1>ОЖИДАЙТЕ СМС СООБЩЕНИЕ С КОДОМ</h1>\n		<h2>Если Вы не получили проверочный код, Вы можете повторить запрос через 3 мин.</h2>\n	</div>\n	<div class="ticket-buy-view-timer"></div>\n\n	<div class="ticket-buy-view-main-code">\n		<span>Код</span>\n		<input readonly type="text"></input>\n		<div class="code-input-message">Код введен некорректно</div>\n	</div>\n	<div class="ticket-buy-view-main-keypad-container"></div>\n\n</div>\n<div class="ticket-buy-view-table">\n	<div class="ticket-buy-view-table-wrapper">\n        <div class="ticket-buy-view-table-eventInfo">\n			<span>',u={hash:{},data:a},h+=p((l=i.ticketFormatDate,l?l.call(t,(l=t.eventInfo,null==l||l===!1?l:l.date),u):m.call(t,"ticketFormatDate",(l=t.eventInfo,null==l||l===!1?l:l.date),u)))+"</span>\n			<span>"+p((l=t.eventInfo,l=null==l||l===!1?l:l.name,typeof l===d?l.apply(t):l))+"</span>\n			<span>"+p((l=t.eventInfo,l=null==l||l===!1?l:l.venue,l=null==l||l===!1?l:l.name,typeof l===d?l.apply(t):l))+"</span>\n			<span>"+p((l=t.eventInfo,l=null==l||l===!1?l:l.venue,l=null==l||l===!1?l:l.address,typeof l===d?l.apply(t):l))+"</span>\n\n        </div>\n\n        <table >\n        	",c=i.each.call(t,t.ticketsWithSeats,{hash:{},inverse:f.noop,fn:f.program(1,o,a),data:a}),(c||0===c)&&(h+=c),h+="\n        	",c=i.each.call(t,t.ticketsWithoutSeats,{hash:{},inverse:f.noop,fn:f.program(4,s,a),data:a}),(c||0===c)&&(h+=c),h+='\n\n\n        </table>\n\n            </div>\n</div>\n<div class="ticket-buy-view-total">\n\n	<span>итого: </span>\n	<span>',(c=i.total)?c=c.call(t,{hash:{},data:a}):(c=t.total,c=typeof c===d?c.apply(t):c),h+=p(c)+' руб</span>\n</div>\n\n<button href="#main/buyTicket" class="button ticket-buy-view-confirm-button">подтвердить</button>\n<a href="#main" class="button ticket-buy-view-exit">выход</a>\n'})}),define("views/TicketBuyView",["jquery","underscore","framework/View","templates/ticket-buy-view","models/ticketCart","framework/utils/ticketBackend","views/MessageView","framework/utils/ticketBackend"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({events:{"click .ticket-buy-view-main-keypad button":"keypadPress","click input":"setActiveInput","click .ticket-buy-view-main-phone-btn":"getPhoneId","click .ticket-buy-view-confirm-button":"proceed"},className:"product-view ticket-view",template:n,_load:function(e){this.model=a.model,e()},setActiveInput:function(t){this.$activeInput=e(t.fromElement)},initialize:function(){t.bindAll(this,"getPhoneId"),this.$el.css({opacity:0,scale:2})},_open:function(e){this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0,scale:2},{complete:e})},afterRender:function(){this.inputBlocks={phone:{$input:this.$("input[type=tel]"),message:this.$(".phone-input-message"),re:new RegExp(/[\w\W]{18}/)},credentials:{$input:this.$(".credentials-input"),message:this.$(".credentials-input-message"),re:/[\w\W]{1}/},email:{$input:this.$(".email-input"),message:this.$(".email-input-message"),re:/^([0-9a-zA-Z]+[\-._+&amp;])*[0-9a-zA-Z]+@([\-0-9a-zA-Z]+[.])+[a-zA-Z]{2,6}$/}},this.$proceedButton=this.$(".ticket-buy-view-confirm-button").addClass("disabled"),this.$codeInput=this.$(".ticket-buy-view-main-code input")},checkFields:function(){var e,t,i=this.inputBlocks,n=!0;for(e in i)t=i[e],t.re.test(t.$input.val())?t.message.css("opacity",0):(t.message.css("opacity",1),n=!1);return n},getPhoneId:function(){if(this.checkFields()){this.phoneNmbr=this.inputBlocks.phone.$input.val();var t=this.$("[class*=phone-btn]"),i=180,n=this.$("[class*=timer]").css("opacity",1).html(i+" сек."),a=e(".ticket-buy-view-main-wait-message"),r=(new Date).getTime(),s=setInterval(function(){var e=Math.round((Date.now()-r)/1e3);n.html(i-e+" сек."),e>=i&&(clearInterval(s),n.css("opacity",0),a.animate({opacity:0},{duration:500,done:function(){t.animate({opacity:1}).removeClass("disabled")}}))},1e3);t.animate({opacity:0},{duration:500,done:function(){a.animate({opacity:1})}}).addClass("disabled"),this.$proceedButton.removeClass("disabled"),e.ajax({method:"post",url:o("/phones"),dataType:"json",contentType:"application/json",data:JSON.stringify({phone:this.phoneNmbr}),success:function(e){this.phoneId=e.id,Firefly.sessionManager.session.prolong(1e3*i)},context:this}),this.$activeInput=e(".ticket-buy-view-main-code-holder")}},proceed:function(){Firefly.viewport.showMessage(new r({spinner:!0,message:"пожалуйста, подождите. Идет обработка...",closeBtn:!1})),e.ajax({method:"get",url:o("/phones/"+this.phoneId+"?code="+this.$codeInput.val()),
success:function(){var i={cart_id:a.id,phone:this.phoneNmbr,name:this.inputBlocks.credentials.$input.val(),email:this.inputBlocks.email.$input.val()};e.ajax({method:"post",url:o("/order"),contentType:"application/json",data:JSON.stringify(i),success:function(n){a.model.set({cartId:n.id,ttl:n.ttl});var o=a.formatStatistics();t.extend(o,{customer_name:i.name,customer_phone:i.phone,customer_email:i.email,order_id:n.orderId}),Firefly.viewport.hideMessage(function(){Firefly.navigate("main/successTicket")}),e.ajax({method:"post",url:s("/stats/tickets"),contentType:"application/json",data:JSON.stringify(o)})},error:function(){},context:this})},error:function(){Firefly.viewport.hideMessage(),this.$(".code-input-message").css("opacity",1)},context:this})}})}),define("templates/ticket-confirm-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+='\n	<div class="ticket-confirm-view-table-withSpots">\n		<table>\n			<tr>\n				<td>категория</td>\n				<td>ряд</td>\n				<td>место</td>\n				<td>цена</td>\n			</tr>\n			',n=i.each.call(e,e.ticketsWithSeats,{hash:{},inverse:g.noop,fn:g.program(2,r,t),data:t}),(n||0===n)&&(a+=n),a+="		\n\n		</table>\n	</div>\n"}function r(e,t){var n,a="";return a+="\n				",n=i["if"].call(e,e.amount,{hash:{},inverse:g.noop,fn:g.program(3,s,t),data:t}),(n||0===n)&&(a+=n),a+="\n				\n			"}function s(e,t){var n,a="";return a+='\n					<tr data-ticket-id="',(n=i.id)?n=n.call(e,{hash:{},data:t}):(n=e.id,n=typeof n===m?n.apply(e):n),a+=v(n)+":",(n=i.categoryId)?n=n.call(e,{hash:{},data:t}):(n=e.categoryId,n=typeof n===m?n.apply(e):n),a+=v(n)+'">\n						<td>',(n=i.category)?n=n.call(e,{hash:{},data:t}):(n=e.category,n=typeof n===m?n.apply(e):n),a+=v(n)+"</td>\n						<td>",(n=i.row)?n=n.call(e,{hash:{},data:t}):(n=e.row,n=typeof n===m?n.apply(e):n),a+=v(n)+"</td>\n						<td>",(n=i.number)?n=n.call(e,{hash:{},data:t}):(n=e.number,n=typeof n===m?n.apply(e):n),a+=v(n)+"</td>\n						<td>",(n=i.price)?n=n.call(e,{hash:{},data:t}):(n=e.price,n=typeof n===m?n.apply(e):n),a+=v(n)+" руб</td>\n					</tr>\n				"}function l(e,t){var n,a="";return a+='\n	<div class="ticket-confirm-view-table-withoutSpots">\n		<table>\n			<tr>\n				<td>категория</td>\n				<td>количество билетов</td>\n				<td>цена</td>\n			</tr>\n			',n=i.each.call(e,e.ticketsWithoutSeats,{hash:{},inverse:g.noop,fn:g.program(6,c,t),data:t}),(n||0===n)&&(a+=n),a+="\n\n		</table>\n	</div>\n"}function c(e,t){var n,a="";return a+="\n				",n=i["if"].call(e,e.amount,{hash:{},inverse:g.noop,fn:g.program(7,u,t),data:t}),(n||0===n)&&(a+=n),a+="\n			"}function u(e,t){var n,a="";return a+='\n					<tr data-ticket-id="',(n=i.id)?n=n.call(e,{hash:{},data:t}):(n=e.id,n=typeof n===m?n.apply(e):n),a+=v(n)+'">\n						<td>',(n=i.type)?n=n.call(e,{hash:{},data:t}):(n=e.type,n=typeof n===m?n.apply(e):n),a+=v(n)+"</td>\n						<td>",(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===m?n.apply(e):n),a+=v(n)+"</td>\n						<td>",(n=i.max_price)?n=n.call(e,{hash:{},data:t}):(n=e.max_price,n=typeof n===m?n.apply(e):n),a+=v(n)+" руб</td>\n					</tr>\n				"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var h,d,p,f="",m="function",v=this.escapeExpression,g=this,y=i.helperMissing;return f+='\n<div class="ticket-confirm-view-header">\n	<span>Подтверждение заказа</span>\n</div>\n<div class="ticket-confirm-view-description">\n	<div class="ticket-confirm-view-event-image-wrapper">\n		<img src="',p={hash:{},data:a},f+=v((h=i.ticketBackend,h?h.call(t,(h=t.eventInfo,h=null==h||h===!1?h:h.images,null==h||h===!1?h:h[0]),"images/",p):y.call(t,"ticketBackend",(h=t.eventInfo,h=null==h||h===!1?h:h.images,null==h||h===!1?h:h[0]),"images/",p)))+'"></li>\n	</div>\n	<div class="ticket-confirm-view-description-info">\n		<h1>',p={hash:{},data:a},f+=v((h=i.ticketFormatDate,h?h.call(t,(h=t.eventInfo,null==h||h===!1?h:h.date),p):y.call(t,"ticketFormatDate",(h=t.eventInfo,null==h||h===!1?h:h.date),p)))+"</h1>\n		<h2>"+v((h=t.eventInfo,h=null==h||h===!1?h:h.name,typeof h===m?h.apply(t):h))+"</h2>\n		<h2>"+v((h=t.eventInfo,h=null==h||h===!1?h:h.venue,h=null==h||h===!1?h:h.name,typeof h===m?h.apply(t):h))+"</h2>\n		<h2>"+v((h=t.eventInfo,h=null==h||h===!1?h:h.venue,h=null==h||h===!1?h:h.address,typeof h===m?h.apply(t):h))+"</h2>\n	</div>\n</div>\n",d=i.unless.call(t,t.emptyTicketsWithSeats,{hash:{},inverse:g.noop,fn:g.program(1,o,a),data:a}),(d||0===d)&&(f+=d),f+="	\n",d=i.unless.call(t,t.emptyTicketsWithoutSeats,{hash:{},inverse:g.noop,fn:g.program(5,l,a),data:a}),(d||0===d)&&(f+=d),f+='	\n\n<div class="ticket-confirm-view-total">\n	<span>Итого:</span>\n	<span class="ticket-confirm-view-total-sum">',(d=i.total)?d=d.call(t,{hash:{},data:a}):(d=t.total,d=typeof d===m?d.apply(t):d),f+=v(d)+' руб</span>\n</div>\n<div class="ticket-view-footer">\n	<a class="button ticket-confirm-view-back">назад</a>\n	<button class="button ticket-confirm-view-confirm">подтвердить</button>\n	<button class="button ticket-confirm-view-repick">выбрать билеты</button>\n</div>\n'})}),function(){"use strict";var e,t,i,n,a=!1,o=window.navigator.msPointerEnabled,r=!o&&(window.propertyIsEnumerable("ontouchstart")||window.document.hasOwnProperty("ontouchstart")),s=!window.hasOwnProperty("ArrayBuffer"),l=window.Selection&&window.Selection.prototype.removeAllRanges;void 0!==document.createElement("div").style.transform?(t="",i="",n="transform"):window.opera&&"[object Opera]"===Object.prototype.toString.call(window.opera)?(t="-o-",i="O",n="OTransform"):void 0!==document.documentElement.style.MozTransform?(t="-moz-",i="Moz",n="MozTransform"):void 0!==document.documentElement.style.webkitTransform?(t="-webkit-",i="webkit",n="-webkit-transform"):"string"==typeof navigator.cpuClass&&(t="-ms-",i="ms",n="-ms-transform"),s||void 0!==document.createElement("div").style[i+(i?"P":"p")+"erspective"]||(s=!0);var c=i+(i?"T":"t")+"ransform",u=i+(i?"T":"t")+"ransition",h=s?"translate(":"translate3d(",d={x:"",y:"0,"},p={x:",0"+(s?")":",0)"),y:s?")":",0)"},f=.998,m=.01;!function(){var e,i,n=document.getElementsByTagName("head")[0]||document.documentElement,a=document.createElement("style");a.type="text/css",e=s?t+"transform-style: preserve-3d;":t+"transform: translateZ(0);",i=[".ftscroller_scrolling { "+t+"user-select: none; cursor: all-scroll !important }",".ftscroller_container { overflow: hidden; position: relative; max-height: 100%; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); -ms-touch-action: none }",".ftscroller_hwaccelerated { "+e+" }",".ftscroller_x, .ftscroller_y { position: relative; min-width: 100%; min-height: 100%; overflow: hidden }",".ftscroller_x { display: inline-block }",".ftscroller_scrollbar { pointer-events: none; position: absolute; width: 5px; height: 5px; border: 1px solid rgba(255, 255, 255, 0.15); -webkit-border-radius: 3px; border-radius: 6px; opacity: 0; "+t+"transition: opacity 350ms; z-index: 10 }",".ftscroller_scrollbarx { bottom: 2px; left: 2px }",".ftscroller_scrollbary { right: 2px; top: 2px }",".ftscroller_scrollbarinner { height: 100%; background: rgba(0,0,0,0.5); -webkit-border-radius: 2px; border-radius: 4px / 6px }",".ftscroller_scrolling .ftscroller_scrollbar { opacity: 1; "+t+"transition: none; -o-transition: all 0 none }",".ftscroller_scrolling .ftscroller_container .ftscroller_scrollbar { opacity: 0 }"],a.styleSheet?a.styleSheet.cssText=i.join("\n"):a.appendChild(document.createTextNode(i.join("\n"))),n.insertBefore(a,n.firstChild)}(),window.FTScroller=e=function(s,v){var g,y,b,w,_,k,x,T,S,E,C,M,L,P,D,A,$,N,I,O,z,B,j,R,F,H,V,U,q,W,Z,Y,X,G,K,J,Q,ee,te,ie,ne,ae,oe,re,se,le,ce,ue,he,de,pe,fe,me,ve={scrollbars:!0,scrollingX:!0,scrollingY:!0,scrollBoundary:1,scrollResponseBoundary:1,alwaysScroll:!1,contentWidth:void 0,contentHeight:void 0,snapping:!1,snapSizeX:void 0,snapSizeY:void 0,paginatedSnap:!1,bouncing:!0,updateOnChanges:!0,updateOnWindowResize:!1,baseAlignments:{x:-1,y:-1},windowScrollingActiveFlag:void 0,hwAccelerationClass:"ftscroller_hwaccelerated",enableRequestAnimationFrameSupport:!0,maxFlingDuration:1e3},ge=this,ye=s,be={x:null,y:null},we={x:null,y:null},_e={container:{x:null,y:null},content:{x:null,y:null,rawX:null,rawY:null},scrollEnd:{x:null,y:null}},ke={x:!1,y:!1,userX:!1,userY:!1},xe={x:0,y:0},Te={x:0,y:0},Se=!1,Ee=0,Ce=!1,Me=!1,Le=!1,Pe=!1,De=!1,Ae={x:0,y:0},$e={x:0,y:0},Ne={x:null,y:null},Ie=!1,Oe=[],ze=!1,Be={},je={x:!0,y:!0},Re={x:0,y:0,t:0},Fe={x:0,y:0},He=[],Ve=new CubicBezier(.1,.4,.3,1),Ue=new CubicBezier(.7,0,.9,.6),qe=Ve.divideAtT(.97)[0],We=new CubicBezier(0,.5,.5,1),Ze=!1,Ye=!1,Xe=!1,Ge={x:0,y:0},Ke=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||!1,Je=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||!1,Qe={scrollstart:[],scroll:[],scrollend:[],segmentwillchange:[],segmentdidchange:[],reachedstart:[],reachedend:[],scrollinteractionend:[]};if("object"==typeof FTScrollerOptions&&FTScrollerOptions)for(g in FTScrollerOptions)FTScrollerOptions.hasOwnProperty(g)&&ve.hasOwnProperty(g)&&(ve[g]=FTScrollerOptions[g]);if(v){for(g in v)v.hasOwnProperty(g)&&ve.hasOwnProperty(g)&&(ve[g]=v[g]);v.hasOwnProperty("snapSizeX")&&!isNaN(v.snapSizeX)&&(ke.userX=ke.x=v.snapSizeX),v.hasOwnProperty("snapSizeY")&&!isNaN(v.snapSizeY)&&(ke.userY=ke.y=v.snapSizeY),v.contentWidth&&v.contentHeight&&(v.updateOnChanges=!1)}return ve.scrollResponseBoundary=Math.min(ve.scrollBoundary,ve.scrollResponseBoundary),ve.scrollingX&&(Be.x=!0),ve.scrollingY&&(Be.y=!0),y=function(e){var t,i;for(X(!1),Y(),Ze&&(window.clearTimeout(Ze),Ze=!1),t=0,i=Oe.length;i>t;t+=1)window.clearTimeout(Oe[t]);if(Oe.length=0,e&&ye){for(;fe.firstChild;)ye.appendChild(fe.firstChild);ye.removeChild(pe)}ye=null,pe=null,fe=null,be.x=null,be.y=null,we.x=null,we.y=null;for(t in Qe)Qe.hasOwnProperty(t)&&(Qe[t].length=0);a&&a===ge&&(a=!1,ve.windowScrollingActiveFlag&&(window[ve.windowScrollingActiveFlag]=!1))},b=function(e,t){ke.userX=e,ke.userY=t,ke.x=e,ke.y=t,_e.content.x=Math.ceil(_e.content.rawX/e)*e,_e.content.y=Math.ceil(_e.content.rawY/t)*t,_e.scrollEnd.x=_e.container.x-_e.content.x,_e.scrollEnd.y=_e.container.y-_e.content.y,z(),D(),j(!0)},w=function(e,t,i){var n,a,o,r,s=0,l={};C(Date.now()),o={x:-e,y:-t};for(r in Be)if(Be.hasOwnProperty(r)){if(n=o[r],n===!1)continue;n=Math.min(0,Math.max(_e.scrollEnd[r],n)),ve.snapping&&ke[r]&&(n=Math.round(n/ke[r])*ke[r]),a=i||0,a===!0&&(a=20*Math.sqrt(Math.abs(Ae[r]-n))),R(r,n,a),l[r]=n,s=Math.max(s,a)}(Ae.x!==o.x||Ae.y!==o.y)&&(ze=!0,H("scrollstart",{scrollLeft:-Ae.x,scrollTop:-Ae.y})),s?Oe.push(setTimeout(function(){var e;for(e in l)l.hasOwnProperty(e)&&($e[e]=l[e]);M()},s)):M(),H("scroll",{scrollLeft:-Ae.x,scrollTop:-Ae.y})},_=function(e,t,i){w(parseFloat(e)-Ae.x,parseFloat(t)-Ae.y,i)},k=function(e,t,i){v.contentWidth=e||v.contentWidth,v.contentHeight=t||v.contentHeight,O(!!i)},x=function(e,t){return Qe.hasOwnProperty(e)?(Qe[e].push(t),!0):!1},T=function(e,t){var i;if(!Qe.hasOwnProperty(e))return!1;for(i=Qe[e].length;i>=0;i-=1)Qe[e][i]===t&&Qe[e].splice(i,1);return!0},S=function(e,t,i,n){var a=Pe;return 0>=i&&(i=Date.now()),ve.windowScrollingActiveFlag&&window[ve.windowScrollingActiveFlag]?!1:(a?L():Ie=!1,Re.x=e,Re.y=t,Re.t=i,Ge.x=$e.x,Ge.y=$e.y,He.length=0,He.push({x:e,y:t,t:i}),a&&E(e,t,i,n,a),!0)},E=function(e,t,i,n,o){var r,s,c=!1,u={x:e-Re.x,y:t-Re.y},h={x:Ae.x+u.x,y:Ae.y+u.y},d=q(h);if(0>=i&&(i=Date.now()),!Me&&(a&&a!==ge?s=!0:ve.windowScrollingActiveFlag&&window[ve.windowScrollingActiveFlag]&&(s=!0),s))return Se=!1,ue(),void(De&&(Y(),D(!0)||M(!0)));if(Le)n.preventDefault();else{if((ve.bouncing||o||je.x&&u.x&&d.x<0||je.y&&u.y&&d.y<0)&&n.preventDefault(),!(o&&ve.snapping||je.x&&!(Math.abs(u.x)<ve.scrollResponseBoundary)||je.y&&!(Math.abs(u.y)<ve.scrollResponseBoundary)))return;if(!(ve.bouncing||o||je.x&&u.x&&!(d.x>0)||je.y&&u.y&&!(d.y>0)))return void(Ie=!0);W(),Le=!0,ze=!0,Pe=!0,c=!0,De=!0}Me||(o&&ve.snapping||je.x&&Math.abs(u.x)>=ve.scrollBoundary||je.y&&Math.abs(u.y)>=ve.scrollBoundary)&&(Me=!0,a=ge,ve.windowScrollingActiveFlag&&(window[ve.windowScrollingActiveFlag]=ge),H("scrollstart",{scrollLeft:-Ae.x,scrollTop:-Ae.y})),l&&window.getSelection().removeAllRanges();for(r in je)je.hasOwnProperty(r)&&(h[r]>0?h[r]=U(h[r],r):h[r]<_e.scrollEnd[r]&&(h[r]=_e.scrollEnd[r]+U(h[r]-_e.scrollEnd[r],r)),Ke?Ge[r]=h[r]:R(r,h[r]));c&&-1===pe.className.indexOf("ftscroller_scrolling")&&(pe.className+=" ftscroller_scrolling"),Me&&(H("scroll",{scrollLeft:-h.x,scrollTop:-h.y}),j(!1)),He.push({x:e,y:t,t:i}),He.length>30&&He.splice(0,15)},C=function(e,t){return Se=!1,ue(),Y(),H("scrollinteractionend",{}),Me?(He[He.length-1].t=e,Me=!1,Le=!1,a=!1,ve.windowScrollingActiveFlag&&(window[ve.windowScrollingActiveFlag]=!1),Ie=!0,t&&t.preventDefault(),void(P()||D()||M())):void(!D(!0)&&De&&M(!0))},M=function(e){var t,i,n;Pe=!1,De=!1,Le=!1,pe.className=pe.className.replace(/ ?ftscroller_scrolling/g,""),Ae.x=$e.x,Ae.y=$e.y,e||(H("scroll",{scrollLeft:-Ae.x,scrollTop:-Ae.y}),j(!0),H("scrollend",{scrollLeft:-Ae.x,scrollTop:-Ae.y}));for(n in je)je.hasOwnProperty(n)&&(be[n].style[u]="",ve.scrollbars&&(we[n].style[u]=""));for(t=0,i=Oe.length;i>t;t+=1)window.clearTimeout(Oe[t]);Oe.length=0},L=function(){var e,t,i;Pe=!1,B();for(e in je)je.hasOwnProperty(e)&&R(e,Ae[e]);for(j(!1),t=0,i=Oe.length;i>t;t+=1)window.clearTimeout(Oe[t]);Oe.length=0},P=function(){var e,t,i,n,a,o,r,s,l,c,u,h,d,p,v,g,y,b,w,_,k=0,x=!1,T={};if(1===He.length||"scrollwheel"===Se)return!1;for(t in je)if(je.hasOwnProperty(t)){for(u=350,c=0,d=!1,h=!1,y=void 0,v=qe,n=He[He.length-1],a=He[He.length-2],e=He.length-3;e>=0&&!(n.t-He[e].t>100);e-=1)a=He[e];if(i=(n[t]-a[t])/(n.t-a.t),Math.abs(i)<m?(o=0,r=0):(o=Math.log(m/Math.abs(i))/Math.log(f),r=i*(1-Math.pow(f,o+1))/(1-f)),s=Math.floor($e[t]+r),ve.bouncing||(0===$e[t]&&s>0?s=0:$e[t]===_e.scrollEnd[t]&&s<$e[t]&&(s=$e[t])),ve.paginatedSnap&&ve.snapping?(b=-$e[t]/ke[t],b=xe[t]<b?Math.floor(b):Math.ceil(b),s>-(b-1)*ke[t]?c=s+(b-1)*ke[t]:s<-(b+1)*ke[t]?c=s+(b+1)*ke[t]:Math.abs(i)>m&&(s=0>i?Math.floor($e[t]/ke[t])*ke[t]:Math.ceil($e[t]/ke[t])*ke[t],o=Math.min(ve.maxFlingDuration,o*(s-$e[t])/r))):ve.snapping&&(c=s-Math.round(s/ke[t])*ke[t]),s-c>0?(c=s,d=!0):s-c<_e.scrollEnd[t]&&(c=s-_e.scrollEnd[t],d=!0),c&&(d&&ve.bouncing&&r?(r=Math.floor(r),w=s>0?s-Math.max(0,$e[t]):s-Math.min(_e.scrollEnd[t],$e[t]),_=r-w,r&&o?(g=v._getCoordinateForT(v.getTForY((r-w)/r,1/o),v._p1.x,v._p2.x),y=g*o):g=0,p=Math.ceil(w/8),Math.abs(p)>_e.container[t]/2&&(p=0>p?-Math.floor(_e.container[t]/2):Math.floor(_e.container[t]/2)),h=s>0?0:_e.scrollEnd[t],0===g?(o/=6,s=$e[t]+_+p,l=o):(l=(g+(1-g)/6)*o,F(t,$e[t]+_+p,(1-g)*o/6,We,y),v=v.divideAtX(l/o,1/o)[0],o=l,s=$e[t]+_+p)):0>r&&r>c||r>0&&c>r?(s-=Math.floor(r/2),c-=Math.floor(r/2),u=50*Math.sqrt(Math.abs(c)),h=s-c,o=350,l=.97*o):(s-=c,r?(0>r&&0>c||r>0&&c>0)&&(g=v._getCoordinateForT(v.getTForY((Math.abs(r)-Math.abs(c))/Math.abs(r),1/o),v._p1.x,v._p2.x),v=v.divideAtX(g,1/o)[0],o=Math.round(o*g)):o=u,c=0,u=0)),s===$e[t]&&!c)continue;x=!0,R(t,s,o,v,y),c&&u&&F(t,h,u,Ue,l),k=Math.max(k,c?l+u:o),T[t]=h===!1?s:h}return x&&k&&Oe.push(setTimeout(function(){var e;for(e in T)T.hasOwnProperty(e)&&($e[e]=T[e]);M()},k)),x},D=function(e){var t,i=e?100:350,n=A($e),a=!1;for(t in Be)Be.hasOwnProperty(t)&&n[t]!==$e[t]&&(a=!0);if(!a)return!1;for(t in Be)Be.hasOwnProperty(t)&&R(t,n[t],i);return Oe.push(setTimeout(function(){$e=n,M(e)},i)),!0},A=function(e){var t,i={x:0,y:0};for(t in je)if(je.hasOwnProperty(t)){if(e[t]>0){i[t]=0;continue}if(e[t]<_e.scrollEnd[t]){i[t]=_e.scrollEnd[t];continue}if(ve.snapping&&ke[t]){i[t]=Math.round(e[t]/ke[t])*ke[t];continue}i[t]=e[t]}return i},$=function(){var t,i,n;if(!N()){for(t=ye.ownerDocument.createDocumentFragment(),i=document.createElement("DIV"),t.appendChild(i),i.innerHTML=e.prototype.getPrependedHTML(!ve.scrollingX,!ve.scrollingY,ve.hwAccelerationClass)+e.prototype.getAppendedHTML(!ve.scrollingX,!ve.scrollingY,ve.hwAccelerationClass,ve.scrollbars),pe=i.firstElementChild,n=pe,ve.scrollingX&&(be.x=pe.firstElementChild,n=be.x,ve.scrollbars&&(we.x=pe.getElementsByClassName("ftscroller_scrollbarx")[0])),ve.scrollingY?(be.y=n.firstElementChild,ve.scrollbars&&(we.y=pe.getElementsByClassName("ftscroller_scrollbary")[0]),fe=be.y):fe=be.x;ye.firstChild;)fe.appendChild(ye.firstChild);ye.appendChild(pe)}},N=function(){var e,t,i,n,a,o,r,s,l;if(e=ye.firstElementChild,e&&-1!==e.className.indexOf("ftscroller_container")){if(ve.scrollingX){if(t=e.firstElementChild,!t||-1===t.className.indexOf("ftscroller_x"))return;if(n=t,ve.scrollbars){if(r=e.getElementsByClassName("ftscroller_scrollbarx"))for(s=0,l=r.length;l>s;s+=1)if(r[s].parentNode===e){a=r[s];break}if(!a)return}}else n=e;if(ve.scrollingY){if(i=n.firstElementChild,!i||-1===i.className.indexOf("ftscroller_y"))return;if(ve.scrollbars){if(r=e.getElementsByClassName("ftscroller_scrollbary"))for(s=0,l=r.length;l>s;s+=1)if(r[s].parentNode===e){o=r[s];break}if(!o)return}}return pe=e,t&&(be.x=t),i&&(be.y=i),a&&(we.x=a),o&&(we.y=o),fe=ve.scrollingY?i:t,!0}},I=function(){Ze&&window.clearTimeout(Ze),Ze=setTimeout(function(){O()},100)},O=function(e){var t;if(!pe||!fe)return!1;Ze&&(window.clearTimeout(Ze),Ze=!1);var i,n,a;C(Date.now()),a={x:!1,y:!1};for(t in a)a.hasOwnProperty(t)&&(0===$e[t]?a[t]=-1:$e[t]<=_e.scrollEnd[t]?a[t]=1:2*$e[t]<=_e.scrollEnd[t]+5&&2*$e[t]>=_e.scrollEnd[t]-5&&(a[t]=0));i=pe.offsetWidth,n=pe.offsetHeight;var o=v.contentWidth||fe.offsetWidth,r=v.contentHeight||fe.offsetHeight,s=o,l=r,c={x:!1,y:!1};if(ke.userX||(ke.x=i),ke.userY||(ke.y=n),ve.snapping&&(s=ke.userX?Math.ceil(s/ke.userX)*ke.userX:Math.ceil(s/ke.x)*ke.x,l=ke.userY?Math.ceil(l/ke.userY)*ke.userY:Math.ceil(l/ke.y)*ke.y),_e.container.x!==i||_e.container.y!==n||_e.content.x!==s||_e.content.y!==l){_e.container.x=i,_e.container.y=n,_e.content.x=s,_e.content.rawX=o,_e.content.y=l,_e.content.rawY=r,_e.scrollEnd.x=i-s,_e.scrollEnd.y=n-l,z();for(t in c)if(c.hasOwnProperty(t)){if(_e.container[t]<_e.content[t]&&ze&&ve.baseAlignments[t]!==a[t])continue;1===ve.baseAlignments[t]?c[t]=_e.scrollEnd[t]:0===ve.baseAlignments[t]?c[t]=Math.floor(_e.scrollEnd[t]/2):-1===ve.baseAlignments[t]&&(c[t]=0)}ve.scrollingX&&c.x!==!1&&(R("x",c.x,0),Ae.x=c.x),ve.scrollingY&&c.y!==!1&&(R("y",c.y,0),Ae.y=c.y),!e&&D()&&j(!0)}},z=function(){ve.scrollbars&&(ve.scrollingX&&(we.x.style.width=Math.max(6,Math.round(_e.container.x*(_e.container.x/_e.content.x)-4))+"px"),ve.scrollingY&&(we.y.style.height=Math.max(6,Math.round(_e.container.y*(_e.container.y/_e.content.y)-4))+"px")),je={},ve.scrollingX&&(_e.content.x>_e.container.x||ve.alwaysScroll)&&(je.x=!0),ve.scrollingY&&(_e.content.y>_e.container.y||ve.alwaysScroll)&&(je.y=!0)},B=function(){var e,t,i;for(e in je)je.hasOwnProperty(e)&&(t=window.getComputedStyle(be[e],null)[n],i=t.split(", "),6===i.length?Ae[e]=parseInt(i["y"===e?5:4],10):Ae[e]=parseInt(i["y"===e?13:12],10),$e[e]=Ae[e])},j=function(e){var t,i={x:0,y:0};if(ve.snapping){for(t in je)je.hasOwnProperty(t)&&(i[t]=Math.max(0,Math.min(Math.ceil(_e.content[t]/ke[t])-1,Math.round(-$e[t]/ke[t]))));(i.x!==Te.x||i.y!==Te.y)&&(Te.x=i.x,Te.y=i.y,H("segmentwillchange",{segmentX:i.x,segmentY:i.y})),e&&(i.x!==xe.x||i.y!==xe.y)&&(xe.x=i.x,xe.y=i.y,H("segmentdidchange",{segmentX:i.x,segmentY:i.y}))}},R=function(e,i,n,a,o){var r,s=null;return be[e]?(n?(a||(a=qe),r=t+"transform "+n+"ms "+a.toString()):r="",be[e].style[u]=r,ve.scrollbars&&(we[e].style[u]=r),be[e].style[c]=h+d[e]+i+"px"+p[e],ve.scrollbars&&(we[e].style[c]=h+d[e]+-i*_e.container[e]/_e.content[e]+"px"+p[e]),i>=0?s="start":i<=_e.scrollEnd[e]&&(s="end"),s!==Ne[e]&&(null!==s&&(n?Oe.push(setTimeout(function(){H("reached"+s,{axis:e})},o||n)):H("reached"+s,{axis:e})),Ne[e]=s),void(n||($e[e]=i))):!1},F=function(e,t,i,n,a){Oe.push(setTimeout(function(){R(e,t,i,n)},a))},H=function(e,t){var i,n;for(t.srcObject=de,i=0,n=Qe[e].length;n>i;i+=1)try{Qe[e][i](t)}catch(a){window.console&&window.console.error&&window.console.error(a.message+" ("+a.sourceURL+", line "+a.line+")")}},V=function(e){var t,i,n=he(e.target),a=he(pe),o={x:"left",y:"top"},r={x:"width",y:"height"};if(Se===!1)for(i in je)je.hasOwnProperty(i)&&(t=-Math.round(n[r[i]]/2-$e[i]+n[o[i]]-a[o[i]]-a[r[i]]/2),t=Math.min(0,Math.max(_e.scrollEnd[i],t)),R(i,t,0),Ae[i]=t)},U=function(e,t){if(!ve.bouncing)return 0;var i=Math.exp(e/_e.container[t]);return Math.round(.6*_e.container[t]*(i-1)/(i+1))},q=function(e){var t,i,n={};for(t in e)e.hasOwnProperty(t)&&(i=e[t],i>=0?n[t]=i:i>_e.scrollEnd[t]?n[t]=-1:n[t]=_e.scrollEnd[t]-i);return n},W=function(){Ke&&(Y(),Xe=Ke(Z))},Z=function et(){var e;Xe=Ke(et);for(e in je)je.hasOwnProperty(e)&&Ge[e]!==$e[e]&&R(e,Ge[e])},Y=function(){Xe!==!1&&Je&&(Je(Xe),Xe=!1)},X=function(e){var t;pe&&(e?pe._ftscrollerToggle=pe.addEventListener:pe._ftscrollerToggle=pe.removeEventListener,o?(pe._ftscrollerToggle("MSPointerDown",ie,!0),pe._ftscrollerToggle("MSPointerMove",ne,!0),pe._ftscrollerToggle("MSPointerUp",ae,!0),pe._ftscrollerToggle("MSPointerCancel",oe,!0)):(r&&(pe._ftscrollerToggle("touchstart",G,!0),pe._ftscrollerToggle("touchmove",K,!0),pe._ftscrollerToggle("touchend",J,!0),pe._ftscrollerToggle("touchcancel",J,!0)),pe._ftscrollerToggle("mousedown",Q,!0),e||(document.removeEventListener("mousemove",ee,!0),document.removeEventListener("mouseup",te,!0))),pe._ftscrollerToggle("DOMMouseScroll",le,!1),pe._ftscrollerToggle("mousewheel",le,!1),o?e?document.addEventListener("click",se,!0):document.removeEventListener("click",se,!0):pe._ftscrollerToggle("click",se,!0),e?(fe.addEventListener("focus",V,!0),ve.updateOnChanges&&(me||(t=window.MutationObserver||window.WebKitMutationObserver||window[i+"MutationObserver"],t&&(me=new t(I))),me?me.observe(fe,{childList:!0,characterData:!0,subtree:!0}):fe.addEventListener("DOMSubtreeModified",function(e){(!e||e.srcElement!==fe&&-1===e.srcElement.className.indexOf("ftscroller_"))&&I()},!0),fe.addEventListener("load",I,!0)),ve.updateOnWindowResize&&window.addEventListener("resize",I,!0)):(fe.removeEventListener("focus",V,!0),me?me.disconnect():fe.removeEventListener("DOMSubtreeModified",I,!0),fe.removeEventListener("load",I,!0),window.removeEventListener("resize",I,!0)),delete pe._ftscrollerToggle)},G=function(e){var t,i,n;if(Se)for(t=0,i=e.touches.length;i>t;t+=1)e.touches[t].identifier===Se&&(Ee=t);else n=e.touches[0],Se=n.identifier,Ee=0,S(n.clientX,n.clientY,e.timeStamp,e)},K=function(e){if(Se!==!1){var t=e.touches[Ee];E(t.clientX,t.clientY,e.timeStamp,e)}},J=function(e){var t,i;if(e.touches)for(t=0,i=e.touches.length;i>t;t+=1)if(e.touches[t].identifier===Se)return void(Ee=t);C(e.timeStamp,e)},Q=function(e){e.button&&2===e.button||e.ctrlKey||(pe.setCapture&&pe.setCapture(),document.addEventListener("mousemove",ee,!0),document.addEventListener("mouseup",te,!0),Se=e.button||1,Ee=0,S(e.clientX,e.clientY,e.timeStamp,e))},ee=function(e){Se&&E(e.clientX,e.clientY,e.timeStamp,e)},te=function tt(e){e.button&&e.button!==Se||(document.removeEventListener("mousemove",ee,!0),document.removeEventListener("mouseup",tt,!0),pe.releaseCapture&&pe.releaseCapture(),C(e.timeStamp,e))},ie=function(e){Se||(Se=e.pointerId,ce(),S(e.clientX,e.clientY,e.timeStamp,e))},ne=function(e){Se===e.pointerId&&E(e.clientX,e.clientY,e.timeStamp,e)},ae=function(e){Se===e.pointerId&&C(e.timeStamp,e)},oe=function(e){C(e.timeStamp,e)},re=function(e){C(e.timeStamp,e)},se=function(e){return Ie||Se?(e.preventDefault(),e.stopPropagation(),Se||(Ie=!1),!1):!0},le=function(e){var t,i;if("scrollwheel"!==Se){if(Se!==!1)return!0;if(Se="scrollwheel",Fe.x=0,Fe.y=0,!S(e.clientX,e.clientY,Date.now(),e))return}e.wheelDelta?e.wheelDeltaX?(t=e.wheelDeltaX/2,i=e.wheelDeltaY/2):(t=0,i=e.wheelDelta/2):e.axis&&e.axis===e.HORIZONTAL_AXIS?(t=-10*e.detail,i=0):(t=0,i=-10*e.detail),ve.scrollingY||t||(t=i,i=0),Fe.x=Math.round(Fe.x+t),Fe.y=Math.round(Fe.y+i),E(Re.x+Fe.x,Re.y+Fe.y,e.timeStamp,e),Ye&&clearTimeout(Ye),Ye=setTimeout(function(){Se=!1,ue(),Me=!1,Le=!1,a=!1,ve.windowScrollingActiveFlag&&(window[ve.windowScrollingActiveFlag]=!1),Y(),D()||M()},300)},ce=function(){Ce||Se===!1||"scrollwheel"===Se||(o&&(pe.msSetPointerCapture(Se),pe.addEventListener("MSLostPointerCapture",re,!1)),Ce=!0)},ue=function(){Ce&&(o&&(pe.removeEventListener("MSLostPointerCapture",re,!1),pe.msReleasePointerCapture(Se)),Ce=!1)},he=function(e){if(e.getBoundingClientRect)return e.getBoundingClientRect();for(var t=0,i=0,n=e;n;)t=t+n.offsetLeft-n.scrollLeft,i=i+n.offsetTop-n.scrollTop,n=n.offsetParent;return{left:t,top:i,width:e.offsetWidth,height:e.offsetHeight}},$(),O(),X(!0),de={destroy:y,setSnapSize:b,scrollTo:w,scrollBy:_,updateDimensions:k,addEventListener:x,removeEventListener:T,get scrollHeight(){return _e.content.y},set scrollHeight(e){throw new SyntaxError("scrollHeight is currently read-only - ignoring "+e)},get scrollLeft(){return-$e.x},set scrollLeft(e){return w(e,!1,!1),-$e.x},get scrollTop(){return-$e.y},set scrollTop(e){return w(!1,e,!1),-$e.y},get scrollWidth(){return _e.content.x},set scrollWidth(e){throw new SyntaxError("scrollWidth is currently read-only - ignoring "+e)},get segmentCount(){return ve.snapping?{x:Math.ceil(_e.content.x/ke.x),y:Math.ceil(_e.content.y/ke.y)}:{x:NaN,y:NaN}},set segmentCount(e){throw new SyntaxError("segmentCount is currently read-only - ignoring "+e)},get currentSegment(){return{x:Te.x,y:Te.y}},set currentSegment(e){throw new SyntaxError("currentSegment is currently read-only - ignoring "+e)},get contentContainerNode(){return fe},set contentContainerNode(e){throw new SyntaxError("contentContainerNode is currently read-only - ignoring "+e)}}},e.prototype.getPrependedHTML=function(e,t,i){i||(i="object"==typeof FTScrollerOptions&&FTScrollerOptions.hwAccelerationClass?FTScrollerOptions.hwAccelerationClass:"ftscroller_hwaccelerated");var n='<div class="ftscroller_container">';return e||(n+='<div class="ftscroller_x '+i+'">'),t||(n+='<div class="ftscroller_y '+i+'">'),n},e.prototype.getAppendedHTML=function(e,t,i,n){i||(i="object"==typeof FTScrollerOptions&&FTScrollerOptions.hwAccelerationClass?FTScrollerOptions.hwAccelerationClass:"ftscroller_hwaccelerated");var a="";return e||(a+="</div>"),t||(a+="</div>"),n&&(e||(a+='<div class="ftscroller_scrollbar ftscroller_scrollbarx '+i+'"><div class="ftscroller_scrollbarinner"></div></div>'),t||(a+='<div class="ftscroller_scrollbar ftscroller_scrollbary '+i+'"><div class="ftscroller_scrollbarinner"></div></div>')),a+="</div>"}}(),function(){"use strict";var e;window.CubicBezier=e=function(e,t,i,n){if(!(e>=0&&1>=e))throw new RangeError('"p1x" must be a number between 0 and 1. Got '+e+"instead.");if(!(t>=0&&1>=t))throw new RangeError('"p1y" must be a number between 0 and 1. Got '+t+"instead.");if(!(i>=0&&1>=i))throw new RangeError('"p2x" must be a number between 0 and 1. Got '+i+"instead.");if(!(n>=0&&1>=n))throw new RangeError('"p2y" must be a number between 0 and 1. Got '+n+"instead.");this._p1={x:e,y:t},this._p2={x:i,y:n}},e.prototype._getCoordinateForT=function(e,t,i){var n=3*t,a=3*(i-t)-n,o=1-n-a;return((o*e+a)*e+n)*e},e.prototype._getCoordinateDerivateForT=function(e,t,i){var n=3*t,a=3*(i-t)-n,o=1-n-a;return(3*o*e+2*a)*e+n},e.prototype._getTForCoordinate=function(e,t,i,n){if(!isFinite(n)||0>=n)throw new RangeError('"epsilon" must be a number greater than 0.');var a,o,r,s;for(a=e,o=0;8>o;o+=1){if(r=this._getCoordinateForT(a,t,i)-e,Math.abs(r)<n)return a;if(s=this._getCoordinateDerivateForT(a,t,i),Math.abs(s)<1e-6)break;a-=r/s}a=e;var l=0,c=1;if(l>a)return l;if(a>c)return c;for(;c>l;){if(r=this._getCoordinateForT(a,t,i),Math.abs(r-e)<n)return a;e>r?l=a:c=a,a=.5*(c-l)+l}return a},e.prototype.getPointForT=function(e){if(0===e||1===e)return{x:e,y:e};if(0>e||e>1)throw new RangeError('"t" must be a number between 0 and 1Got '+e+" instead.");return{x:this._getCoordinateForT(e,this._p1.x,this._p2.x),y:this._getCoordinateForT(e,this._p1.y,this._p2.y)}},e.prototype.getTForX=function(e,t){return this._getTForCoordinate(e,this._p1.x,this._p2.x,t)},e.prototype.getTForY=function(e,t){return this._getTForCoordinate(e,this._p1.y,this._p2.y,t)},e.prototype._getAuxPoints=function(e){if(0>=e||e>=1)throw new RangeError('"t" must be greater than 0 and lower than 1');var t={x:e*this._p1.x,y:e*this._p1.y},i={x:this._p1.x+e*(this._p2.x-this._p1.x),y:this._p1.y+e*(this._p2.y-this._p1.y)},n={x:this._p2.x+e*(1-this._p2.x),y:this._p2.y+e*(1-this._p2.y)},a={x:t.x+e*(i.x-t.x),y:t.y+e*(i.y-t.y)},o={x:i.x+e*(n.x-i.x),y:i.y+e*(n.y-i.y)},r={x:a.x+e*(o.x-a.x),y:a.y+e*(o.y-a.y)};return{i0:t,i1:i,i2:n,j0:a,j1:o,k:r}},e.prototype.divideAtT=function(t){if(0>t||t>1)throw new RangeError('"t" must be a number between 0 and 1. Got '+t+" instead.");if(0===t||1===t){var i=[];return i[t]=e.linear(),i[1-t]=this.clone(),i}var n={},a={},o=this._getAuxPoints(t),r=o.i0,s=o.i2,l=o.j0,c=o.j1,u=o.k,h=u.x,d=u.y;return n.p1={x:r.x/h,y:r.y/d},n.p2={x:l.x/h,y:l.y/d},a.p1={x:(c.x-h)/(1-h),y:(c.y-d)/(1-d)},a.p2={x:(s.x-h)/(1-h),y:(s.y-d)/(1-d)},[new e(n.p1.x,n.p1.y,n.p2.x,n.p2.y),new e(a.p1.x,a.p1.y,a.p2.x,a.p2.y)]},e.prototype.divideAtX=function(e,t){if(0>e||e>1)throw new RangeError('"x" must be a number between 0 and 1. Got '+e+" instead.");var i=this.getTForX(e,t);return this.divideAtT(i)},e.prototype.divideAtY=function(e,t){if(0>e||e>1)throw new RangeError('"y" must be a number between 0 and 1. Got '+e+" instead.");var i=this.getTForY(e,t);return this.divideAtT(i)},e.prototype.clone=function(){return new e(this._p1.x,this._p1.y,this._p2.x,this._p2.y)},e.prototype.toString=function(){return"cubic-bezier("+[this._p1.x,this._p1.y,this._p2.x,this._p2.y].join(", ")+")"},e.linear=function(){return new e},e.ease=function(){return new e(.25,.1,.25,1)},e.linear=function(){return new e(0,0,1,1)},e.easeIn=function(){return new e(.42,0,1,1)},e.easeOut=function(){return new e(0,0,.58,1)},e.easeInOut=function(){return new e(.42,0,.58,1)}}(),define("ftscroller",function(e){return function(){var t;return t||e.FTScroller}}(this)),define("views/TicketConfirmView",["underscore","jquery","framework/View","templates/ticket-confirm-view","ftscroller","framework/utils/backend","framework/utils/log","bxslider","models/ticketCart","framework/utils/ticketBackend","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u){"use strict";return i.extend({className:"product-view ticket-view",template:n,events:{"click .ticket-confirm-view-back":"back","click .ticket-confirm-view-confirm":"proceed","click .ticket-confirm-view-repick":"back"},initialize:function(){this.$el.css({opacity:0,scale:2})},_open:function(e){this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0,scale:2},{complete:e})},data:function(){return e.extend(l.model.toJSON(),{emptyTicketsWithSeats:!l.ticketsWithSeatsN,emptyTicketsWithoutSeats:!l.ticketsWithoutSeatsN})},back:function(){window.history.back()},proceed:function(){var e,i=this;Firefly.viewport.showMessage(new u({spinner:!0,message:"Пожалуйста, подождите. Запрос обрабатывается...",closeBtn:!1})),t.ajax({method:"post",dataType:"json",contentType:"application/json",url:c("/cart"),data:JSON.stringify(l.format()),success:function(e){Firefly.viewport.hideMessage(function(){l.id=e.id,Firefly.navigate("main/buyTicket")})},error:function(n){var a,o,r="";try{a=JSON.parse(n.responseText)}catch(s){return void Firefly.viewport.showMessage(new u({message:"Произошла неизвестная ошибка. Пожалуйста, повторите попытку."}))}a.tickets.forEach(function(i){i.available||(o=i.seat_id,r="[data-ticket-id=",r+=void 0!==o?o+"\\:":"",t(r+i.id+"]").addClass("not-available-row"),e=l.getById(i.id,o),e.collection.remove(e))}),Firefly.viewport.showMessage(new u({message:"не все билеты доступны"})),i.$el.find(".ticket-confirm-view-confirm").remove()}})}})}),define("templates/ticket-success-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){
var n,a="";return a+="\n			",(n=i.day)?n=n.call(e,{hash:{},data:t}):(n=e.day,n=typeof n===c?n.apply(e):n),a+=u(n)+".",(n=i.month)?n=n.call(e,{hash:{},data:t}):(n=e.month,n=typeof n===c?n.apply(e):n),a+=u(n)+".",(n=i.year)?n=n.call(e,{hash:{},data:t}):(n=e.year,n=typeof n===c?n.apply(e):n),a+=u(n)+", ",(n=i.hours)?n=n.call(e,{hash:{},data:t}):(n=e.hours,n=typeof n===c?n.apply(e):n),a+=u(n)+":",(n=i.minutes)?n=n.call(e,{hash:{},data:t}):(n=e.minutes,n=typeof n===c?n.apply(e):n),a+=u(n)+"\n		"}function r(e,t){var n,a="";return a+="\n		<h3>Благодарим Вас за использование нашего сервиса!</h3>\n		<h4>Ближайший терминал QIWI находится по адресу:</h4>\n		<h5>",(n=i.qiwiAddress)?n=n.call(e,{hash:{},data:t}):(n=e.qiwiAddress,n=typeof n===c?n.apply(e):n),a+=u(n)+"</h5>\n	"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var s,l="",c="function",u=this.escapeExpression,h=this;return l+='\n<div class="ticket-confirm-view-header">\n	<span>Подтверждение заказа</span>\n</div>\n<div class="ticket-confirm-view-body">\n	<h1>Оформление заказа завершено!</h1>\n	<h2>Бронь действительна до\n		',s=i["with"].call(t,t.paymentDate,{hash:{},inverse:h.noop,fn:h.program(1,o,a),data:a}),(s||0===s)&&(l+=s),l+='\n	</h2>\n	<p>\n		<span>Вы можете произвести оплату на  любом терминале QIWI.</span>\n		<span>более подробная информация о сроках и</span>\n		<span>порядке  оплаты направлены SMS-сообщением на Ваш</span>\n		<span>номер мобильного телефона.</span>\n	</p>\n	<img src="/images/grey-marker.png" class="grey-marker">\n	',s=i["if"].call(t,t.qiwiAddress,{hash:{},inverse:h.noop,fn:h.program(3,r,a),data:a}),(s||0===s)&&(l+=s),l+='\n</div>\n<div class="ticket-success-view-footer">\n    <a href="#main" class="home-button ticket-success-view-home-button"></a>\n    <a href="#main" class="button ticket-success-view-done-button">готово</a>\n\n</div>\n'})}),define("views/TicketSuccessView",["underscore","jquery","framework/View","models/Product","templates/ticket-success-view","models/ticketCart"],function(e,t,i,n,a,o){"use strict";return i.extend({className:"ticket-view",template:a,events:{"click .ticket-confirm-view-back":"back"},initialize:function(){this.$el.css({opacity:0,scale:2})},_open:function(e){var t=this.model.options.qiwiCoords;Array.isArray(t)&&t.length>1&&window.Firefly.trigger("map:locations:ticket",t),this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0,scale:2},{complete:e})},_load:function(e){var t=new Date(o.model.get("ttl")),i={day:t.getDate(),month:t.getMonth()+1,year:t.getFullYear(),hours:t.getHours(),minutes:t.getMinutes()};i.day=(i.day<10?"0":"")+i.day,i.month=(i.month<10?"0":"")+i.month,i.minutes=(i.minutes<10?"0":"")+i.minutes,this.model={options:{qiwiAddress:Firefly.config("qiwiAddress"),qiwiCoords:Firefly.config("qiwiCoords"),paymentDate:i},toJSON:function(){return this.options}},e()},back:function(){window.history.back()}})}),define("views/SearchResultsView",["jquery","framework/View","templates/subcategory-view","framework/utils/backend","framework/utils/i18n","framework/utils/log"],function(e,t,i,n,a,o){"use strict";var r=615;return t.extend({className:"subcategory-view",template:i,i18n:!0,events:{"click .back-button":"back","click .subcategory-view-next-page-button":"next","click .subcategory-view-previous-page-button":"previous","click .subcategory-view-list-a":"sendStatistics"},initialize:function(e){e=e||{},this.currentPage=e.page||0,this._query=e.query,this.$el.css({opacity:0,scale:2})},sendStatistics:function(t){this.logEvent(t),o.event("search:product",{id:e(t.currentTarget).data("id"),query:this._query})},_load:function(t){function i(e){a._results=e,t()}var a=this;e.getJSON(n("products"),{q:this._query,lang:Firefly.lang()}).done(i)},data:function(){return{name:a("Search"),products:this._results}},afterRender:function(){this.$(".subcategory-view-list").css({top:0}),this.currentPage||(this.currentPage=0);var e=this._results?this._results.length:0;e>4?(this.pages=e%4===0?e/4:Math.floor(e/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages):(this.$(".subcategory-view-scroll").hide(),this.$(".subcategory-view-next-page-button").hide(),this.$(".subcategory-view-previous-page-button").hide()),this._results&&(this.pages=this._results.length%4===0?this._results.length/4:Math.floor(this._results.length/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages),this.goToPageStatic(this.currentPage)},back:function(){window.history.back()},_open:function(e){this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0,scale:2},{complete:e})},goToPageStatic:function(e){this.$(".subcategory-view-list").css({top:-r*e}),this.$(".subcategory-view-scroll-knob").css({top:this.scrollStep*e}),this.currentPage=e},goToPage:function(e){this.$(".subcategory-view-list").animate({top:-r*e}),this.$(".subcategory-view-scroll-knob").animate({top:this.scrollStep*e}),this.currentPage=e},next:function(){this.currentPage<this.pages-1&&window.Firefly.router.navigate("main/search/"+encodeURI(this._query)+"/"+(this.currentPage+1),{trigger:!0,replace:!0})},previous:function(){this.currentPage>0&&window.Firefly.router.navigate("main/search/"+encodeURI(this._query)+"/"+(this.currentPage-1),{trigger:!0,replace:!0})}})}),define("templates/main-screen",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{},'<div class="main-screen-header">\n</div>\n<div class="main-screen-content">\n	<div class="main-screen-search">\n	</div>\n</div>\n<div class="main-screen-footer">\n</div>\n'})}),define("templates/hotel-categories-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+='\n            <li>\n                <a class="category-view-item-a" href="',(n=i.url)?n=n.call(e,{hash:{},data:t}):(n=e.url,n=typeof n===c?n.apply(e):n),a+=u(n)+'">\n                    <figure>\n                        <img src="',(n=i.icon)?n=n.call(e,{hash:{},data:t}):(n=e.icon,n=typeof n===c?n.apply(e):n),a+=u(n)+'">\n                        <figcaption>\n                            ',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===c?n.apply(e):n),a+=u(n)+"\n                        </figcaption>\n                    </figure>\n                </a>\n            </li>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var r,s,l="",c="function",u=this.escapeExpression,h=this,d=i.helperMissing;return l+='<h1 class="category-view-name">Отели</h1>\n<div class="category-view-list-wrapper">\n    <ul class="category-view-list">\n        ',r=i.each.call(t,t,{hash:{},inverse:h.noop,fn:h.program(1,o,a),data:a}),(r||0===r)&&(l+=r),l+='\n    </ul>\n</div>\n<span class="category-view-breadcrumbs"><a href="#main"\n                                           class="home-button"></a> <i\n        class="light-arrow"></i><button class="back-button">',s={hash:{},data:a},l+=u((r=i.i18n,r?r.call(t,"BACK",s):d.call(t,"i18n","BACK",s)))+"</button></span>\n"})}),define("views/HotelCategoriesView",["jquery","framework/View","templates/hotel-categories-view","framework/utils/log","framework/utils/async"],function(e,t,i,n,a){"use strict";var o=5,r=50,s=30,l=130,c=160,u=800,h=150;return t.extend({className:"category-view",template:i,i18n:!0,events:{"click .back-button":"back","click .category-view-item-a":"logEvent"},initialize:function(){this.$el.css({opacity:0,scale:2})},back:function(){window.history.back()},data:function(){return[{id:490,name:"Отель",icon:"/images/hostel.png",url:"#main/hotel"},{id:492,name:"Апартаменты",icon:"/images/apartamenti.png",url:"#main/apart"},{id:495,name:"Хостел",icon:"/images/hostel.png",url:"#main/hostel"},{id:494,name:"База отдыха",icon:"/images/baza.png",url:"#main/restbase"}]},afterRender:function(){this._items=this.$(".category-view-list > li");var t=this._items.length,i=t%o?Math.floor(t/o)+1:t/o,a=1===i?t*(l+s)-s:o*(l+s)-s,d=i*(c+r)-r;t&&(this.duration=Math.max(h,u/t)),n.trace("item count: "+t),n.trace("row count: "+i),n.trace("list width: "+a),n.trace("list height: "+d),this.$(".category-view-list").css({top:(615-d)/2,left:(900-a)/2,width:a,height:d}),this._items.each(function(t,i){var a=t%o,u=Math.floor(t/o);n.trace("xIndex: "+a),n.trace("yIndex: "+u),e(i).css({top:u*(c+r),left:a*(l+s),scale:2,opacity:0})})},_open:function(t){var i=[],n=this.duration,o=this.$el;i.push(function(e){o.animate({opacity:1,scale:1},e)}),this._items.each(function(t,a){n-=5,i.push(function(t){e(a).animate({scale:1,opacity:1},n,t)})}),a.serial(i,t)},_close:function(t){var i=[],n=this.duration,o=this.$el;i.push(function(e){o.animate({opacity:0,scale:2},e)}),this._items.each(function(t,a){n-=5,i.unshift(function(t){e(a).animate({scale:2,opacity:0},n,t)})}),a.serial(i,t)}})}),define("templates/hotels-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a,o,u="";return u+='\n            <a class="subcategory-view-list-a" href="#main/hotel">\n                <div class="subcategory-view-list-item">\n                    <h1 class="subcategory-view-list-item-name">',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===p?n.apply(e):n),u+=f(n)+'</h1>\n\n                    <div class="subcategory-view-list-item-image-background',n=i["if"].call(e,e.recommended,{hash:{},inverse:m.noop,fn:m.program(2,r,t),data:t}),(n||0===n)&&(u+=n),u+='">\n                        <img class="subcategory-view-list-item-image" src="',n=i["if"].call(e,e.logo,{hash:{},inverse:m.program(6,l,t),fn:m.program(4,s,t),data:t}),(n||0===n)&&(u+=n),u+='">\n                    </div>\n                    <div class="subcategory-view-list-item-info">\n                        <div class="subcategory-view-list-item-description">\n                            ',(n=i.shortDesc)?n=n.call(e,{hash:{},data:t}):(n=e.shortDesc,n=typeof n===p?n.apply(e):n),u+=f(n)+'\n                        </div>\n                        <div class="subcategory-view-list-item-location">\n                            '+f((n=e.locations,n=null==n||n===!1?n:n[0],n=null==n||n===!1?n:n.address,typeof n===p?n.apply(e):n))+'\n                        </div>\n                        <div class="subcategory-view-list-more-info">',a=i["if"].call(e,e.discount,{hash:{},inverse:m.noop,fn:m.program(8,c,t),data:t}),(a||0===a)&&(u+=a),o={hash:{},data:t},u+=f((n=i.i18n,n?n.call(e,"MORE INFO",o):v.call(e,"i18n","MORE INFO",o)))+'<i\n                                class="light-arrow-d"></i>\n                            <i class="light-arrow-d"></i>\n                        </div>\n                    </div>\n                </div>\n            </a>\n        '}function r(e,t){return" subcategory-view-list-item-image-background-recommended"}function s(e,t){var n;return(n=i.logo)?n=n.call(e,{hash:{},data:t}):(n=e.logo,n=typeof n===p?n.apply(e):n),f(n)}function l(e,t){return"/images/no-image-logo.png"}function c(e,t){return'<i\n                                class="discount-icon"></i>'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var u,h,d="",p="function",f=this.escapeExpression,m=this,v=i.helperMissing;return d+='<h1 class="subcategory-view-name">\n    Отели\n</h1>\n<div class="subcategory-view-list-wrapper">\n    <div class="subcategory-view-list">\n        ',u=i.each.call(t,t,{hash:{},inverse:m.noop,fn:m.program(1,o,a),data:a}),(u||0===u)&&(d+=u),d+='\n    </div>\n</div>\n<div class="subcategory-view-scroll">\n    <div class="subcategory-view-scroll-knob">\n    </div>\n</div>\n<span class="subcategory-view-breadcrumbs"><a href="#main"\n                                              class="home-button"></a>\n    <i class="light-arrow"></i><button class="back-button">',h={hash:{},data:a},d+=f((u=i.i18n,u?u.call(t,"BACK",h):v.call(t,"i18n","BACK",h)))+'</button></span>\n<button class="subcategory-view-previous-page-button"></button>\n<button class="subcategory-view-next-page-button"></button>'})}),define("views/HotelsView",["framework/View","templates/hotels-view"],function(e,t){"use strict";var i=615;return e.extend({className:"subcategory-view",template:t,i18n:!0,events:{"click .back-button":"back","click .subcategory-view-next-page-button":"next","click .subcategory-view-previous-page-button":"previous","click .subcategory-view-list-a":"logEvent"},initialize:function(e){e=e||{},this.currentPage=e.page||0,this.$el.css({opacity:0,scale:2})},data:function(e){return[{id:6610,name:"Гостиница «Владимир»",shortDesc:"Гостиница находится в историческом центре города, располагает полностью оборудованными комфортабельными одно- и двухместными номерами высшей и первой категории. Разнообразный туристический сервис, свой ресторан и банкетный зал.",recommended:!0,logo:"/images/DSCN0041.jpg",locations:[{address:"ул.Большая Московская, 74",latitude:56.132002,longitude:40.416139}]},{id:6614,name:"Гостиница «У Золотых Ворот»",shortDesc:"Гостиница находится в самом центре Владимира. Все интерьеры отеля стилизованы под классицизм. В нем 14 номеров (одно- и двухместных), в том числе один двухкомнатный номер «люкс». Окна большинства номеров выходят на центральную улицу города.",recommended:!0,logo:"/images/04061417034113_gostinica-y-zolotih-vorot-vladimir.jpg",locations:[{address:"ул.Большая Московская, 15",latitude:56.127823,longitude:40.400625}]},{id:6615,name:"Туристический комплекс «Русская Деревня»",shortDesc:"Гостиница «Русская деревня» расположена в живописном уголке Владимира в лесопарковой зоне при въезде в город со стороны Москвы. ГК состоит из 4 двухэтажных домов, в которых могут разместиться 64 человека, а включая административное здание, комплекс может принять до 100 человек.",recommended:!0,logo:"/images/RusDerHotSml3.jpg",locations:[{address:"Московское шоссе, 5А",latitude:56.110826,longitude:40.327538}]},{id:6616,name:"Гостинично-развлекательный комплекс ГРК «АМАКС Золотое кольцо»",shortDesc:"Гостинично-развлекательный комплекс «АМАКС Золотое кольцо» расположен в оживленной части города Владимира, рядом с остановками городского транспорта. Одновременно в гостинице комплекса могут разместиться 450 человек. ",recommended:!0,logo:"/images/ZKHotSml.jpg",locations:[{address:"ул. Чайковского, 27",latitude:56.130748,longitude:40.358009}]},{id:6616,name:"Гостиница при Эрлангенском Доме",shortDesc:"Ваш кров во время деловых и личных поездок, а также поездок небольшими группами по Золотому кольцу. Эрлангенский дом предлагает Вам крыло здания для ночлега с 4-мя комнатами на двоих и маленькой квартирой, помещение для завтрака, аренда комнаты для переговоров и пр.",recommended:!1,logo:"/images/enter-winter.jpg",locations:[{address:"Большая Нижегородская улица, 25 ",latitude:56.135855,longitude:40.425778}]},{id:6616,name:"Гостиница «Гостевой домик»",shortDesc:"К Вашим услугам: три 2-х  местных и один одноместный номера, холл для отдыха с камином и водопадом. При проживании более 2-х суток предоставляются скидки. ",recommended:!1,logo:"/images/gdvladhotel.jpg",locations:[{address:"ул.Демьяна Бедного, 13",latitude:56.126805,longitude:40.382057}]},{id:6616,name:"Гостиница «Владимирский дворик» ",shortDesc:"7 уютных номеров (одноместный, двухместные, люкс), с возможностью дополнительного спального места. В каждом номере: кондиционер, индивидуальный сейф, ванная с душем, фен, телефон, телевизор и холодильник. Также номера оборудованы регулируемым отоплением, приточно-вытяжной вентиляцией, автономной системой водоснабжения.",recommended:!1,logo:"/images/VDzdSml.jpg",locations:[{address:"ул. Подбельского, д.12",latitude:56.132268,longitude:40.411135}]}]},afterRender:function(){this.$(".subcategory-view-list").css({top:0}),this.currentPage||(this.currentPage=0);var e=this.data().length;e>4?(this.pages=e%4===0?e/4:Math.floor(e/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages):(this.$(".subcategory-view-scroll").hide(),this.$(".subcategory-view-next-page-button").hide(),this.$(".subcategory-view-previous-page-button").hide()),this.pages=e%4===0?e/4:Math.floor(e/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages,this.goToPageStatic(this.currentPage)},back:function(){window.history.back()},_open:function(e){this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0,scale:2},{complete:e})},goToPageStatic:function(e){this.$(".subcategory-view-list").css({top:-i*e}),this.$(".subcategory-view-scroll-knob").css({top:this.scrollStep*e}),this.currentPage=e},goToPage:function(e){this.$(".subcategory-view-list").animate({top:-i*e}),this.$(".subcategory-view-scroll-knob").animate({top:this.scrollStep*e}),this.currentPage=e},next:function(){if(this.currentPage<this.pages-1){var e="main/hotels/"+(this.currentPage+1);window.history.replaceState({},"","#"+e),this.goToPage(this.currentPage+1)}},previous:function(){if(this.currentPage>0){var e="main/hotels/"+(this.currentPage-1);window.history.replaceState({},"","#"+e),this.goToPage(this.currentPage-1)}}})}),define("templates/dosug-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+='\n            <li>\n                <a class="category-view-item-a" href="',(n=i.url)?n=n.call(e,{hash:{},data:t}):(n=e.url,n=typeof n===c?n.apply(e):n),a+=u(n)+'">\n                    <figure>\n                        <img src="',(n=i.icon)?n=n.call(e,{hash:{},data:t}):(n=e.icon,n=typeof n===c?n.apply(e):n),a+=u(n)+'">\n                        <figcaption>\n                            ',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===c?n.apply(e):n),a+=u(n)+"\n                        </figcaption>\n                    </figure>\n                </a>\n            </li>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var r,s,l="",c="function",u=this.escapeExpression,h=this,d=i.helperMissing;return l+='<h1 class="category-view-name">Досуг</h1>\n<div class="category-view-list-wrapper">\n    <ul class="category-view-list">\n        ',r=i.each.call(t,t,{hash:{},inverse:h.noop,fn:h.program(1,o,a),data:a}),(r||0===r)&&(l+=r),l+='\n    </ul>\n</div>\n<span class="category-view-breadcrumbs"><a href="#main"\n                                           class="home-button"></a> <i\n        class="light-arrow"></i><button class="back-button">',s={hash:{},data:a},l+=u((r=i.i18n,r?r.call(t,"BACK",s):d.call(t,"i18n","BACK",s)))+"</button></span>\n"})}),define("views/DosugView",["jquery","framework/View","templates/dosug-view","framework/utils/log","framework/utils/async"],function(e,t,i,n,a){"use strict";var o=5,r=50,s=30,l=130,c=160,u=800,h=150;return t.extend({className:"category-view",template:i,i18n:!0,events:{"click .back-button":"back","click .category-view-item-a":"logEvent"},initialize:function(){this.$el.css({opacity:0,scale:2})},back:function(){window.history.back()},data:function(){return[{id:469,name:"Развлекательный центр",icon:"/images/3049.png",url:"#main/samohval"},{id:472,name:"Ночной клуб",icon:"/images/3052.png",url:"#main/club"},{id:470,name:" Боулинг",url:"#main/bouling",icon:"/images/3050.png"},{id:471,name:"Кинотеатр",icon:"/images/3051.png",url:"#main/theater"},{id:475,name:"Стадион и каток",icon:"/images/3055.png",url:"#main/stadion"},{id:473,name:"Парк",icon:"/images/3053.png",url:"#main/park"}]},afterRender:function(){this._items=this.$(".category-view-list > li");var t=this._items.length,i=t%o?Math.floor(t/o)+1:t/o,a=1===i?t*(l+s)-s:o*(l+s)-s,d=i*(c+r)-r;t&&(this.duration=Math.max(h,u/t)),n.trace("item count: "+t),n.trace("row count: "+i),n.trace("list width: "+a),n.trace("list height: "+d),this.$(".category-view-list").css({top:(615-d)/2,left:(900-a)/2,width:a,height:d}),this._items.each(function(t,i){var a=t%o,u=Math.floor(t/o);n.trace("xIndex: "+a),n.trace("yIndex: "+u),e(i).css({top:u*(c+r),left:a*(l+s),scale:2,opacity:0})})},_open:function(t){var i=[],n=this.duration,o=this.$el;i.push(function(e){o.animate({opacity:1,scale:1},e)}),this._items.each(function(t,a){n-=5,i.push(function(t){e(a).animate({scale:1,opacity:1},n,t)})}),a.serial(i,t)},_close:function(t){var i=[],n=this.duration,o=this.$el;i.push(function(e){o.animate({opacity:0,scale:2},e)}),this._items.each(function(t,a){n-=5,i.unshift(function(t){e(a).animate({scale:2,opacity:0},n,t)})}),a.serial(i,t)}})}),define("templates/theater-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){return" product-view-name-recommended"}function r(e,t){var n;return(n=i.logo)?n=n.call(e,{hash:{},data:t}):(n=e.logo,n=typeof n===_?n.apply(e):n),k(n)}function s(e,t){return"/images/no-image-logo.png"}function l(e,t){var n,a,o="";return o+='\n            <div><span class="product-view-contacts-item-heading">',a={hash:{},data:t},o+=k((n=i.i18n,n?n.call(e,"Address",a):x.call(e,"i18n","Address",a)))+":</span>"+k((n=e.locations,n=null==n||n===!1?n:n[0],n=null==n||n===!1?n:n.address,typeof n===_?n.apply(e):n))+"\n            </div>"}function c(e,t){var n,a,o="";return o+='\n            <div><span class="product-view-contacts-item-heading">',a={hash:{},data:t},o+=k((n=i.i18n,n?n.call(e,"Phone",a):x.call(e,"i18n","Phone",a)))+":</span>"+k((n=e.phones,n=null==n||n===!1?n:n[0],typeof n===_?n.apply(e):n))+"\n            </div>"}function u(e,t){var n,a,o,r="";return r+='\n            <div><span class="product-view-contacts-item-heading">',o={hash:{},data:t},r+=k((n=i.i18n,n?n.call(e,"Opening hours",o):x.call(e,"i18n","Opening hours",o)))+":</span>",(a=i.workTime)?a=a.call(e,{hash:{},data:t}):(a=e.workTime,a=typeof a===_?a.apply(e):a),r+=k(a)+"\n            </div>"}function h(e,t){var n,a,o,r="";return r+='\n            <div><span class="product-view-contacts-item-heading">',o={hash:{},data:t},r+=k((n=i.i18n,n?n.call(e,"Metro",o):x.call(e,"i18n","Metro",o)))+":</span>",(a=i.metro)?a=a.call(e,{hash:{},data:t}):(a=e.metro,a=typeof a===_?a.apply(e):a),r+=k(a)+"</div>"}function d(e,t){var n,a,o,r="";return r+='\n            <div><span class="product-view-contacts-item-heading">',o={hash:{},data:t},r+=k((n=i.i18n,n?n.call(e,"Website",o):x.call(e,"i18n","Website",o)))+":</span>",(a=i.site)?a=a.call(e,{hash:{},data:t}):(a=e.site,a=typeof a===_?a.apply(e):a),r+=k(a)+"</div>"}function p(e,t){var n,a,o,r="";return r+='\n        <div class="product-view-discount product-view-discount-',(n=i.templateId)?n=n.call(e,{hash:{},data:t}):(n=e.templateId,n=typeof n===_?n.apply(e):n),r+=k(n)+'">\n            <span class="product-view-discount-heading">',o={hash:{},data:t},r+=k((n=i.i18n,n?n.call(e,"DISCOUNT",o):x.call(e,"i18n","DISCOUNT",o)))+'</span><span\n                class="product-view-discount-amount">',(a=i.discount)?a=a.call(e,{hash:{},data:t}):(a=e.discount,a=typeof a===_?a.apply(e):a),r+=k(a)+'</span><i class="discount-icon-light"></i>\n        </div>\n    '}function f(e,t){var n,a="";return a+="\n                ",n=i.each.call(e,e.images,{hash:{},inverse:T.noop,fn:T.program(20,m,t),data:t}),(n||0===n)&&(a+=n),a+="\n            "}function m(e,t){var i="";return i+='\n                    <li><img src="'+k(typeof e===_?e.apply(e):e)+'"></li>\n                '}function v(e,t){return'\n                <li><img src="/images/no-image.png"></li>\n            '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var g,y,b,w="",_="function",k=this.escapeExpression,x=i.helperMissing,T=this;return w+='<h1 class="product-view-name',g=i["if"].call(t,t.recommended,{hash:{},inverse:T.noop,fn:T.program(1,o,a),data:a}),(g||0===g)&&(w+=g),w+='">',(g=i.name)?g=g.call(t,{hash:{},data:a}):(g=t.name,g=typeof g===_?g.apply(t):g),w+=k(g)+'</h1>\n<div class="product-view-wrapper">\n    <img src="',g=i["if"].call(t,t.logo,{hash:{},inverse:T.program(5,s,a),fn:T.program(3,r,a),data:a}),(g||0===g)&&(w+=g),w+='"\n         class="product-view-logo product-view-logo-',(g=i.templateId)?g=g.call(t,{hash:{},data:a}):(g=t.templateId,g=typeof g===_?g.apply(t):g),w+=k(g)+'">\n\n    <div class="product-view-contacts product-view-contacts-',(g=i.templateId)?g=g.call(t,{hash:{},data:a}):(g=t.templateId,g=typeof g===_?g.apply(t):g),w+=k(g)+'">\n        <h1 class="product-view-contacts-heading">',b={hash:{},data:a},w+=k((g=i.i18n,g?g.call(t,"CONTACTS",b):x.call(t,"i18n","CONTACTS",b)))+":</h1>\n\n        ",y=i["if"].call(t,(g=t.locations,null==g||g===!1?g:g[0]),{hash:{},inverse:T.noop,fn:T.program(7,l,a),data:a}),(y||0===y)&&(w+=y),w+="\n        ",y=i["if"].call(t,(g=t.phones,null==g||g===!1?g:g[0]),{hash:{},inverse:T.noop,fn:T.program(9,c,a),data:a}),(y||0===y)&&(w+=y),w+="\n        ",y=i["if"].call(t,t.workTime,{hash:{},inverse:T.noop,fn:T.program(11,u,a),data:a}),(y||0===y)&&(w+=y),w+="\n        ",y=i["if"].call(t,t.metro,{hash:{},inverse:T.noop,fn:T.program(13,h,a),data:a}),(y||0===y)&&(w+=y),w+="\n        ",y=i["if"].call(t,t.site,{hash:{},inverse:T.noop,fn:T.program(15,d,a),data:a}),(y||0===y)&&(w+=y),w+='\n    </div>\n    <div class="product-view-info product-view-info-',(y=i.templateId)?y=y.call(t,{hash:{},data:a}):(y=t.templateId,y=typeof y===_?y.apply(t):y),w+=k(y)+'">\n        <h1 class="product-view-info-heading">',b={hash:{},data:a},w+=k((g=i.i18n,g?g.call(t,"ABOUT",b):x.call(t,"i18n","ABOUT",b)))+'</h1>\n\n        <div class="product-view-description">\n            <article>\n                ',b={hash:{},data:a},w+=k((g=i.paragraphize,g?g.call(t,t.description,b):x.call(t,"paragraphize",t.description,b)))+'\n            </article>\n        </div>\n    </div>\n    <div class="product-view-description-scroll product-view-description-scroll-',(y=i.templateId)?y=y.call(t,{hash:{},data:a}):(y=t.templateId,y=typeof y===_?y.apply(t):y),w+=k(y)+'">\n        <div class="product-view-description-scroll-knob">\n        </div>\n    </div>\n    ',y=i["if"].call(t,t.discount,{hash:{},inverse:T.noop,fn:T.program(17,p,a),data:a}),(y||0===y)&&(w+=y),w+='\n    <div class="product-view-slider-wrapper product-view-slider-wrapper-',(y=i.templateId)?y=y.call(t,{hash:{},data:a}):(y=t.templateId,y=typeof y===_?y.apply(t):y),w+=k(y)+'">\n        <ul class="bxslider product-view-slider">\n            ',y=i["if"].call(t,(g=t.images,null==g||g===!1?g:g[0]),{hash:{},inverse:T.program(22,v,a),fn:T.program(19,f,a),data:a}),(y||0===y)&&(w+=y),w+='\n        </ul>\n    </div>\n</div>\n<span class="product-view-breadcrumbs">\n    <a href="#main"\n       class="home-button"></a>\n    <i class="light-arrow"></i><button class="back-button">',b={hash:{},data:a},w+=k((g=i.i18n,g?g.call(t,"BACK",b):x.call(t,"i18n","BACK",b)))+'</button>\n</span>\n\n<button class="print-button">БИЛЕТЫ</button>\n'})}),define("views/TheaterView",["underscore","jquery","framework/View","models/Product","templates/theater-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back","click .print-button":"goToEvents"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Киноплекс Молл",description:"Киноплекс Молл в Липецке – это 5 стильных комфортабельных залов на 199, 117 и 102 места, оснащенных новейшим кинопроекционным оборудованием и суперсовременной акустической аппаратурой для полного погружения в любимое кино. Залы кинотеатра «Киноплекс Молл» оборудованы новейшей технологией RealD. Уникальный современный дизайн кинотеатра создаст позитивную атмосферу и хорошее настроение гостям киноцентра «Киноплекс Молл» в Липецке. Кинотеатр в Тамбове располагает площадью и техническими возможностями для проведения мероприятий различного формата",locations:[{address:"г. Липецк, ул. Терешковой, д. 25б, ТРЦ «Малибу»"}],site:"http://wikicinema.ru",phones:["+7 (4742) 517638"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image4.jpeg"]}},_open:function(e){this.printAvailable=!0,this.printDiscountAvailable=!0;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},goToEvents:function(){Firefly.navigate("main/theater-events")}})}),define("templates/culture-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+='\n            <li>\n                <a class="category-view-item-a" href="',(n=i.url)?n=n.call(e,{hash:{},data:t}):(n=e.url,n=typeof n===c?n.apply(e):n),a+=u(n)+'">\n                    <figure>\n                        <img src="',(n=i.icon)?n=n.call(e,{hash:{},data:t}):(n=e.icon,n=typeof n===c?n.apply(e):n),a+=u(n)+'">\n                        <figcaption>\n                            ',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===c?n.apply(e):n),a+=u(n)+"\n                        </figcaption>\n                    </figure>\n                </a>\n            </li>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var r,s,l="",c="function",u=this.escapeExpression,h=this,d=i.helperMissing;return l+='<h1 class="category-view-name">Культура</h1>\n<div class="category-view-list-wrapper">\n    <ul class="category-view-list">\n        ',r=i.each.call(t,t,{hash:{},inverse:h.noop,fn:h.program(1,o,a),data:a}),(r||0===r)&&(l+=r),l+='\n    </ul>\n</div>\n<span class="category-view-breadcrumbs"><a href="#main"\n                                           class="home-button"></a> <i\n        class="light-arrow"></i><button class="back-button">',s={hash:{},data:a},l+=u((r=i.i18n,r?r.call(t,"BACK",s):d.call(t,"i18n","BACK",s)))+"</button></span>\n"})}),define("views/CultureView",["jquery","framework/View","templates/culture-view","framework/utils/log","framework/utils/async"],function(e,t,i,n,a){"use strict";var o=5,r=50,s=30,l=130,c=160,u=800,h=150;return t.extend({className:"category-view",template:i,i18n:!0,events:{"click .back-button":"back","click .category-view-item-a":"logEvent"},initialize:function(){this.$el.css({opacity:0,scale:2})},back:function(){window.history.back()},data:function(){return[{id:496,name:"Художественный музей",icon:"/images/4.png",url:"#main/hud"},{id:494,name:"Краеведческий музей",icon:"/images/3.png",url:"#main/kraev"},{id:492,name:"Религиозные памятники",icon:"/images/lipeck/relig.png",url:"#main/museum"},{id:491,name:"Библиотека",icon:"/images/2.png",url:"#main/culcenter"}]},afterRender:function(){this._items=this.$(".category-view-list > li");var t=this._items.length,i=t%o?Math.floor(t/o)+1:t/o,a=1===i?t*(l+s)-s:o*(l+s)-s,d=i*(c+r)-r;t&&(this.duration=Math.max(h,u/t)),n.trace("item count: "+t),n.trace("row count: "+i),n.trace("list width: "+a),n.trace("list height: "+d),this.$(".category-view-list").css({top:(615-d)/2,left:(900-a)/2,width:a,height:d}),this._items.each(function(t,i){var a=t%o,u=Math.floor(t/o);n.trace("xIndex: "+a),n.trace("yIndex: "+u),e(i).css({top:u*(c+r),left:a*(l+s),scale:2,opacity:0})})},_open:function(t){var i=[],n=this.duration,o=this.$el;i.push(function(e){o.animate({opacity:1,scale:1},e)}),this._items.each(function(t,a){n-=5,i.push(function(t){e(a).animate({scale:1,opacity:1},n,t)})}),a.serial(i,t);
},_close:function(t){var i=[],n=this.duration,o=this.$el;i.push(function(e){o.animate({opacity:0,scale:2},e)}),this._items.each(function(t,a){n-=5,i.unshift(function(t){e(a).animate({scale:2,opacity:0},n,t)})}),a.serial(i,t)}})}),define("templates/theater-events-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a,o,u="";return u+='\n            <a class="subcategory-view-list-a" href="#main/ticket">\n                <div class="subcategory-view-list-item">\n                    <h1 class="subcategory-view-list-item-name">',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===p?n.apply(e):n),u+=f(n)+'</h1>\n\n                    <div class="subcategory-view-list-item-image-background',n=i["if"].call(e,e.recommended,{hash:{},inverse:m.noop,fn:m.program(2,r,t),data:t}),(n||0===n)&&(u+=n),u+='">\n                        <img class="subcategory-view-list-item-image" src="',n=i["if"].call(e,e.logo,{hash:{},inverse:m.program(6,l,t),fn:m.program(4,s,t),data:t}),(n||0===n)&&(u+=n),u+='">\n                    </div>\n                    <div class="subcategory-view-list-item-info">\n                        <div class="subcategory-view-list-item-description">\n                            ',(n=i.shortDesc)?n=n.call(e,{hash:{},data:t}):(n=e.shortDesc,n=typeof n===p?n.apply(e):n),u+=f(n)+'\n                        </div>\n                        <div class="subcategory-view-list-item-location">\n                            '+f((n=e.locations,n=null==n||n===!1?n:n[0],n=null==n||n===!1?n:n.address,typeof n===p?n.apply(e):n))+'\n                        </div>\n                        <div class="subcategory-view-list-more-info">',a=i["if"].call(e,e.discount,{hash:{},inverse:m.noop,fn:m.program(8,c,t),data:t}),(a||0===a)&&(u+=a),o={hash:{},data:t},u+=f((n=i.i18n,n?n.call(e,"MORE INFO",o):v.call(e,"i18n","MORE INFO",o)))+'<i\n                                class="light-arrow-d"></i>\n                            <i class="light-arrow-d"></i>\n                        </div>\n                    </div>\n                </div>\n            </a>\n        '}function r(e,t){return" subcategory-view-list-item-image-background-recommended"}function s(e,t){var n;return(n=i.logo)?n=n.call(e,{hash:{},data:t}):(n=e.logo,n=typeof n===p?n.apply(e):n),f(n)}function l(e,t){return"/images/no-image-logo.png"}function c(e,t){return'<i\n                                class="discount-icon"></i>'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var u,h,d="",p="function",f=this.escapeExpression,m=this,v=i.helperMissing;return d+='<h1 class="subcategory-view-name">\n    Спектакли\n</h1>\n<div class="subcategory-view-list-wrapper">\n    <div class="subcategory-view-list">\n        ',u=i.each.call(t,t,{hash:{},inverse:m.noop,fn:m.program(1,o,a),data:a}),(u||0===u)&&(d+=u),d+='\n    </div>\n</div>\n<div class="subcategory-view-scroll">\n    <div class="subcategory-view-scroll-knob">\n    </div>\n</div>\n<span class="subcategory-view-breadcrumbs"><a href="#main"\n                                              class="home-button"></a>\n    <i class="light-arrow"></i><button class="back-button">',h={hash:{},data:a},d+=f((u=i.i18n,u?u.call(t,"BACK",h):v.call(t,"i18n","BACK",h)))+'</button></span>\n<button class="subcategory-view-previous-page-button"></button>\n<button class="subcategory-view-next-page-button"></button>'})}),define("views/TheaterEventsView",["framework/View","templates/theater-events-view"],function(e,t){"use strict";var i=615;return e.extend({className:"subcategory-view",template:t,i18n:!0,events:{"click .back-button":"back","click .subcategory-view-next-page-button":"next","click .subcategory-view-previous-page-button":"previous","click .subcategory-view-list-a":"logEvent"},initialize:function(e){e=e||{},this.currentPage=e.page||0,this.$el.css({opacity:0,scale:2})},data:function(e){return[{name:"007: СПЕКТР. 19 ноября.",shortDesc:"Зашифрованное послание из неизвестного источника выводит Бонда на след зловещей глобальной организации под кодовым названием СПЕКТР, в то время как М пытается спасти секретную разведывательную службу от ликвидации.",logo:"/images/lipeck/spectre.jpg",locations:[{address:"г. Липецк, ул. Терешковой, д. 25б, ТРЦ «Малибу»"}]},{name:"Марсианин. 19 ноября.",shortDesc:"Марсианская миссия «Арес-3» в процессе работы была вынуждена экстренно покинуть планету из-за надвигающейся песчаной бури. Инженер и биолог Марк Уотни получил повреждение скафандра во время песчаной бури. Сотрудники миссии, посчитав его погибшим, эвакуировались с планеты, оставив Марка одного.",logo:"/images/lipeck/mars.jpg",locations:[{address:"г. Липецк, ул. Терешковой, д. 25б, ТРЦ «Малибу»"}]}]},afterRender:function(){this.$(".subcategory-view-list").css({top:0}),this.currentPage||(this.currentPage=0);var e=this.data().length;e>4?(this.pages=e%4===0?e/4:Math.floor(e/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages):(this.$(".subcategory-view-scroll").hide(),this.$(".subcategory-view-next-page-button").hide(),this.$(".subcategory-view-previous-page-button").hide()),this.pages=e%4===0?e/4:Math.floor(e/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages,this.goToPageStatic(this.currentPage)},back:function(){window.history.back()},_open:function(e){this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0,scale:2},{complete:e})},goToPageStatic:function(e){this.$(".subcategory-view-list").css({top:-i*e}),this.$(".subcategory-view-scroll-knob").css({top:this.scrollStep*e}),this.currentPage=e},goToPage:function(e){this.$(".subcategory-view-list").animate({top:-i*e}),this.$(".subcategory-view-scroll-knob").animate({top:this.scrollStep*e}),this.currentPage=e},next:function(){if(this.currentPage<this.pages-1){var e="main/theater-events/"+(this.currentPage+1);window.history.replaceState({},"","#"+e),this.goToPage(this.currentPage+1)}},previous:function(){if(this.currentPage>0){var e="main/theater-events/"+(this.currentPage-1);window.history.replaceState({},"","#"+e),this.goToPage(this.currentPage-1)}}})}),define("templates/museum-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+="\n                    <tr>\n                        <td>",(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===c?n.apply(e):n),a+=u(n)+"</td>\n                        <td>",(n=i.category)?n=n.call(e,{hash:{},data:t}):(n=e.category,n=typeof n===c?n.apply(e):n),a+=u(n)+"</td>\n                        <td>",(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===c?n.apply(e):n),a+=u(n)+"</td>\n                        <td>",(n=i.price)?n=n.call(e,{hash:{},data:t}):(n=e.price,n=typeof n===c?n.apply(e):n),a+=u(n)+'</td>\n                        <td>\n                            <div class="ticket-view-choice-wrapper hotel-table">\n                                <button class="ticket-view-table-choice-minus"></button>\n                                <div>\n                                    <div class="numbers-container" style="-webkit-transform:translateY(0px);">\n                                        <span data-max=',(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===c?n.apply(e):n),a+=u(n)+" data-active='0'>0</span>\n                                    </div>\n                                </div>\n                                <button class=\"ticket-view-table-choice-plus\"></button>\n                            </div>\n                        </td>\n                    </tr>\n                    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var r,s,l="",c="function",u=this.escapeExpression,h=this,d=i.helperMissing;return l+="<div class = 'ticket-view-header'>\n    <table>\n        <tr>\n            <td><span>",(r=i.name)?r=r.call(t,{hash:{},data:a}):(r=t.name,r=typeof r===c?r.apply(t):r),l+=u(r)+'</span></td>\n        </tr>\n    </table>\n</div>\n\n<div class="ticket-view-wrapper">\n\n    <div class="ticket-view-venue-image-wrapper">\n        <div>\n            <img src="',(r=i.logo1)?r=r.call(t,{hash:{},data:a}):(r=t.logo1,r=typeof r===c?r.apply(t):r),l+=u(r)+'">\n        </div>\n\n    </div>\n\n    <div class="ticket-view-desc-wrapper">\n        <div class="ticket-view-desc"> <span>Адрес: </span><span>',(r=i.address)?r=r.call(t,{hash:{},data:a}):(r=t.address,r=typeof r===c?r.apply(t):r),l+=u(r)+'</span></div>\n    </div>\n\n    <div class="ticket-view-description ">\n        <p>',(r=i.description)?r=r.call(t,{hash:{},data:a}):(r=t.description,r=typeof r===c?r.apply(t):r),(r||0===r)&&(l+=r),l+='</p>\n    </div>\n    <div class="ticket-view-description-scroll">\n        <div class="ticket-view-description-scroll-knob">\n        </div>\n    </div>\n\n    <div class="ticket-view-event-image-wrapper">\n        <div>\n            <img src="',(r=i.logo2)?r=r.call(t,{hash:{},data:a}):(r=t.logo2,r=typeof r===c?r.apply(t):r),l+=u(r)+'"/>\n\n        </div>\n    </div>\n        <div class = \'ticket-view-bottom-section\'>\n\n            <div class="ticket-view-table-head">\n                <div>экскурсии</div>\n                <div>категория</div>\n                <div>кол-во мест</div>\n                <div>цена</div>\n                <div>выбор</div>\n            </div>\n            <div class="table-dots">\n                <div></div>\n                <div></div>\n                <div></div>\n            </div>\n            <div class="ticket-view-table-wrapper museum-table-wrapper">\n                <table class="ticket-view-table museum-table">\n                    ',r=i.each.call(t,t.excursions,{hash:{},inverse:h.noop,fn:h.program(1,o,a),data:a}),(r||0===r)&&(l+=r),l+='\n                </table>\n            </div>\n\n        <div class="ticket-view-table-scroll">\n            <div class="ticket-view-table-scroll-knob">\n            </div>\n        </div>\n        </div>\n\n</div>\n<div class="ticket-view-footer">\n\n    <!-- <a href="#main" class="home-button ticket-view-home-button"></a>\n    <i class="light-arrow"></i><button class="back-button">',s={hash:{},data:a},l+=u((r=i.i18n,r?r.call(t,"BACK",s):d.call(t,"i18n","BACK",s)))+'</button> -->\n    <span class="product-view-breadcrumbs with-buy-button">\n        <a href="#main"\n           class="home-button"></a>\n        <i class="light-arrow"></i><button class="back-button">',s={hash:{},data:a},l+=u((r=i.i18n,r?r.call(t,"BACK",s):d.call(t,"i18n","BACK",s)))+'</button>\n    </span>\n    <button href="#main/confirmTicket" class="button ticket-view-buy-button">забронировать</button>\n\n</div>\n'})}),define("views/HisMuseumView",["underscore","jquery","framework/View","templates/museum-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";return i.extend({className:"ticket-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus"},initialize:function(e){e=e||{},this.$el.css({opacity:0,scale:2}),this.deltaY=18,this.preventScroll=0},afterRender:function(){},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"Христо-Рождественский кафедральный Собор в Липецке",address:" г. Липецк, пл. Соборная",phone:"Тел.: 8 (4742) 27-04-78",description:"Христо-Рождественский Собор в Липецке является кафедральным, храм в котором в основном проходят все самые важные события епархии и Богослужения во главе правящего архиерея митрополита Липецкого Никона. Исторические сведения о храме: строительство собора начато в 1791 г стараниями помещика Петра Лукича Вильяминова. В 1835 году начато строительство пятиярусной колокольни, а в 1839 начато строительство трапезной части собора. Окончательно строительные работы были завершены в 1848 г. В 1831 г. Была обретена икона Божией Матери «Липецкая Страстная» связи с чудотворным прекращением эпидемии холеры. 14 и 23 марта 1922 г. Решением Липецкого исполкома собор был ограблен большевиками вывезены церковные ценности на суммы: 14.03.1922 – 12 960 000 рублей и 23.03.1922 на 61 960 000 рублей. В 1931 г. Собор был закрыт для верующих. До 1991г. Собор использовался как склад, а потом как музей.",logo1:"/images/no-image.png",logo2:"/images/lipeck/image16.jpeg",excursions:[{name:"Обзорная 13-17вв",category:"детский",amount:"23",price:80},{name:"Обзорная 13-17вв",category:"взрослый",amount:"40",price:150},{name:"Обзорная 13-17вв",category:"льготный",amount:"10",price:70},{name:"Обзорная 18-20вв",category:"детский",amount:"23",price:80},{name:"Обзорная 18-20вв",category:"взрослый",amount:"40",price:150},{name:"Обзорная 18-20вв",category:"льготный",amount:"10",price:70}]}},_open:function(e){var i=this.$(".ticket-view-description");this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Билеты забронированы"}))}})}),define("templates/hotel-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+="\n                    <tr>\n                        <td>",(n=i.category)?n=n.call(e,{hash:{},data:t}):(n=e.category,n=typeof n===c?n.apply(e):n),a+=u(n)+"</td>\n                        <td>",(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===c?n.apply(e):n),a+=u(n)+"</td>\n                        <td>",(n=i.price)?n=n.call(e,{hash:{},data:t}):(n=e.price,n=typeof n===c?n.apply(e):n),a+=u(n)+'</td>\n                        <td>\n                            <div class="ticket-view-choice-wrapper hotel-table">\n                                <button class="ticket-view-table-choice-minus"></button>\n                                <div>\n                                    <div class="numbers-container" style="-webkit-transform:translateY(0px);">\n                                        <span data-max=',(n=i.amount)?n=n.call(e,{hash:{},data:t}):(n=e.amount,n=typeof n===c?n.apply(e):n),a+=u(n)+" data-active='0'>0</span>\n                                    </div>\n                                </div>\n                                <button class=\"ticket-view-table-choice-plus\"></button>\n                            </div>\n                        </td>\n                    </tr>\n                    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var r,s,l="",c="function",u=this.escapeExpression,h=this,d=i.helperMissing;return l+="<div class = 'ticket-view-header'>\n    <table>\n        <tr>\n            <td><span>",(r=i.name)?r=r.call(t,{hash:{},data:a}):(r=t.name,r=typeof r===c?r.apply(t):r),l+=u(r)+'</span></td>\n            \n            \n        </tr>\n    </table>\n</div>\n\n<div class="ticket-view-wrapper">\n\n    <div class="ticket-view-venue-image-wrapper">\n        <div>\n            <img src="',(r=i.logo1)?r=r.call(t,{hash:{},data:a}):(r=t.logo1,r=typeof r===c?r.apply(t):r),l+=u(r)+'"/>\n        </div>\n\n    </div>\n\n    <div class="ticket-view-desc-wrapper">\n        <div class="ticket-view-desc"> <span>Адрес: </span><span>',(r=i.address)?r=r.call(t,{hash:{},data:a}):(r=t.address,r=typeof r===c?r.apply(t):r),l+=u(r)+'</span></div>\n    </div>\n\n    <div class="ticket-view-description ">\n        <p>',(r=i.description)?r=r.call(t,{hash:{},data:a}):(r=t.description,r=typeof r===c?r.apply(t):r),(r||0===r)&&(l+=r),l+='</p>\n    </div>\n    <div class="ticket-view-description-scroll">\n        <div class="ticket-view-description-scroll-knob">\n        </div>\n    </div>\n\n\n\n\n    <div class="ticket-view-event-image-wrapper">\n        <div>\n           <img src="',(r=i.logo2)?r=r.call(t,{hash:{},data:a}):(r=t.logo2,r=typeof r===c?r.apply(t):r),l+=u(r)+'">\n        </div>\n    </div>\n        <div class = \'ticket-view-bottom-section\'>\n\n            <div class="ticket-view-table-head">\n                <div>категория</div>\n                <div>кол-во мест</div>\n                <div>цена</div>\n                <div>выбор</div>\n            </div>\n            <div class="table-dots">\n                <div></div>\n                <div></div>\n                <div></div>\n            </div>\n            <div class="ticket-view-table-wrapper">\n                <table class="ticket-view-table hotel-table">\n                    ',r=i.each.call(t,t.numbers,{hash:{},inverse:h.noop,fn:h.program(1,o,a),data:a}),(r||0===r)&&(l+=r),l+='\n                </table>\n            </div>\n            <div class="hotel-view-calendar">\n                <button class="hotel-view-calendar-done">&#x2713;</button>\n                <div class="hotel-view-calendar-header">\n                    <h1 class="hotel-view-calendar-header-month"></h1>\n                    <h2 class="hotel-view-calendar-header-year"></h2>\n                    <nav>\n                        <span>Пн</span>\n                        <span>Вт</span>\n                        <span>Ср</span>\n                        <span>Чт</span>\n                        <span>Пт</span>\n                        <span>Сб</span>\n                        <span>Вс</span>\n                    </nav>\n                </div>\n                <section class="hotel-view-calendar-body">\n                    <div class="hotel-view-calendar-from"></div>\n                    <div class="hotel-view-calendar-to"></div>\n                </section>\n            </div>\n\n        <div class="ticket-view-table-scroll">\n            <div class="ticket-view-table-scroll-knob">\n            </div>\n        </div>\n        </div>\n\n</div>\n<div class="ticket-view-footer">\n    <section class="hotel-view-date-section">\n        <label>с</label>\n        <input readonly class="hotel-view-date-from">\n        <label>по</label>\n        <input readonly class="hotel-view-date-to">\n    </section>\n\n    <a href="#main" class="home-button ticket-view-home-button"></a>\n    <i class="light-arrow hotel-arrow"></i><button class="back-button hotel-back-button">',s={hash:{},data:a},l+=u((r=i.i18n,r?r.call(t,"BACK",s):d.call(t,"i18n","BACK",s)))+'</button>\n    <button href="#main/confirmTicket" class="button ticket-view-buy-button">забронировать</button>\n\n</div>\n'})}),define("views/HotelView",["underscore","jquery","framework/View","templates/hotel-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";var d=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];return i.extend({className:"hotel-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus","click .hotel-view-date-section input":"activateCalendar","click .hotel-view-calendar-done":"clickDone"},initialize:function(t){t=t||{},this.$el.css({opacity:0,scale:2}),e.bindAll(this,"clickDone"),this.eventId=t.eventId,this.deltaY=18,this.preventScroll=0},afterRender:function(){function e(e){e.stopPropagation();var i=t(e.fromElement),n=i.position(),a=+i.attr("data-day");if(console.log(n),p.$activeCircle===p.$fromCircle)o=a;else{if(o>a)return;r=a}var s=1;p.$activeCircle.animate({marginTop:n.top*s-60,marginLeft:n.left*s+3},400),p.$activeInput.val(t(e.fromElement).attr("data-day")+"."+l.getMonth()+"."+l.getFullYear())}var i,n,a,o,r,s,l=new Date,c=l.getDate(),u=l.getMonth(),h=this.$(".hotel-view-calendar-body"),p=this;for(this.$(".hotel-view-date-from").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(l.getDate()+1),this.$(".hotel-view-date-to").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(1),i=l.getDate(),n=l.getDay();n>1;n--)h.append(t('<div class="no-date">0</div>'));for(;l.getMonth()===u;)a=t("<div>"),(0===l.getDay()||6===l.getDay())&&a.addClass("weekend"),l.getDate()===c&&(s=a.addClass("today")),h.append(a.html(i).attr("data-day",i)),l.setDate(++i);this.$(".hotel-view-calendar-header-month").html(d[l.getMonth()]),this.$(".hotel-view-calendar-header-year").html(l.getFullYear()),this.$toCircle=this.$(".hotel-view-calendar-to"),this.$fromCircle=this.$(".hotel-view-calendar-from"),this.$calendar=this.$(".hotel-view-calendar").on("click","div",e).css("opacity",0)},activateCalendar:function(e){this.$activeInput&&(this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active"));var i=this.$activeInput=t(e.fromElement).addClass("active");this.$calendar.addClass("activated"),/from/.test(i.attr("class"))?this.$activeCircle=this.$fromCircle:this.$activeCircle=this.$toCircle,this.$activeCircle.addClass("active")},clickDone:function(){this.deactivateCalendar()},deactivateCalendar:function(){this.$calendar.removeClass("activated"),this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active")},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"Гостиница «Липецк»",address:"г. Липецек, ул.Ленина, д.11",phone:"+7 (4742) 277243",site:"http://www.hotellipetsk.ru/",description:"Гостиница Липецк - это идеальное место для работы и отдыха, предоставляет бизнесменам и туристам прекрасную возможность оказаться в центре событий одного из самых красивых и динамично развивающихся городов Черноземья. Большой промышленный и бизнес потенциал привлекает в наш город представителей бизнеса из всей России дальнего и ближнего зарубежья. Многие из них становятся нашими гостями. На сегодняшний день Гостиница «Липецк» — одна из самых современных гостиниц Липецка, готовая предоставить своим гостям полный комплекс услуг в сфере делового туризма, обеспечить качественный сервис, внимательное отношение вежливого персонала и европейскую культуру обслуживания. Все богатство современного сервиса доступно людям различного достатка.Широкий диапазон дополнительных услуг и комфортабельные номера различных категорий позволят Вам сохранять привычный уклад и стиль жизни, даже находясь вдали от дома.",logo1:"/images/no-image-logo.png",logo2:"/images/lipeck/image10.jpeg",numbers:[{category:"Одноместный",amount:"23",price:3e3},{category:"Двухместный",amount:"40",price:5e3},{category:"Одноместный сьют",amount:"10",price:4e3},{category:"Комфорт+",amount:"5",price:1e4},{category:"Президентский",amount:"15",price:15e3}]}},_open:function(e){var i=this.$(".ticket-view-description"),n=this;this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:function(){var i=t(".today"),a=i.position(),o=1;a=t(".today").position(),n.$fromCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),a=i.next().position(),n.$toCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),n.$calendar.animate({scale:.8},{duration:0,complete:function(){n.$calendar.css("opacity",1)}}),e()}})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Места забронированы"}))}})}),define("views/TransportView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Железнодорожный вокзал г. Липецк",description:"На этом месте в первые годы существования Липецка как областного центра был небольшой полустанок. В начале 1960-х годов на улице Гагарина был построен двухэтажный железнодорожный вокзал в створе нынешней улицы Терешковой. Он завершил перспективу этой улицы. Однако это здание простояло около тридцати лет. В 1976 году институт «Липецкгражданпроект» предложил создать на базе железнодорожного вокзала комплекс, в который бы также входил и автовокзал. Однако из-за дефицита места для стоянки автобусов от этой идеи отказались. Автовокзал было решено строить на проспекте Победы, где он находится сейчас. Но новый железнодорожный вокзал на 1000 пассажиров тем не менее строить начали. Он вступил в строй в 1994 году. На вокзале скульпторЕ. А. Вольфсон выполнил несколько скульптур, в том числе «Начальник вокзала и обходчик», «Дама и носильщик». Другой скульптор — И. М. Мазур исполнил декоративную композицию",locations:[{address:"г. Липецк, ул. Гагарина, д. 106"}],workTime:"круглосуточно",phones:["+7 (800) 775-00-00"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image18.jpeg"]}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},goToEvents:function(){Firefly.navigate("main/theater-events")}})}),define("templates/shops-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a,o,u="";return u+='\n            <a class="subcategory-view-list-a" data-event="navigation:product" data-id="',(n=i.id)?n=n.call(e,{hash:{},data:t}):(n=e.id,n=typeof n===p?n.apply(e):n),u+=f(n)+'">\n                <div class="subcategory-view-list-item">\n                    <h1 class="subcategory-view-list-item-name">',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===p?n.apply(e):n),u+=f(n)+'</h1>\n\n                    <div class="subcategory-view-list-item-image-background',n=i["if"].call(e,e.recommended,{hash:{},inverse:m.noop,fn:m.program(2,r,t),data:t}),(n||0===n)&&(u+=n),u+='">\n                        <img class="subcategory-view-list-item-image" src="',n=i["if"].call(e,e.logo,{hash:{},inverse:m.program(6,l,t),fn:m.program(4,s,t),data:t}),(n||0===n)&&(u+=n),u+='">\n                    </div>\n                    <div class="subcategory-view-list-item-info">\n                        <div class="subcategory-view-list-item-description">\n                            ',(n=i.shortDesc)?n=n.call(e,{hash:{},data:t}):(n=e.shortDesc,n=typeof n===p?n.apply(e):n),u+=f(n)+'\n                        </div>\n                        <div class="subcategory-view-list-item-location">\n                            '+f((n=e.locations,n=null==n||n===!1?n:n[0],n=null==n||n===!1?n:n.address,typeof n===p?n.apply(e):n))+'\n                        </div>\n                        <!-- <div class="subcategory-view-list-more-info">',a=i["if"].call(e,e.discount,{hash:{},inverse:m.noop,fn:m.program(8,c,t),data:t}),(a||0===a)&&(u+=a),o={hash:{},data:t},u+=f((n=i.i18n,n?n.call(e,"MORE INFO",o):v.call(e,"i18n","MORE INFO",o)))+'<i\n                                class="light-arrow-d"></i>\n                            <i class="light-arrow-d"></i>\n                        </div> -->\n                    </div>\n                </div>\n            </a>\n        '}function r(e,t){return" subcategory-view-list-item-image-background-recommended"}function s(e,t){var n;return(n=i.logo)?n=n.call(e,{hash:{},data:t}):(n=e.logo,n=typeof n===p?n.apply(e):n),f(n)}function l(e,t){return"/images/no-image-logo.png"}function c(e,t){return'<i\n                                class="discount-icon"></i>'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var u,h,d="",p="function",f=this.escapeExpression,m=this,v=i.helperMissing;return d+='<h1 class="subcategory-view-name">\n    ',(u=i.name)?u=u.call(t,{hash:{},data:a}):(u=t.name,u=typeof u===p?u.apply(t):u),d+=f(u)+'\n</h1>\n<div class="subcategory-view-list-wrapper">\n    <div class="subcategory-view-list">\n        ',u=i.each.call(t,t.products,{hash:{},inverse:m.noop,fn:m.program(1,o,a),data:a}),(u||0===u)&&(d+=u),d+='\n    </div>\n</div>\n<div class="subcategory-view-scroll">\n    <div class="subcategory-view-scroll-knob">\n    </div>\n</div>\n<span class="subcategory-view-breadcrumbs"><a href="#main"\n                                              class="home-button"></a>\n    <i class="light-arrow"></i><button class="back-button">',
h={hash:{},data:a},d+=f((u=i.i18n,u?u.call(t,"BACK",h):v.call(t,"i18n","BACK",h)))+'</button></span>\n<button class="subcategory-view-previous-page-button"></button>\n<button class="subcategory-view-next-page-button"></button>\n'})}),define("views/ShopsView",["framework/View","templates/shops-view"],function(e,t){"use strict";var i=615;return e.extend({className:"subcategory-view",template:t,i18n:!0,events:{"click .back-button":"back"},initialize:function(e){e=e||{},this.currentPage=e.page||0,this.$el.css({opacity:0,scale:2})},name:"Магазины",data:function(e){return{name:"Магазины",products:[{id:7771,name:"Торгово-развлекательный центр «Европа»",shortDesc:"Благодаря удобному расположению, между двух оживленных улиц — Советской и 8-го Марта, уникальной концепции, приятной атмосфере и сильному составу арендаторов, он завоевал популярность у жителей города и стал самым посещаемым и любимым. Сегодня это первый профессиональный торговый объект города современного формата, который задает высокую планку стандартов современной розничной торговли в Центрально-Черноземном регионе Росcии",recommended:!0,logo:"/images/lipeck/image22.jpeg",locations:[{address:"г. Липецк, Советская, д. 66."}]},{id:7772,name:"орговый центр «Малибу»",shortDesc:"Хотите купить хороший товар, но не любите тратить кучу времени на поездки по магазинам? Тогда торгово-развлекательный центр «Малибу» Липецк - самое верное решение!",recommended:!0,logo:"/images/lipeck/image23.jpeg",locations:[{address:"г. Липецк, ул. Терешковой, д. 35б"}]}]}},afterRender:function(){this.$(".subcategory-view-list").css({top:0}),this.currentPage||(this.currentPage=0);var e=this.data().length;e>4?(this.pages=e%4===0?e/4:Math.floor(e/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages):(this.$(".subcategory-view-scroll").hide(),this.$(".subcategory-view-next-page-button").hide(),this.$(".subcategory-view-previous-page-button").hide()),this.pages=e%4===0?e/4:Math.floor(e/4)+1,this.$(".subcategory-view-scroll-knob").css({height:600/this.pages,top:0}),this.scrollStep=600/this.pages,this.goToPageStatic(this.currentPage)},back:function(){window.history.back()},_open:function(e){this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.$el.animate({opacity:0,scale:2},{complete:e})},goToPageStatic:function(e){this.$(".subcategory-view-list").css({top:-i*e}),this.$(".subcategory-view-scroll-knob").css({top:this.scrollStep*e}),this.currentPage=e},goToPage:function(e){this.$(".subcategory-view-list").animate({top:-i*e}),this.$(".subcategory-view-scroll-knob").animate({top:this.scrollStep*e}),this.currentPage=e}})}),define("templates/food-view",["handlebars","framework/utils/handlebars"],function(e){return e.template(function(e,t,i,n,a){function o(e,t){var n,a="";return a+='\n            <li>\n                <a class="category-view-item-a" href="',(n=i.url)?n=n.call(e,{hash:{},data:t}):(n=e.url,n=typeof n===c?n.apply(e):n),a+=u(n)+'">\n                    <figure>\n                        <img src="',(n=i.icon)?n=n.call(e,{hash:{},data:t}):(n=e.icon,n=typeof n===c?n.apply(e):n),a+=u(n)+'">\n                        <figcaption>\n                            ',(n=i.name)?n=n.call(e,{hash:{},data:t}):(n=e.name,n=typeof n===c?n.apply(e):n),a+=u(n)+"\n                        </figcaption>\n                    </figure>\n                </a>\n            </li>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,a=a||{};var r,s,l="",c="function",u=this.escapeExpression,h=this,d=i.helperMissing;return l+='<h1 class="category-view-name">Досуг</h1>\n<div class="category-view-list-wrapper">\n    <ul class="category-view-list">\n        ',r=i.each.call(t,t,{hash:{},inverse:h.noop,fn:h.program(1,o,a),data:a}),(r||0===r)&&(l+=r),l+='\n    </ul>\n</div>\n<span class="category-view-breadcrumbs"><a href="#main"\n                                           class="home-button"></a> <i\n        class="light-arrow"></i><button class="back-button">',s={hash:{},data:a},l+=u((r=i.i18n,r?r.call(t,"BACK",s):d.call(t,"i18n","BACK",s)))+"</button></span>\n"})}),define("views/FoodView",["jquery","framework/View","templates/food-view","framework/utils/log","framework/utils/async"],function(e,t,i,n,a){"use strict";var o=5,r=50,s=30,l=130,c=160,u=800,h=150;return t.extend({className:"category-view",template:i,i18n:!0,events:{"click .back-button":"back","click .category-view-item-a":"logEvent"},initialize:function(){this.$el.css({opacity:0,scale:2})},back:function(){window.history.back()},data:function(){return[{id:3071,name:"Ресторан",url:"#main/reatoran",icon:"/images/3071.png"},{id:3069,name:"Кафе",url:"#main/cafe",icon:"/images/3069.png"},{id:3067,name:"Бар",url:"#main/bar",icon:"/images/3067.png"}]},afterRender:function(){this._items=this.$(".category-view-list > li");var t=this._items.length,i=t%o?Math.floor(t/o)+1:t/o,a=1===i?t*(l+s)-s:o*(l+s)-s,d=i*(c+r)-r;t&&(this.duration=Math.max(h,u/t)),n.trace("item count: "+t),n.trace("row count: "+i),n.trace("list width: "+a),n.trace("list height: "+d),this.$(".category-view-list").css({top:(615-d)/2,left:(900-a)/2,width:a,height:d}),this._items.each(function(t,i){var a=t%o,u=Math.floor(t/o);n.trace("xIndex: "+a),n.trace("yIndex: "+u),e(i).css({top:u*(c+r),left:a*(l+s),scale:2,opacity:0})})},_open:function(t){var i=[],n=this.duration,o=this.$el;i.push(function(e){o.animate({opacity:1,scale:1},e)}),this._items.each(function(t,a){n-=5,i.push(function(t){e(a).animate({scale:1,opacity:1},n,t)})}),a.serial(i,t)},_close:function(t){var i=[],n=this.duration,o=this.$el;i.push(function(e){o.animate({opacity:0,scale:2},e)}),this._items.each(function(t,a){n-=5,i.unshift(function(t){e(a).animate({scale:2,opacity:0},n,t)})}),a.serial(i,t)}})}),define("views/ReastoranView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Ресторан «Амстердам»",description:'Стильное заведение премиум класса. Входит в международный справочник TripAdvisor. Награжден дипломом за лучшее артистичное решение в дизайне интерьера на международном профессиональном конкурсе "Дизайн ресторана и отеля". Европейская и японская кухня. Достойная винотека. Кафе расположено в самом центре города, на улице «Пролетарская», рядом с кафе «Буфет»Это светский шарм и домашний уют, свобода и безумие страстей. Это столица Голландии в миниатюре: стилизованные улочки, крошечные оконца, ажурные мостики. Атмосфера ресторана переносит посетителя в центр дивного средневекового города, где на каждом шагу поджидают приятные неожиданности...',locations:[{address:"г. Липецк, ул. Пролетарская, 13"}],workTime:"Пн - Чт: с 11:00 до 12:00",phones:["+7 (4742) 272665"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image7.jpeg"]}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/CafeView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Кафе «Корчма Гоголь»",description:"Хлебосольная национальная кухня. Традиционный украинский интерьер, музыка, гостеприимство. Идеальное место для встреч с друзьями, коллегами или для воскресного обеда всей семьей с детворой и бабушками. Комфортно будет всем. Корчма расположена на пересечении Космонавтов и Терешковой, в центре города, недалеко от сквера Маркова и Быханова сада. Напротив корчмы находится дворец спорта «Звездный».Просторный, светлый зал, слегка стилизованный под украинский колорит. На стене цитаты из Гоголя. У входа, на радость детворе, стоит декоративный колодец.На столах из тёмного дерева светильники. В целом обстановка позитивная. Обслуживание ненавязчивое.",locations:[{address:" г. Липецк, ул. Космонавтов, 24"}],workTime:"с 11 до 24",phones:["+7 (4742) 550004"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image8.jpeg"],site:"http://amsterdamgroup.ru/it/gogol"}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/StolovayaView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Кафе-столовая «Серебряная подкова»",description:"«Серебряная подкова» - единственное кафе-столовая в центре города. Для Вас готовят высококвалифицированные опытные повара. Все блюда готовятся только из натуральных продуктов. «Серебряная подкова» предлагает бизнес-ланчи от 120 рублей и каждый день новое меню! Кафе-столовая заключает договоры на обслуживание с организациями на выгодных условиях. Большие скидки. Серебряная подкова располагает двумя залами: на 40 и 60 посадочных мест. Любые торжества — от 700 рублей в двух залах, под живую музыку, с ведущим и большим танцполом.",locations:[{address:"г. Владимир, ул. Гагарина, д. 5",latitude:56.127919,longitude:40.404021}],workTime:"пн-вск 9:00-18:00.",phones:["+7 (4922) 42-10-87"],logo:"/images/l205.jpg",images:["/images/silver_podkova.jpg"]}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/BarView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Дублин",description:"Настоящий вкусный Гиннес, цены выше, чем в простом баре, но зато вкусное пиво и еда. Заказывали креветки к пиву - интересно подают в бумаге. Ирландский завтрак мы заказали вечером, и нам его принесли. Приятное обслуживание. Работает до 12 часов",locations:[{address:"г. Липецк, пл. Коммунальная, д. 9"}],workTime:"пн-вск 12:00-00:00",phones:["+7 (4752) 242282 "],logo:"/images/no-image-logo.png",images:["/images/lipeck/image9.jpeg"],site:"http://dublin48.ru"}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/SamohvalView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"ДРЦ «Остров капитана Флинта»",description:"Мир, где различия в возрасте не имеют значения! Детский развлекательный центр предлагает Вам весело и познавательно провести время в незабываемой атмосфере доброго праздника. Вас жду Вас жду игровые аттракционы «Сокровища Бена Гана», детский лабиринт «Джунгли», боулинг «Золотое ядро» и бильярдная «Адмирал», рассчитанных на любой возраст. Не так давно на территории развлекательного центра был открыт кинотеатр «Флинт», в котором поддерживается формат 3D и 5D. Зрелище великолепное. Это место стоит посетить! Если Вы не знаете, где отметить день рождения своего чада, развлекательный центр всегда к Вашим услугам. На территории есть кафе «Таверна Джона Сильвера», кафе «Гриль-Хаус» и пиццерия «Пиратопицца» Взрослые могут сделать покупки или просто прогуляться на территории торгового центра. В выходные время работы центра увеличено для удобства посетителей.",locations:[{address:"г. Липецк, ул. Студеновская, 124а, ТРЦ Липецк, 3 этаж"}],workTime:"понедельник-четверг 10:00-23:00; пятница, суббота 10:00-01:00; воскресенье 10:00-23:00",phones:["+7(4742) 364488","+7(4742) 483686","+7(4742) 391217"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image1.jpeg"],site:"http://www.ostrov-flinta.ru"}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/NightClubView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Культурно-развлекательный центр «Евразия»",description:"Культурно-развлекательный центр «Евразия» в Липецке с огромным выбором блюд русской и европейской кухни, высококвалифицированными поварами, вкуснейшими разнообразными коктейлями, изысканным интерьером. Вы можете расслабиться, почувствовать теплоту и уют нашего заведения расположившись по интересам в одним из изящных залов : ресторан, vip зал, лаунж кафе, кальянная, ночной клуб и караоке, а также вспомнить все свои любимые музыкальные композиции, песни зарубежных и российских исполнителей. В нашем каталоге более 30000 песен на любой вкус! В культурно-развлекательном центре «Евразия» Вы можете провести: дни рождения, выпускные, любые вечеринки в соответствии с вашими желаниями и предпочтениями.",locations:[{address:"г. Липецк, ул. Ленина, 11"}],workTime:"чт-сб 12:00-06:00, вс",phones:["+7 (4742) 271533","+7 (4742) 270246"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image2.jpeg"]}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/BuolingView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Билли Бо",description:"Рaзвлeкатeльныйцeнтр «Билли Бо» в Липецке – это сoврeмeнный бoулинг, просторный бильярдный зал со столами для игры в пирамиду и пул, уютный спoрт-бaр оснащенный широкоформатными экранами для просмотра спортивных трансляций. Широкий выбор развлечений для взрослых и детей,корпоративных и индивидуальных клиентов, а именно: 12 дорожек для игры в бoулинг европейского уровня от мирового производителя Brunswick; уютное Sport-кафе для истинных ценителей спорта, в меню которого широкий ассортимент лучших сортов пива, пиццы и других закусок; уникальное видео и аудио оборудование для трансляции спортивных матчей, огромный проекционный монитор; Wi-Fi зона с бесплатным доступом к сети интернет.",locations:[{address:"Адрес: г. Липецк, ул. Титова, д.10 ТРЦ «Москва», 3 этаж"}],workTime:"пн-чт 13:00–01:00; пт. 13:00 – 03:00, сб 11:00–03:00, вс. 11:00 – 01:00",phones:["+7 (4742) 366166"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image3.jpeg"],site:"http://www.moskvacenter.ru"}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/CinemaView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Киномакс-Акварель",description:"инотеатр «Киномакс-Акварель» в Тамбове – это 5 стильных комфортабельных залов на 199, 117 и 102 места, оснащенных новейшим кинопроекционным оборудованием и суперсовременной акустической аппаратурой для полного погружения в любимое кино. Залы кинотеатра «Киномакс-Акварель» оборудованы новейшей технологией RealD. Уникальный современный дизайн кинотеатра создаст позитивную атмосферу и хорошее настроение гостям киноцентра «Киномакс-Акварель» в Тамбове. Кинотеатр в Тамбове располагает площадью и техническими возможностями для проведения мероприятий различного формата",locations:[{address:"г. Тамбов, ул. Студенецкая наб., д. 20А, ТЦ «Акварель»"}],phones:["+7 (4752) 43-07-77"],logo:"/images/kino_logo.jpg",images:["/images/kino-akvarel.jpg"],site:"http://kinomax.ru/aquarel"}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/StadionView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Дворец спорта «Звездный»",description:"Дворец спорта ледовый «Звездный» - это спортивные мероприятия, хоккей на льду, ледовые катания на коньках. В ледовом дворце проводятся хоккейные матчи, организуются катания на коньках. Работают секции: фигурное катание, конькобежный спорт, хоккей.Прокат и заточка катков, удобная парковка, бар, музыкальное сопровождение.",locations:[{address:"г. Липецк, ул. Терешковой, д. 13"}],workTime:"пн-вс 8:00–23:00",phones:["+7 (4742) 34-88-40"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image5.jpeg"],site:"http://zvezdny48.ru"}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/ParkView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Нижний парк",description:"Самым первым липецким парком был Нижний. Его заложили в 1805 году на месте Липецкого железоделательного завода. , расположен в самом центре города Липецка .На территории парка располагаются многочисленные аттракционы, увеселительные заведения, танцплощадка, открытые летние эстрады, действует колесо обозрения. ",locations:[{address:"г. Липецк, проезд Петровский, д. 2"}],phones:["+7(4742) 271271"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image6.jpeg"]}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/HudMuseumView",["underscore","jquery","framework/View","templates/museum-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";return i.extend({className:"ticket-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus"},initialize:function(e){e=e||{},this.$el.css({opacity:0,scale:2}),this.deltaY=18,this.preventScroll=0},afterRender:function(){},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"Художественный музей им. В.С. Сорокина - Дом Мастера",address:"г. Липецк, ул. Ленина, 2 ",phone:"+7 (4742) 27-77-18",description:'Музей открыт в доме, который с 1919 года не раз посещали художники из Москвы: И.С. Ефимов, уроженец Липецкого края, Н.Я. Симонович-Ефимова, Иван Сесенович - скульптор-анималист, Нина Яковлевна, его жена, - живописец с великолепным чувством цвета (она оставила мемуары о своём двоюродном брате Валентине Серове и скульпторе А.С. Голубкиной). В конце 1980-х гг. много споров было по поводу судьбы Дома. Победила идея художника Вилена Дмитриевича Дворянчикова: создать Музей-мастерскую выдающегося русского художника В.С. Сорокина (1912-2001). Так в 1992 году в Липецке был создан прижизненный Музей-мастерская народного художника России В.С. Сорокина - Дом Мастера - в знак признания его таланта и в честь 80-летия со дня его рождения. В 2002 году Музей-мастерская получил новый статус: "Художественный музей им. В.С. Сорокина - Дом Мастера".',logo1:"/images/no-image.png",logo2:"/images/lipeck/image14.jpeg",excursions:[{name:"Обзорная 13-17вв",category:"детский",amount:"23",price:80},{name:"Обзорная 13-17вв",category:"взрослый",amount:"40",price:150},{name:"Обзорная 13-17вв",category:"льготный",amount:"10",price:70},{name:"Обзорная 18-20вв",category:"детский",amount:"23",price:80},{name:"Обзорная 18-20вв",category:"взрослый",amount:"40",price:150},{name:"Обзорная 18-20вв",category:"льготный",amount:"10",price:70}]}},_open:function(e){var i=this.$(".ticket-view-description");this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Билеты забронированы"}))}})}),define("views/TechMuseumView",["underscore","jquery","framework/View","templates/museum-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";return i.extend({className:"ticket-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus"},initialize:function(e){e=e||{},this.$el.css({opacity:0,scale:2}),this.deltaY=18,this.preventScroll=0},afterRender:function(){},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){
var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"Музей железнодорожного транспорта",address:"г. Владимир, ул. Вокзальная, д. 12",description:"Музей железнодорожного транспорта города Владимира располагается рядом с вокзалом. Посетители могут ознакомиться с образцами подвижного состава, узкоколейными грузовыми и пассажирскими вагонами. Все экспонаты размещены под открытым небом. Особое место в экспозиции занимает паровоз серии «Л». Он являлся одним из лучших паровозов советской эпохи. Экспонат был прописан в городском депо и работал на участках до Орехово, Коврова, Мурома. Был построен в 1952 году. Паровоз попал в госрезерв в 1995 году, а в число экспонатов музея железнодорожного транспорта его зачислили в 1999 году. Данный паровоз является символом трудовой славы владимирского локомотивного депо. Горьковская магистраль входит в число старейших железных дорог нашей страны. Первой железнодорожной магистралью стало направление Москва – Нижний Новгород. Ее строительство началось в 1858 году. Движение поездов до Владимира открылось в 1861 году. Именно в этот год 19 марта экстренный поезд из столицы привез весть об отмене крепостного права. 14 июня был выпущен первый пассажирский поезд до Москвы. Он находился в пути 16 часов. В варианте скорого поезда данный путь требовал 13 часов. Московско-Нижегородская железная дорога была построена в 1862 году. Она связывала Поволжье с центром России и проходила по Нижегородской, Владимирской и Московской губерниям. Протяженность дороги составляло 410 верст. Именно эта магистраль выполняла важнейшие задачи снабжения продуктами и доставки товаров.",logo1:"/images/no-image.png",logo2:"/images/zd-mus.jpg",excursions:[{name:"Обзорная 13-17вв",category:"детский",amount:"23",price:80},{name:"Обзорная 13-17вв",category:"взрослый",amount:"40",price:150},{name:"Обзорная 13-17вв",category:"льготный",amount:"10",price:70},{name:"Обзорная 18-20вв",category:"детский",amount:"23",price:80},{name:"Обзорная 18-20вв",category:"взрослый",amount:"40",price:150},{name:"Обзорная 18-20вв",category:"льготный",amount:"10",price:70}]}},_open:function(e){var i=this.$(".ticket-view-description");this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Билеты забронированы"}))}})}),define("views/KraevMuseumView",["underscore","jquery","framework/View","templates/museum-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";return i.extend({className:"ticket-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus"},initialize:function(e){e=e||{},this.$el.css({opacity:0,scale:2}),this.deltaY=18,this.preventScroll=0},afterRender:function(){},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"Липецкий областной краеведческий музей",address:"г. Липецк, ул. Ленина д. 25",phone:"+7 (4742) 270286",description:'Музей создан в 1909 году по инициативе врача, краеведа, общественного деятеля, Трунова М.П., впоследствии репрессированного по сфабрикованному НКВД "делу краеведов". В залах музея проходили выставки из государственного Эрмитажа (в 2001 и 2003 гг.), Музея И.С. Тургенева, Московского исторического музея, Воронежского художественного музея им. Крамского и др.',logo2:"/images/no-image.png",logo1:"/images/lipeck/image15.jpeg",excursions:[{name:"Обзорная 13-17вв",category:"детский",amount:"23",price:80},{name:"Обзорная 13-17вв",category:"взрослый",amount:"40",price:150},{name:"Обзорная 13-17вв",category:"льготный",amount:"10",price:70},{name:"Обзорная 18-20вв",category:"детский",amount:"23",price:80},{name:"Обзорная 18-20вв",category:"взрослый",amount:"40",price:150},{name:"Обзорная 18-20вв",category:"льготный",amount:"10",price:70}]}},_open:function(e){var i=this.$(".ticket-view-description");this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Билеты забронированы"}))}})}),define("views/CultMuseumView",["underscore","jquery","framework/View","models/Product","templates/product-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return i.extend({className:"product-view",template:a,i18n:!0,events:{"click .back-button":"back"},initialize:function(){this.$el.css({opacity:0})},afterRender:function(){function e(){var e=t(this).parent().width()/t(this).parent().height(),i=this.width/this.height;i>e?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"))}var i,n=t("ul.product-view-slider img");for(i=0;i<n.length;i++)n[i].onload=e},data:function(){return{templateId:1,name:"Тамбовская областная универсальная научная библиотека им. А. С. Пушкина",locations:[{address:"г. Тамбов, ул. Интернациональная, д. 17"}],workTime:"вт-пт 10:00-20:00; сб-вс 10:00-18:00",phones:["+7 (474) 227-07-68"],logo:"/images/no-image-logo.png",images:["/images/lipeck/image17.jpeg"],site:"library.lipetsk.ru"}},_open:function(e){this.printAvailable=!1,this.printDiscountAvailable=!1;var t=this,i=this.$(".product-view-description");this.scroller=new o(i,i.find("article"),{scrollbar:{$scroll:this.$(".product-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".product-view-description-scroll-knob")},options:{scrollingX:!1}}),t.$el.css({opacity:0,scale:2}).animate({opacity:1,scale:1},{complete:e})},_close:function(e){this.scroller.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()}})}),define("views/HostelView",["underscore","jquery","framework/View","templates/hotel-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";var d=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];return i.extend({className:"hotel-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus","click .hotel-view-date-section input":"activateCalendar","click .hotel-view-calendar-done":"clickDone"},initialize:function(t){t=t||{},this.$el.css({opacity:0,scale:2}),e.bindAll(this,"clickDone"),this.eventId=t.eventId,this.deltaY=18,this.preventScroll=0},afterRender:function(){function e(e){e.stopPropagation();var i=t(e.fromElement),n=i.position(),a=+i.attr("data-day");if(console.log(n),p.$activeCircle===p.$fromCircle)o=a;else{if(o>a)return;r=a}var s=1;p.$activeCircle.animate({marginTop:n.top*s-60,marginLeft:n.left*s+3},400),p.$activeInput.val(t(e.fromElement).attr("data-day")+"."+l.getMonth()+"."+l.getFullYear())}var i,n,a,o,r,s,l=new Date,c=l.getDate(),u=l.getMonth(),h=this.$(".hotel-view-calendar-body"),p=this;for(this.$(".hotel-view-date-from").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(l.getDate()+1),this.$(".hotel-view-date-to").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(1),i=l.getDate(),n=l.getDay();n>1;n--)h.append(t('<div class="no-date">0</div>'));for(;l.getMonth()===u;)a=t("<div>"),(0===l.getDay()||6===l.getDay())&&a.addClass("weekend"),l.getDate()===c&&(s=a.addClass("today")),h.append(a.html(i).attr("data-day",i)),l.setDate(++i);this.$(".hotel-view-calendar-header-month").html(d[l.getMonth()]),this.$(".hotel-view-calendar-header-year").html(l.getFullYear()),this.$toCircle=this.$(".hotel-view-calendar-to"),this.$fromCircle=this.$(".hotel-view-calendar-from"),this.$calendar=this.$(".hotel-view-calendar").on("click","div",e).css("opacity",0)},activateCalendar:function(e){this.$activeInput&&(this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active"));var i=this.$activeInput=t(e.fromElement).addClass("active");this.$calendar.addClass("activated"),/from/.test(i.attr("class"))?this.$activeCircle=this.$fromCircle:this.$activeCircle=this.$toCircle,this.$activeCircle.addClass("active")},clickDone:function(){this.deactivateCalendar()},deactivateCalendar:function(){this.$calendar.removeClass("activated"),this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active")},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"Хостел Like Липецк",address:"г. Липецк, ул. Советская, д.66., корпус Б, 3 этаж",phone:" +7 (904) 290 2444",site:"http://lipetsk.likehostels.ru/",description:"Много лет активные путешественники в различных уголках мира предпочитают останавливаться в таких заведениях, как частная мини-гостиница. Ведь это не только наиболее экономичное размещение в любом городе, но также и прекрасная возможность познакомиться с разными интересными людьми. Ранее такие гостиницы, как “Лайк Хостел Липецк” считались предназначенными исключительно для молодежи, однако теперь бюджетный комфортный отдых привлекает людей разного возраста и положения. Сегодня среди гостей, которых привлекает мини-гостиница хостел, можно встретить, например, профессора, который с удовольствием готовит совместный ужин на общей кухне со студентами вместо похода в ресторан.",logo1:"/images/no-image.png",logo2:"/images/lipeck/image12.jpeg",numbers:[{category:"Одноместный",amount:"23",price:500},{category:"Двухместный",amount:"40",price:700}]}},_open:function(e){var i=this.$(".ticket-view-description"),n=this;this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:function(){var i=t(".today"),a=i.position(),o=1;a=t(".today").position(),n.$fromCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),a=i.next().position(),n.$toCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),n.$calendar.animate({scale:.8},{duration:0,complete:function(){n.$calendar.css("opacity",1)}}),e()}})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Места забронированы"}))}})}),define("views/GuestHousView",["underscore","jquery","framework/View","templates/hotel-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";var d=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];return i.extend({className:"hotel-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus","click .hotel-view-date-section input":"activateCalendar","click .hotel-view-calendar-done":"clickDone"},initialize:function(t){t=t||{},this.$el.css({opacity:0,scale:2}),e.bindAll(this,"clickDone"),this.eventId=t.eventId,this.deltaY=18,this.preventScroll=0},afterRender:function(){function e(e){e.stopPropagation();var i=t(e.fromElement),n=i.position(),a=+i.attr("data-day");if(console.log(n),p.$activeCircle===p.$fromCircle)o=a;else{if(o>a)return;r=a}var s=1;p.$activeCircle.animate({marginTop:n.top*s-60,marginLeft:n.left*s+3},400),p.$activeInput.val(t(e.fromElement).attr("data-day")+"."+l.getMonth()+"."+l.getFullYear())}var i,n,a,o,r,s,l=new Date,c=l.getDate(),u=l.getMonth(),h=this.$(".hotel-view-calendar-body"),p=this;for(this.$(".hotel-view-date-from").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(l.getDate()+1),this.$(".hotel-view-date-to").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(1),i=l.getDate(),n=l.getDay();n>1;n--)h.append(t('<div class="no-date">0</div>'));for(;l.getMonth()===u;)a=t("<div>"),(0===l.getDay()||6===l.getDay())&&a.addClass("weekend"),l.getDate()===c&&(s=a.addClass("today")),h.append(a.html(i).attr("data-day",i)),l.setDate(++i);this.$(".hotel-view-calendar-header-month").html(d[l.getMonth()]),this.$(".hotel-view-calendar-header-year").html(l.getFullYear()),this.$toCircle=this.$(".hotel-view-calendar-to"),this.$fromCircle=this.$(".hotel-view-calendar-from"),this.$calendar=this.$(".hotel-view-calendar").on("click","div",e).css("opacity",0)},activateCalendar:function(e){this.$activeInput&&(this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active"));var i=this.$activeInput=t(e.fromElement).addClass("active");this.$calendar.addClass("activated"),/from/.test(i.attr("class"))?this.$activeCircle=this.$fromCircle:this.$activeCircle=this.$toCircle,this.$activeCircle.addClass("active")},clickDone:function(){this.deactivateCalendar()},deactivateCalendar:function(){this.$calendar.removeClass("activated"),this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active")},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"Рахманов Плёс",address:"г. Владимир, ул. Лесная, д. 15А",phone:"8-960-729-56-76",site:"www.рахманов-плес.рф",description:"Гостевой дом «Рахманов Плес» расположен во Владимире, рядом с рекой Клязьма. К услугам гостей сауна и бесплатная частная парковка.В числе удобств номеров и дома для отпуска — телевизор с плоским экраном и собственная ванная комната с бесплатными туалетно-косметическими принадлежностями. В доме для отпуска в распоряжении гостей также стиральная машина, камин, гладильные принадлежности и кухня с холодильником, плитой, микроволновой печью и электрическим чайником.Гости могут заказать доставку еды и напитков в номер, приготовить собственные блюда на общей кухне или воспользоваться принадлежностями для барбекю для обеда на открытом воздухе.Дмитриевский и Свято-Успенский соборы находятся в 10 минутах езды.Расстояние до железнодорожного вокзала Владимира составляет 2,3 км.",logo1:"/images/no-image.png",logo2:"/images/guest_house.jpg",numbers:[{category:"Одноместный",amount:"23",price:3e3},{category:"Двухместный",amount:"40",price:5e3},{category:"Одноместный сьют",amount:"10",price:4e3},{category:"Комфорт+",amount:"5",price:1e4},{category:"Президентский",amount:"15",price:15e3}]}},_open:function(e){var i=this.$(".ticket-view-description"),n=this;this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:function(){var i=t(".today"),a=i.position(),o=1;a=t(".today").position(),n.$fromCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),a=i.next().position(),n.$toCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),n.$calendar.animate({scale:.8},{duration:0,complete:function(){n.$calendar.css("opacity",1)}}),e()}})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Места забронированы"}))}})}),define("views/ApartmentView",["underscore","jquery","framework/View","templates/hotel-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";var d=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];return i.extend({className:"hotel-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus","click .hotel-view-date-section input":"activateCalendar","click .hotel-view-calendar-done":"clickDone"},initialize:function(t){t=t||{},this.$el.css({opacity:0,scale:2}),e.bindAll(this,"clickDone"),this.eventId=t.eventId,this.deltaY=18,this.preventScroll=0},afterRender:function(){function e(e){e.stopPropagation();var i=t(e.fromElement),n=i.position(),a=+i.attr("data-day");if(console.log(n),p.$activeCircle===p.$fromCircle)o=a;else{if(o>a)return;r=a}var s=1;p.$activeCircle.animate({marginTop:n.top*s-60,marginLeft:n.left*s+3},400),p.$activeInput.val(t(e.fromElement).attr("data-day")+"."+l.getMonth()+"."+l.getFullYear())}var i,n,a,o,r,s,l=new Date,c=l.getDate(),u=l.getMonth(),h=this.$(".hotel-view-calendar-body"),p=this;for(this.$(".hotel-view-date-from").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(l.getDate()+1),this.$(".hotel-view-date-to").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(1),i=l.getDate(),n=l.getDay();n>1;n--)h.append(t('<div class="no-date">0</div>'));for(;l.getMonth()===u;)a=t("<div>"),(0===l.getDay()||6===l.getDay())&&a.addClass("weekend"),l.getDate()===c&&(s=a.addClass("today")),h.append(a.html(i).attr("data-day",i)),l.setDate(++i);this.$(".hotel-view-calendar-header-month").html(d[l.getMonth()]),this.$(".hotel-view-calendar-header-year").html(l.getFullYear()),this.$toCircle=this.$(".hotel-view-calendar-to"),this.$fromCircle=this.$(".hotel-view-calendar-from"),this.$calendar=this.$(".hotel-view-calendar").on("click","div",e).css("opacity",0)},activateCalendar:function(e){this.$activeInput&&(this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active"));var i=this.$activeInput=t(e.fromElement).addClass("active");this.$calendar.addClass("activated"),/from/.test(i.attr("class"))?this.$activeCircle=this.$fromCircle:this.$activeCircle=this.$toCircle,this.$activeCircle.addClass("active")},clickDone:function(){this.deactivateCalendar()},deactivateCalendar:function(){this.$calendar.removeClass("activated"),this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active")},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"«Апартаменты в Липецке»",address:"Липецк, Проспект Победы 3",phone:"(920) 48-666-88, (910) 85-400-35",description:"Апартаменты представляют собой апартаменты с собственной кухней, которые расположены в Липецке, вблизи площади Победы и центрального рынка. На всех территории предоставляется бесплатный WiFi.Апартаменты с кондиционером оформлены в классическом стиле и оборудованы телевизором с плоским экраном и спутниковыми каналами. В ванной комнате установлен душ.Гости могут готовить в кухне с микроволновой печью, плитой, чайником и холодильником.Апартаменты находятся в 2,5 км от Липецкого автовокзала и в 10 минутах езды от железнодорожного вокзала Липецка.",logo1:"/images/no-image.png",logo2:"/images/lipeck/image11.jpg",numbers:[{category:"Одноместный",amount:"23",price:3e3},{category:"Двухместный",amount:"40",price:5e3},{category:"Одноместный сьют",amount:"10",price:4e3},{category:"Комфорт+",amount:"5",price:1e4},{category:"Президентский",amount:"15",price:15e3}]}},_open:function(e){var i=this.$(".ticket-view-description"),n=this;this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:function(){var i=t(".today"),a=i.position(),o=1;a=t(".today").position(),n.$fromCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),a=i.next().position(),n.$toCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),n.$calendar.animate({scale:.8},{duration:0,complete:function(){n.$calendar.css("opacity",1)}}),e()}})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Места забронированы"}))}})}),define("views/RestBaseView",["underscore","jquery","framework/View","templates/hotel-view","framework/utils/Scroll","framework/utils/backend","framework/utils/log","views/SearchView","collections/_eventCollection","models/ticketCart","views/TicketViewTable","views/MessageView"],function(e,t,i,n,a,o,r,s,l,c,u,h){"use strict";var d=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];return i.extend({className:"hotel-view",template:n,events:{"click .back-button":"back","click button.ticket-view-buy-button":"proceed","click .ticket-view-table-choice-minus":"clickMinus","click .ticket-view-table-choice-plus":"clickPlus","click .hotel-view-date-section input":"activateCalendar","click .hotel-view-calendar-done":"clickDone"},initialize:function(t){t=t||{},this.$el.css({opacity:0,scale:2}),e.bindAll(this,"clickDone"),this.eventId=t.eventId,this.deltaY=18,this.preventScroll=0},afterRender:function(){function e(e){e.stopPropagation();var i=t(e.fromElement),n=i.position(),a=+i.attr("data-day");if(console.log(n),p.$activeCircle===p.$fromCircle)o=a;else{if(o>a)return;r=a}var s=1;p.$activeCircle.animate({marginTop:n.top*s-60,marginLeft:n.left*s+3},400),p.$activeInput.val(t(e.fromElement).attr("data-day")+"."+l.getMonth()+"."+l.getFullYear())}var i,n,a,o,r,s,l=new Date,c=l.getDate(),u=l.getMonth(),h=this.$(".hotel-view-calendar-body"),p=this;for(this.$(".hotel-view-date-from").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(l.getDate()+1),this.$(".hotel-view-date-to").val(l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear()),l.setDate(1),i=l.getDate(),n=l.getDay();n>1;n--)h.append(t('<div class="no-date">0</div>'));for(;l.getMonth()===u;)a=t("<div>"),(0===l.getDay()||6===l.getDay())&&a.addClass("weekend"),l.getDate()===c&&(s=a.addClass("today")),h.append(a.html(i).attr("data-day",i)),l.setDate(++i);this.$(".hotel-view-calendar-header-month").html(d[l.getMonth()]),this.$(".hotel-view-calendar-header-year").html(l.getFullYear()),this.$toCircle=this.$(".hotel-view-calendar-to"),this.$fromCircle=this.$(".hotel-view-calendar-from"),this.$calendar=this.$(".hotel-view-calendar").on("click","div",e).css("opacity",0)},activateCalendar:function(e){this.$activeInput&&(this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active"));var i=this.$activeInput=t(e.fromElement).addClass("active");this.$calendar.addClass("activated"),/from/.test(i.attr("class"))?this.$activeCircle=this.$fromCircle:this.$activeCircle=this.$toCircle,this.$activeCircle.addClass("active")},clickDone:function(){this.deactivateCalendar()},deactivateCalendar:function(){this.$calendar.removeClass("activated"),this.$activeInput.removeClass("active"),this.$activeCircle.removeClass("active")},clickMinus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(0!==e){var n=t.find("span[data-active]");0===n.prev().length&&t.prepend('<span style="margin-top:-18px"> '+(e-1)),setTimeout(function(){t.find("span").first().css("margin",0)},0),n.removeAttr("data-active"),n.prev().attr("data-active",e-1),t.css("transform","translateY("+(n.prevAll().length-1)*-i+"px)")}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},clickPlus:function(e){var i=t(e.fromElement).parent();!function(e,t,i){if(!(e>=t.find("span").attr("data-max"))){var n=t.find("span[data-active]");0===n.next().length&&t.append("<span>"+(e+1)),n.removeAttr("data-active"),n.next().attr("data-active",e+1),t.css("transform","translateY("+(n.prevAll().length+1)*-i+"px)"),0===n.next().length&&t.append("<span>"+(e+1))}}(+i.find("span[data-active]").attr("data-active"),i.find(".numbers-container"),18)},data:function(){return{name:"База отдыха «Донской лес»",address:"Липецкая область, Задонский р-он, урочище Скит",phone:"+7 (910) 739-25-70",site:"http://donforest.ru",description:"База отдыха располагается на берегу реки Дон в окружении лесов. Уникальное место России. Речная тихая гладь, богатый разнообразием сосновый лес. На территории базы свежий и кристально чистый воздух, который хорошо влияет как на эмоциональное, так и на физическое здоровье гостей",logo1:"/images/no-image.png",logo2:"/images/lipeck/image13.jpeg",numbers:[{category:"Одноместный",amount:"23",price:3e3},{category:"Двухместный",amount:"40",price:5e3},{category:"Одноместный сьют",amount:"10",price:4e3},{category:"Комфорт+",amount:"5",price:1e4},{category:"Президентский",amount:"15",price:15e3}]}},_open:function(e){var i=this.$(".ticket-view-description"),n=this;this.scroller=new a(i,i.find("p"),{scrollbar:{$scroll:this.$(".ticket-view-description-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-description-scroll-knob")},callback:function(e,t){t>0?i.css("box-shadow","inset 0px 17px 14px -17px"):i.css("box-shadow","none")},options:{scrollingX:!1}}),this.scrollTable=new a(t(".ticket-view-table-wrapper"),t(".ticket-view-table-wrapper table"),{scrollbar:{$scroll:this.$(".ticket-view-table-scroll").css("opacity",0),$scrollKnob:this.$(".ticket-view-table-scroll-knob")},options:{scrollingX:!1}}),this.$el.animate({opacity:1,scale:1},{complete:function(){var i=t(".today"),a=i.position(),o=1;a=t(".today").position(),n.$fromCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),a=i.next().position(),n.$toCircle.css({marginLeft:a.left*o+3,marginTop:a.top*o-60}),n.$calendar.animate({scale:.8},{duration:0,complete:function(){n.$calendar.css("opacity",1)}}),e()}})},_close:function(e){this.scroller.destroy(),this.scrollTable.destroy(),
this.$el.animate({opacity:0,scale:2},{complete:e})},back:function(){window.history.back()},proceed:function(){Firefly.viewport.showMessage(new h({message:"Места забронированы"}))}})}),define("views/MainScreen",["framework/Screen","framework/Container","views/SearchView","views/MainScreenWidgetView","views/CategoryListView","views/CategoryView","views/SubcategoryView","views/ProductView","views/TicketView","views/TicketBuyView","views/TicketConfirmView","views/TicketSuccessView","views/SearchResultsView","models/Category","models/Subcategory","models/Product","templates/main-screen","framework/utils/log","views/HotelCategoriesView","views/HotelsView","views/DosugView","views/TheaterView","views/CultureView","views/TheaterEventsView","views/HisMuseumView","views/HotelView","views/TransportView","views/ShopsView","views/FoodView","views/ReastoranView","views/CafeView","views/StolovayaView","views/BarView","views/SamohvalView","views/NightClubView","views/BuolingView","views/CinemaView","views/StadionView","views/ParkView","views/HudMuseumView","views/TechMuseumView","views/KraevMuseumView","views/CultMuseumView","views/HostelView","views/GuestHousView","views/ApartmentView","views/RestBaseView"],function(e,t,i,n,a,o,r,s,l,c,u,h,d,p,f,m,v,g,y,b,w,_,k,x,T,S,E,C,M,L,P,D,A,$,N,I,O,z,B,j,R,F,H,V,U,q,W){"use strict";return e.extend({className:"main-screen",template:v,routes:{"":"categories","categories/:id":"category","subcategories/:id(/:page)":"subcategory","products/:id":"product","search/:query(/:page)":"search",ticket:"ticket",confirmTicket:"confirmTicket",buyTicket:"buyTicket",successTicket:"successTicket","hotel-categories":"hotelCategories","hotels(/:page)":"hotels",dosug:"dosug",theater:"theater",culture:"culture","theater-events(/:page)":"theaterEvents",museum:"showMuseum",hotel:"showHotel",transport:"transport",shops:"shops",food:"food",reatoran:"reatoran",cafe:"cafe",stolovaya:"stolovaya",bar:"bar",samohval:"samohval",club:"club",bouling:"bouling",kino:"kino",stadion:"stadion",park:"park",hud:"hud",tech:"tech",kraev:"kraev",culcenter:"culcenter",hostel:"hostel",guest:"guest",apart:"apart",restbase:"restbase"},regions:{search:".main-screen-search",content:".main-screen-content",footer:".main-screen-footer"},subviews:{container:t,searchView:i,widgetView:n},layout:{search:"searchView",content:"container",footer:"widgetView"},hotelCategories:function(){this.init(),this.subviews.container.show(new y),this.subviews.widgetView.select("map"),Firefly.trigger("map:locations:product",b.prototype.data().map(function(e){return e.locations[0]}))},dosug:function(){this.init(),this.subviews.container.show(new w)},culture:function(){this.init(),this.subviews.container.show(new k)},theater:function(){this.init(),this.subviews.container.show(new _)},transport:function(){this.init(),this.subviews.container.show(new E)},shops:function(){this.init(),this.subviews.container.show(new C)},food:function(){this.init(),this.subviews.container.show(new M)},reatoran:function(){this.init(),this.subviews.container.show(new L)},cafe:function(){this.init(),this.subviews.container.show(new P)},stolovaya:function(){this.init(),this.subviews.container.show(new D)},bar:function(){this.init(),this.subviews.container.show(new A)},samohval:function(){this.init(),this.subviews.container.show(new $)},club:function(){this.init(),this.subviews.container.show(new N)},bouling:function(){this.init(),this.subviews.container.show(new I)},kino:function(){this.init(),this.subviews.container.show(new O)},stadion:function(){this.init(),this.subviews.container.show(new z)},park:function(){this.init(),this.subviews.container.show(new B)},hud:function(){this.init(),this.subviews.container.show(new j)},tech:function(){this.init(),this.subviews.container.show(new R)},kraev:function(){this.init(),this.subviews.container.show(new F)},culcenter:function(){this.init(),this.subviews.container.show(new H)},hostel:function(){this.init(),this.subviews.container.show(new V)},guest:function(){this.init(),this.subviews.container.show(new U)},apart:function(){this.init(),this.subviews.container.show(new q)},restbase:function(){this.init(),this.subviews.container.show(new W)},hotels:function(e){this.init();var t=this.subviews.container.currentView;return e=e?parseInt(e,10):0,t&&t instanceof b?void t.goToPage(e):void this.subviews.container.show(new b({page:e}))},theaterEvents:function(e){this.init();var t=this.subviews.container.currentView;return e=e?parseInt(e,10):0,t&&t instanceof x?void t.goToPage(e):void this.subviews.container.show(new x({page:e}))},init:function(){this.inited||(this.inited=!0,Firefly.viewport.hideModal())},categories:function(){this.init(),this.subviews.searchView.clear(),this.subviews.searchView.show(),this.subviews.container.show(new a),this.subviews.widgetView.select("map"),window.Firefly.trigger("map:locations:clear")},category:function(e){this.init(),this.subviews.searchView.show();var t=new p({id:parseInt(e,10)}),i=new o({model:t});this.subviews.container.show(i),this.subviews.widgetView.select("banner"),window.Firefly.trigger("map:locations:clear")},subcategory:function(e,t){this.init(),this.subviews.searchView.show();var i,n=this.subviews.container.currentView;return e=parseInt(e,10),t=t?parseInt(t,10):0,n&&n instanceof r&&n.model.id===e?void n.goToPage(t):(i=new f({id:e}),this.subviews.container.show(new r({model:i,page:t})),void this.subviews.widgetView.select("map"))},product:function(e){this.init(),this.subviews.searchView.show();var t=new m({id:parseInt(e,10)}),i=new s({model:t});this.subviews.container.show(i),this.subviews.widgetView.select("map")},search:function(e,t){this.init(),this.subviews.searchView.show();var i=this.subviews.container.currentView;return t=t?parseInt(t,10):0,i&&i instanceof d&&i._query===e?void i.goToPage(t):(g.event("search:word",{query:e}),void this.subviews.container.show(new d({query:e,page:t})))},ticket:function(){this.init(),this.subviews.container.show(new l),this.subviews.widgetView.select("map")},buyTicket:function(){this.init(),this.subviews.container.show(new c),this.subviews.widgetView.select("map")},confirmTicket:function(){this.init(),this.subviews.container.show(new u),this.subviews.widgetView.select("map")},successTicket:function(){this.init(),this.subviews.container.show(new h),this.subviews.widgetView.select("map")},showMuseum:function(){this.init(),console.log(T),this.subviews.container.show(new T),this.subviews.widgetView.select("map")},showHotel:function(){this.init(),this.subviews.container.show(new S),this.subviews.widgetView.select("map")}})}),define("collections/LocationCollection",["backbone","models/Location"],function(e,t){"use strict";return e.Collection.extend({model:t})}),define("dictionaries/en",[],function(){"use strict";return{lang:"en",main_menu:"MAIN MENU",city_map:"CITY MAP",metro_map:"METRO MAP","TOUCH THE SCREEN":"TOUCH THE SCREEN",Search:"Search",MAP:"MAP",WEATHER:"WEATHER",CURRENCY:"CURRENCY",LANGUAGE:"LANGUAGE",English:"English",Russian:"Russian",German:"German",BACK:"BACK","MORE INFO":"MORE INFO",DISCOUNT:"DISCOUNT",months:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],wdays:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],BUY:"BUY",SELL:"SELL",CONTACTS:"CONTACTS",Address:"Address",Phone:"Phone","Opening hours":"Opening hours",Metro:"Metro",Website:"Website",PRINT:"PRINT INFO"}}),define("dictionaries/ru",[],function(){"use strict";return{lang:"ru",main_menu:"ГЛАВНОЕ МЕНЮ","CITY MAP":"КАРТА ГОРОДА","METRO MAP":"КАРТА МЕТРО","TOUCH THE SCREEN":"КОСНИТЕСЬ ЭКРАНА",Search:"Поиск",MAP:"КАРТА",WEATHER:"ПОГОДА",CURRENCY:"КУРСЫ ВАЛЮТ",LANGUAGE:"ЯЗЫК",English:"Английский",Russian:"Русский",German:"Немецкий",BACK:"НАЗАД","MORE INFO":"ПОДРОБНЕЕ",DISCOUNT:"СКИДКА",MORNING:"УТРО",AFTERNOON:"ДЕНЬ",EVENING:"ВЕЧЕР",Metro:"Метро",PRINT:"НАПЕЧАТАТЬ","PRINT DISCOUNT":"НАПЕЧАТАТЬ КУПОН",BUY:"ПОКУПКА",SELL:"ПРОДАЖА",CONTACTS:"КОНТАКТЫ",Address:"Адрес",Phone:"Телефон","Opening hours":"Часы работы",Website:"Сайт",ABOUT:"ОПИСАНИЕ",january:"января",february:"февраля",march:"марта",april:"апреля",may:"мая",june:"июня",july:"июля",august:"августа",september:"сентября",october:"октября",november:"ноября",december:"декабря",sunday:"воскресенье",monday:"понедельник",tuesday:"вторник",wednesday:"среда",thursday:"четверг",friday:"пятница",saturday:"суббота"}}),define("dictionaries/de",[],function(){"use strict";return{lang:"de","TOUCH THE SCREEN":"BERUHREN SIE DEN BILDSCHIRM",Search:"Suche",English:"Englisch",Russian:"Russisch",German:"Deutsch",MAP:"KARTE",main_menu:"MAIN MENU","CITY MAP":"STADTPLAN","METRO MAP":"U-BAHN NETZPLAN",WEATHER:"WETTER",CURRENCY:"WECHSELKURS",LANGUAGE:"SPRACHE",BACK:"ZURÜCK","MORE INFO":"MEHR INFO",DISCOUNT:"RABATT",PRINT:"DRUCKEN","PRINT DISCOUNT":"RABATTCOUPONS",BUY:"DEVISENKAUF",SELL:"DEVISENVERKAUF",CONTACTS:"KONTAKTDATEN",Address:"Adresse",Phone:"Telefon","Opening hours":"Öffnungszeiten",Metro:"Metro",Website:"Website",ABOUT:"BESCHREIBUNG",MORNING:"MORGEN",AFTERNOON:"TAG",EVENING:"ABEND",january:"januar",february:"februar",march:"märtz",april:"april",may:"may",june:"juni",july:"juli",august:"august",september:"september",october:"oktober",november:"november",december:"dezember",sunday:"sonntag",monday:"montag",tuesday:"dienstag",wednesday:"mittwoch",thursday:"donnerstag",friday:"freitag",saturday:"samstag"}}),define("views/PreView",["underscore","jquery","framework/View","models/Product","templates/product-view","ftscroller","framework/utils/backend","views/ProductView","bxslider"],function(e,t,i,n,a,o,r,s){"use strict";return s.extend({reloadPreview:function(e){return this.reloadWithId(e),this.afterRender=function(){function e(){this.width>=this.height?(t(this).css("width","100%"),t(this).css("height","auto")):(t(this).css("width","auto"),t(this).css("height","100%"),t(this).css("margin-left",(t(this).parent().width()-this.width)/2))}var i,n,a,r,s,l=t("ul.product-view-slider img");for(a=0;a<l.length;a++)l[a].onload=e;this.$(".bxslider").bxSlider({buildPager:function(){return'<div class="product-view-pager"></div>'}}),this.scroller=new o(this.$(".product-view-description")[0],{scrollingX:!1,scrollbars:!1}),this.$scroll=this.$(".product-view-description-scroll"),this.$scrollKnob=this.$(".product-view-description-scroll-knob"),i=this.$scroll.height(),n=this.scroller.scrollHeight?this.$scroll.height()*this.$scroll.height()/this.scroller.scrollHeight:i,this.$scrollKnob.css({height:n}),n>=i&&this.$scroll.hide(),this.scroller.addEventListener("scroll",this.updateScroll),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(r=t("span.product-view-contacts-item-heading"),r.css("color","#384B6C"),r.css("background-image","none"),s=t("h1.product-view-contacts-heading"),s.css("color","#384B6C"),s.css("background-image","none")),"Microsoft Internet Explorer"===navigator.appName&&t(".product-view-contacts-item-heading, .product-view-contacts-heading").css("color","#384B6C")},this.reload()}})}),define("framework/PreViewScreen",["jquery","framework/Screen","framework/Container","views/SearchView","views/MainScreenWidgetView","views/SubcategoryView","views/ProductView","views/PreView","templates/main-screen"],function(e,t,i,n,a,o,r,s,l){"use strict";return t.extend({className:"main-screen",template:l,routes:{":id":"preview"},regions:{content:".main-screen-content"},subviews:{container:i,widgetView:a,a:s,subcategoryView:o,productView:r},layout:{content:"container"},init:function(){this.inited||(this.inited=!0)},product:function(e){this.init(),this.subviews.container.show(this.subviews.productView.reloadWithId(e)),this.subviews.widgetView.select("map")},preview:function(t){this.subviews.container.show(this.subviews.a.reloadPreview(t));var i=e(this.el);i.parent().css("margin-top","-422px"),i.parent().css("height","1350px")}})}),requirejs.config({paths:{backbone:"../components/backbone/backbone",underscore:"../components/underscore/underscore",jquery:"../components/jquery/jquery",handlebars:"../components/handlebars/handlebars.runtime","jquery.transit":"../components/jquery.transit/jquery.transit","jquery.easing":"../components/jquery.easing/js/jquery.easing",leaflet:"../components/leaflet-dist/leaflet",bxslider:"../components/bxslider-4/jquery.bxslider",ftscroller:"framework/utils/ftscroller","phantom-limb":"../components/phantom-limb/phantom-limb","kiosk-session-manager":"../components/kiosk-session-manager/dist"},shim:{jquery:{exports:"jQuery"},"jquery.transit":{deps:["jquery"]},"jquery.easing":{deps:["jquery"]},underscore:{exports:"_"},bxslider:{deps:["jquery"]},backbone:{deps:["jquery","underscore"],exports:"Backbone"},handlebars:{exports:"Handlebars"},leaflet:{exports:"L"},ftscroller:{exports:"FTScroller"}}}),requirejs(["leaflet","jquery","framework/Application","views/MainScreen","collections/LocationCollection","dictionaries/en","dictionaries/ru","dictionaries/de","framework/PreViewScreen","framework/utils/backend","framework/utils/log"],function(e,t,i,n,a,o,r,s,l,c,u){"use strict";e.Icon.Default.imagePath="/images";var h,d={},p=window.ENV||"production";d.production={languages:["en","ru","de"],defaultLanguage:"ru",defaultScreen:"main",backend:"/data",ticketBackend:window.location.protocol+"//"+window.location.hostname+":8000",sessionTimeout:"1 minute 30 seconds",dictionaries:{en:o,ru:r,de:s},digitImageDuration:"7.5 seconds",showTickets:!1},d.development={languages:["en","ru","de"],defaultLanguage:"ru",defaultScreen:"main",backend:"/data",ticketBackend:window.location.protocol+"//"+window.location.hostname+":8000",sessionTimeout:"1000000 seconds",dictionaries:{en:o,ru:r,de:s},digitImageDuration:"7.5 seconds",showTickets:!0},u.info("Starting with ENV = "+window.ENV),h=window.Firefly=new i(d[p]),h.addScreens({main:new n}),t(document).keydown(function(e){27==e.keyCode&&require("nw.gui").App.quit()}),t(function(){h.start();var e=window.innerWidth,t=window.innerHeight,i=1080,n=1920,a=e/i,o=t/n;Math.min(a,o)})}),define("main",function(){})}();
//# sourceMappingURL=amd-index.js.map